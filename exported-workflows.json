[{"createdAt":"2025-06-02T13:17:16.423Z","updatedAt":"2025-06-02T18:25:16.003Z","id":"G2TCwxbAAXfPq4yN","name":"Github Import","active":false,"isArchived":false,"nodes":[{"parameters":{},"name":"On clicking 'execute'","type":"n8n-nodes-base.manualTrigger","position":[160,320],"typeVersion":1,"id":"44ac7ceb-b525-4d5c-91ae-0598db44af10"},{"parameters":{"command":"npx n8n import:workflow --separate --input=/home/node/backup/repo/workflows"},"name":"Export Workflows","type":"n8n-nodes-base.executeCommand","position":[360,220],"typeVersion":1,"id":"fad72d06-e68c-4a1f-b9b4-db965c0fd29b","disabled":true},{"parameters":{"command":"npx n8n import:credentials --separate --input=/home/node/backup/repo/credentials"},"name":"Export Credentials","type":"n8n-nodes-base.executeCommand","position":[520,220],"typeVersion":1,"id":"b29b73fd-d820-482e-980d-21dbd4824b9f"},{"parameters":{"command":"git -C repo add ."},"name":"git add","type":"n8n-nodes-base.executeCommand","position":[660,220],"typeVersion":1,"id":"0293e3fc-2f88-4c2b-9995-c2cdbe5dcdec"},{"parameters":{"command":"=git -C repo commit -m \"Auto backup ({{ new Date().toISOString() }})\""},"name":"git commit","type":"n8n-nodes-base.executeCommand","position":[820,220],"typeVersion":1,"id":"e6c66263-279e-4850-a86a-bac075457990"},{"parameters":{"command":"git -C repo push"},"name":"git push","type":"n8n-nodes-base.executeCommand","position":[960,220],"typeVersion":1,"id":"e62bb840-c8d1-42d9-a8b8-2ece5d7c00a7"},{"parameters":{"triggerTimes":{"item":[{"hour":0},{"hour":12},{"hour":6},{"hour":18}]}},"name":"Cron","type":"n8n-nodes-base.cron","position":[160,120],"typeVersion":1,"id":"9e2ff0d8-8eb8-4468-b2de-9a14beabecc0","disabled":true}],"connections":{"Cron":{"main":[[{"node":"Export Workflows","type":"main","index":0}]]},"git add":{"main":[[{"node":"git commit","type":"main","index":0}]]},"git commit":{"main":[[{"node":"git push","type":"main","index":0}]]},"Export Workflows":{"main":[[{"node":"Export Credentials","type":"main","index":0}]]},"Export Credentials":{"main":[[{"node":"git add","type":"main","index":0}]]},"On clicking 'execute'":{"main":[[{"node":"Export Workflows","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"a6a686ec-af15-41a3-ac2b-81df4d6f5c76","triggerCount":0,"tags":[],"shared":[{"createdAt":"2025-06-02T13:17:16.423Z","updatedAt":"2025-06-02T13:17:16.423Z","role":"workflow:owner","workflowId":"G2TCwxbAAXfPq4yN","projectId":"UuIRn3TQYG7gFAJh","project":{"createdAt":"2025-06-02T06:58:10.171Z","updatedAt":"2025-06-02T11:56:13.936Z","id":"UuIRn3TQYG7gFAJh","name":"Kshitiz Gupta <kshitiz305@live.com>","type":"personal","icon":null,"description":null}}]},{"createdAt":"2025-05-08T18:13:28.182Z","updatedAt":"2025-05-08T18:13:28.182Z","id":"nNHcBy8ll2I6X1xy","name":"whatsapp sample","active":false,"isArchived":false,"nodes":[],"connections":{},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"f26e830e-6a2f-4e74-85ed-358de88631b1","triggerCount":0,"tags":[],"shared":[{"createdAt":"2025-06-02T13:19:58.333Z","updatedAt":"2025-06-02T13:19:58.333Z","role":"workflow:owner","workflowId":"nNHcBy8ll2I6X1xy","projectId":"UuIRn3TQYG7gFAJh","project":{"createdAt":"2025-06-02T06:58:10.171Z","updatedAt":"2025-06-02T11:56:13.936Z","id":"UuIRn3TQYG7gFAJh","name":"Kshitiz Gupta <kshitiz305@live.com>","type":"personal","icon":null,"description":null}}]},{"createdAt":"2025-05-29T13:18:21.123Z","updatedAt":"2025-05-30T06:07:53.694Z","id":"Jm4jj4J39lBdwyhv","name":"Create_Payment_Link","active":false,"isArchived":false,"nodes":[{"parameters":{},"id":"1e83fb9f-5e60-4e5d-8e16-1a14759839db","name":"When clicking 'Test workflow'","type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[-820,-140]},{"parameters":{"method":"POST","url":"https://api.razorpay.com/v1/payment_links","authentication":"genericCredentialType","genericAuthType":"httpBasicAuth","sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"upi_link\": \"true\",\n  \"amount\": {{ $json.value}},\n  \"currency\": \"INR\",\n  \"accept_partial\": false,\n  \"notify\": {\n    \"sms\": true,\n    \"email\": true\n  }\n}","options":{}},"id":"04f93d6f-de26-48b3-a275-5f151d3dc844","name":"Create Payment Link","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-580,20],"credentials":{"httpBasicAuth":{"id":"PszcqGCbFxeXYXla","name":"Razorpay credentials"}},"onError":"continueErrorOutput"},{"parameters":{"jsCode":"// Extract payment link details for successful response\nconst paymentData = $input.first().json;\n\nreturn {\n  success: true,\n  short_url: paymentData.short_url,\n  message: 'Payment link created successfully'\n};"},"id":"16af3db6-6fc8-48d8-8ec6-e19f01a3f3a5","name":"Format Success Response","type":"n8n-nodes-base.code","typeVersion":2,"position":[220,-200]},{"parameters":{"jsCode":"// Format error response\nconst errorData = $input.first().json;\n\nreturn {\n  success: false,\n  error_code: errorData.error?.code || 'UNKNOWN_ERROR',\n  error_description: errorData.error?.description || 'An error occurred while creating payment link',\n  error_field: errorData.error?.field || null,\n  error_reason: errorData.error?.reason || null,\n  message: 'Failed to create payment link'\n};"},"id":"c1b3ed63-5e7b-48af-8add-770f183e5fee","name":"Format Error Response","type":"n8n-nodes-base.code","typeVersion":2,"position":[80,180]},{"parameters":{"workflowInputs":{"values":[{"name":"value","type":"number"}]}},"type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1.1,"position":[-820,160],"id":"9a157c71-2d39-494a-9655-9ec150a15bd9","name":"When Executed by Another Workflow"},{"parameters":{"mode":"raw","jsonOutput":"={\"status\":\"success\",\n\"url\": \"{{ $json.short_url }}\",\n\"plink\":\"{{ $json.id }}\"}\n","options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-380,-140],"id":"28f636c8-219b-4389-8837-40fe0cc58b49","name":"Edit Fields"},{"parameters":{"mode":"raw","jsonOutput":"={\n  \"status\":\"failed\"\n}","options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-380,100],"id":"7f65368d-3e84-42e2-a42b-e1da200ce73f","name":"Edit Fields1"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"id":"1f2a3b4c-5d6e-7f8a-9b0c-1d2e3f4a5b6c","leftValue":"={{ $json.status }}","rightValue":"","operator":{"type":"string","operation":"exists","singleValue":true}}],"combinator":"or"},"options":{}},"id":"fbd05efa-5070-48a6-afbe-f8514b12894d","name":"Check Success","type":"n8n-nodes-base.if","typeVersion":2,"position":[-220,-40],"onError":"continueErrorOutput"}],"connections":{"When clicking 'Test workflow'":{"main":[[{"node":"Create Payment Link","type":"main","index":0}]]},"Create Payment Link":{"main":[[{"node":"Edit Fields","type":"main","index":0}],[{"node":"Edit Fields1","type":"main","index":0}]]},"When Executed by Another Workflow":{"main":[[{"node":"Create Payment Link","type":"main","index":0}]]},"Check Success":{"main":[[{"node":"Format Success Response","type":"main","index":0}],[{"node":"Format Error Response","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{"When Executed by Another Workflow":[{"json":{"value":100}}]},"versionId":"d650e729-6ae4-4ee8-b842-0270372cd268","triggerCount":0,"tags":[],"shared":[{"createdAt":"2025-06-02T13:19:58.333Z","updatedAt":"2025-06-02T13:19:58.333Z","role":"workflow:owner","workflowId":"Jm4jj4J39lBdwyhv","projectId":"UuIRn3TQYG7gFAJh","project":{"createdAt":"2025-06-02T06:58:10.171Z","updatedAt":"2025-06-02T11:56:13.936Z","id":"UuIRn3TQYG7gFAJh","name":"Kshitiz Gupta <kshitiz305@live.com>","type":"personal","icon":null,"description":null}}]},{"createdAt":"2025-06-01T13:20:31.550Z","updatedAt":"2025-06-01T13:21:27.425Z","id":"WSojrgVAk078YZIN","name":"github check","active":false,"isArchived":false,"nodes":[{"parameters":{},"id":"73d3788b-7b9a-4928-ae03-8a2af5fc0482","name":"On clicking 'execute'","type":"n8n-nodes-base.manualTrigger","position":[240,80],"typeVersion":1},{"parameters":{"content":"## Subworkflow","height":731.7039821513649,"width":1910.7813046051347,"color":6},"id":"dfa5d8e0-12a7-440a-b7c0-4c4da88fa6b4","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","position":[-240,460],"typeVersion":1},{"parameters":{},"id":"0ec154ce-60ea-4dfd-b05e-619382623403","name":"Execute Workflow Trigger","type":"n8n-nodes-base.executeWorkflowTrigger","position":[-180,840],"typeVersion":1},{"parameters":{"filters":{},"requestOptions":{}},"id":"6eae6740-2781-4484-867d-aa28d793d1de","name":"n8n","type":"n8n-nodes-base.n8n","position":[640,180],"typeVersion":1,"credentials":{"n8nApi":{"id":"vgR3NqYKzoqli1vo","name":"n8n account"}}},{"parameters":{"assignments":{"assignments":[{"id":"8d513345-6484-431f-afb7-7cf045c90f4f","name":"Done","type":"boolean","value":true}]},"options":{}},"id":"080d4a4e-78c3-4b07-bd05-bfb89cef2a44","name":"Return","type":"n8n-nodes-base.set","position":[1480,660],"typeVersion":3.3},{"parameters":{"url":"={{ $json.download_url }}","options":{}},"id":"db0fb0a6-506a-4fea-97b1-de3f8aefe916","name":"Get File","type":"n8n-nodes-base.httpRequest","position":[440,540],"typeVersion":4.2},{"parameters":{"conditions":{"options":{"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"45ce825e-9fa6-430c-8931-9aaf22c42585","operator":{"type":"string","operation":"empty","singleValue":true},"leftValue":"={{ $json.content }}","rightValue":""},{"id":"9619a55f-7fb1-4f24-b1a7-7aeb82365806","operator":{"type":"string","operation":"notExists","singleValue":true},"leftValue":"={{ $json.error }}","rightValue":""}]},"options":{}},"id":"f951b3b6-1e1d-4a80-909c-12c1405012ee","name":"If file too large","type":"n8n-nodes-base.if","position":[200,560],"typeVersion":2},{"parameters":{},"id":"b69fcc61-a011-4903-98e3-47ae919ea744","name":"Merge Items","type":"n8n-nodes-base.merge","position":[200,820],"typeVersion":2},{"parameters":{"jsCode":"const orderJsonKeys = (jsonObj) => {\n  const ordered = {};\n  Object.keys(jsonObj).sort().forEach(key => {\n    ordered[key] = jsonObj[key];\n  });\n  return ordered;\n}\n\n// Check if file returned with content\nif (Object.keys($input.all()[0].json).includes(\"content\")) {\n  // Decode base64 content and parse JSON\n  const origWorkflow = JSON.parse(Buffer.from($input.all()[0].json.content, 'base64').toString());\n  const n8nWorkflow = $input.all()[1].json;\n  \n  // Order JSON objects\n  const orderedOriginal = orderJsonKeys(origWorkflow);\n  const orderedActual = orderJsonKeys(n8nWorkflow);\n\n  // Determine difference\n  if (JSON.stringify(orderedOriginal) === JSON.stringify(orderedActual)) {\n    $input.all()[0].json.github_status = \"same\";\n  } else {\n    $input.all()[0].json.github_status = \"different\";\n    $input.all()[0].json.n8n_data_stringy = JSON.stringify(orderedActual, null, 2);\n  }\n  $input.all()[0].json.content_decoded = orderedOriginal;\n// No file returned / new workflow\n} else if (Object.keys($input.all()[0].json).includes(\"data\")) {\n  const origWorkflow = JSON.parse($input.all()[0].json.data);\n  const n8nWorkflow = $input.all()[1].json;\n  \n  // Order JSON objects\n  const orderedOriginal = orderJsonKeys(origWorkflow);\n  const orderedActual = orderJsonKeys(n8nWorkflow);\n\n  // Determine difference\n  if (JSON.stringify(orderedOriginal) === JSON.stringify(orderedActual)) {\n    $input.all()[0].json.github_status = \"same\";\n  } else {\n    $input.all()[0].json.github_status = \"different\";\n    $input.all()[0].json.n8n_data_stringy = JSON.stringify(orderedActual, null, 2);\n  }\n  $input.all()[0].json.content_decoded = orderedOriginal;\n\n} else {\n  // Order JSON object\n  const n8nWorkflow = $input.all()[1].json;\n  const orderedActual = orderJsonKeys(n8nWorkflow);\n  \n  // Proper formatting\n  $input.all()[0].json.github_status = \"new\";\n  $input.all()[0].json.n8n_data_stringy = JSON.stringify(orderedActual, null, 2);\n}\n\n// Return items\nreturn $input.all();\n"},"id":"e9556fa1-dade-4b87-893f-aa8cf4382120","name":"isDiffOrNew","type":"n8n-nodes-base.code","position":[400,820],"typeVersion":1},{"parameters":{"dataType":"string","value1":"={{$json.github_status}}","rules":{"rules":[{"value2":"same"},{"value2":"different","output":1},{"value2":"new","output":2}]}},"id":"244fda82-5c8b-4118-833d-6e9a478016e5","name":"Check Status","type":"n8n-nodes-base.switch","position":[800,820],"typeVersion":1},{"parameters":{},"id":"0f4138ef-763c-4407-91c0-7c027625c756","name":"Same file - Do nothing","type":"n8n-nodes-base.noOp","position":[1020,660],"typeVersion":1},{"parameters":{},"id":"a48e1ee7-7635-43f4-a69f-32a45789b4fe","name":"File is different","type":"n8n-nodes-base.noOp","position":[1020,820],"typeVersion":1},{"parameters":{},"id":"f2e0c991-7eeb-4bb5-8e91-171b046d27ba","name":"File is new","type":"n8n-nodes-base.noOp","position":[1020,1020],"typeVersion":1},{"parameters":{"resource":"file","owner":{"__rl":true,"mode":"","value":"={{ $('Config').first().item.repo_owner }}"},"repository":{"__rl":true,"mode":"","value":"={{ $('Config').first().item.repo_name }}"},"filePath":"={{ $('Config').first().item.repo_path }}{{ $json.subPath }}{{$('Execute Workflow Trigger').first().json.id}}.json","fileContent":"={{$('isDiffOrNew').item.json[\"n8n_data_stringy\"]}}","commitMessage":"={{$('Execute Workflow Trigger').first().json.name}} ({{$json.github_status}})"},"id":"7ee441cc-de45-4820-b2b3-e6edd51a8e6c","name":"Create new file","type":"n8n-nodes-base.github","position":[1240,1020],"typeVersion":1,"webhookId":"fa1aa20b-1717-4701-9dab-51fa839a2553"},{"parameters":{"resource":"file","operation":"edit","owner":{"__rl":true,"mode":"","value":"={{ $('Config').first().item.repo_owner }}"},"repository":{"__rl":true,"mode":"","value":"={{ $('Config').first().item.repo_name }}"},"filePath":"={{ $('Config').first().item.repo_path }}{{ $json.subPath }}{{$('Execute Workflow Trigger').first().json.id}}.json","fileContent":"={{$('isDiffOrNew').item.json[\"n8n_data_stringy\"]}}","commitMessage":"={{$('Execute Workflow Trigger').first().json.name}} ({{$json.github_status}})"},"id":"fe61a305-315e-47e5-8179-c9e1a77dd1ea","name":"Edit existing file","type":"n8n-nodes-base.github","position":[1240,820],"typeVersion":1,"webhookId":"e0e5c8ab-5ee7-4e5d-aa45-3f83576ed528"},{"parameters":{"options":{}},"id":"811156f9-b5f9-4a39-86b1-6e4886d66256","name":"Loop Over Items","type":"n8n-nodes-base.splitInBatches","position":[840,180],"typeVersion":3},{"parameters":{"rule":{"interval":[{"triggerAtHour":1,"triggerAtMinute":33}]}},"id":"6954b8ee-7e5f-42bf-b385-1f51c7e84a40","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","position":[240,280],"typeVersion":1.2},{"parameters":{"assignments":{"assignments":[{"id":"dae43d3b-56e5-4098-b602-862ebf5cd073","name":"subPath","type":"string","value":"={{ $('Execute Workflow Trigger').first().json.createdAt.split('-')[0] }}/{{ $('Execute Workflow Trigger').first().json.createdAt.split('-')[1] }}/"}]},"includeOtherFields":true,"options":{}},"id":"578ed3bc-f8e9-4669-bb75-1d53efc367a0","name":"Create sub path","type":"n8n-nodes-base.set","position":[600,820],"typeVersion":3.3},{"parameters":{"content":"## Backup to GitHub \nThis workflow will backup all instance workflows to GitHub every 24 hours.\n\nThe files are saved into folders using `YYYY/MM/` for the directory path and `ID.json` for the filename.\n\nThe Repo Owner, Repo Name and Main folder are set using the **Variables** feature but can be replaced with the `Config` node in the subworkflow. \n\nThe workflow runs calls itself to help reduce memory usage, Once the workflow has completed it will send an optional notification to Slack.\n\n### Time to Run\nTested with 1423 workflows on `1.44.1` it took under 30 minutes for the first run and under 12 minutes once the initial run is complete.","height":417,"width":385,"color":4},"id":"0020c515-4217-47c8-bc18-36e1e95f1264","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","position":[-240,0],"typeVersion":1},{"parameters":{"content":"## Main workflow loop","height":416.1856906618075,"width":1272.6408145680155,"color":7},"id":"5e352fae-ae16-4f5a-9c3c-5b784d289b8c","name":"Sticky Note2","type":"n8n-nodes-base.stickyNote","position":[200,0],"typeVersion":1},{"parameters":{"select":"channel","channelId":{"__rl":true,"mode":"name","value":"#notifications"},"text":"=:information_source:  Starting Workflow Backup [{{ $execution.id }}]","otherOptions":{"includeLinkToWorkflow":false}},"id":"96b16535-2512-43a8-8785-7df548b4faf8","name":"Starting Message","type":"n8n-nodes-base.slack","position":[480,180],"webhookId":"c02eb407-5547-4aa0-9ebf-46dab67b63b6","typeVersion":2.2,"disabled":true},{"parameters":{"workflowId":"={{ $workflow.id }}","mode":"each","options":{}},"id":"17a0bfc8-75e3-4e55-bc42-16b34e8eda59","name":"Execute Workflow","type":"n8n-nodes-base.executeWorkflow","position":[1060,200],"typeVersion":1,"onError":"continueErrorOutput"},{"parameters":{"select":"channel","channelId":{"__rl":true,"mode":"name","value":"#notifications"},"text":"=✅ Backup has completed - {{ $('n8n').all().length }} workflows have been processed.","otherOptions":{}},"id":"794d93cc-38b5-4358-af46-fc3b399d649d","name":"Completed Notification","type":"n8n-nodes-base.slack","position":[1060,20],"webhookId":"a0c6e8c8-5d71-40fa-b02b-63a7ed5726c4","executeOnce":true,"typeVersion":2.2},{"parameters":{"select":"channel","channelId":{"__rl":true,"mode":"name","value":"#notifications"},"text":"=:x: Failed to backup {{ $('Loop Over Items').item.json.id }}","otherOptions":{"includeLinkToWorkflow":false}},"id":"6e6196f1-7493-4adc-b86e-d08f0f215b7b","name":"Failed Flows","type":"n8n-nodes-base.slack","position":[1260,220],"webhookId":"2a092edb-de12-490f-931b-34d70e7d7696","typeVersion":2.2},{"parameters":{"resource":"file","operation":"get","owner":{"__rl":true,"mode":"","value":"={{ $('Config').first().item.repo_owner }}"},"repository":{"__rl":true,"mode":"","value":"={{ $('Config').first().item.repo_name }}"},"filePath":"={{ $('Config').first().item.repo_path }}{{ $('Execute Workflow Trigger').first().json.createdAt.split('-')[0] }}/{{ $('Execute Workflow Trigger').first().json.createdAt.split('-')[1] }}/{{$json.id}}.json","asBinaryProperty":false,"additionalParameters":{}},"id":"e462b03d-78a2-4af3-9777-d5141d52ea30","name":"Get file data","type":"n8n-nodes-base.github","position":[0,560],"typeVersion":1,"alwaysOutputData":true,"webhookId":"1f63fbd1-77ab-4232-a49e-73eebe838669","continueOnFail":true},{"parameters":{"assignments":{"assignments":[{"id":"8f6d1741-772f-462a-811f-4c334185e4f0","name":"repo_owner","type":"string","value":"={{ $vars.repo_owner }}"},{"id":"8cac215c-4fd7-422f-9fd2-6b2d1e5e0383","name":"repo_name","type":"string","value":"={{ $vars.repo_name }}"},{"id":"eee305e9-4164-462a-86bd-80f0d58a31ae","name":"repo_path","type":"string","value":"={{ $vars.repo_path }}"}]},"includeOtherFields":true,"options":{}},"id":"a3a824a4-b9e7-475d-b32b-f9c8efb1c6e2","name":"Config","type":"n8n-nodes-base.set","position":[0,840],"typeVersion":3.4}],"connections":{"n8n":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Config":{"main":[[{"node":"Get file data","type":"main","index":0},{"node":"Merge Items","type":"main","index":1}]]},"Get File":{"main":[[{"node":"Merge Items","type":"main","index":0}]]},"File is new":{"main":[[{"node":"Create new file","type":"main","index":0}]]},"Merge Items":{"main":[[{"node":"isDiffOrNew","type":"main","index":0}]]},"isDiffOrNew":{"main":[[{"node":"Create sub path","type":"main","index":0}]]},"Check Status":{"main":[[{"node":"Same file - Do nothing","type":"main","index":0}],[{"node":"File is different","type":"main","index":0}],[{"node":"File is new","type":"main","index":0}]]},"Failed Flows":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Get file data":{"main":[[{"node":"If file too large","type":"main","index":0}]]},"Create new file":{"main":[[{"node":"Return","type":"main","index":0}]]},"Create sub path":{"main":[[{"node":"Check Status","type":"main","index":0}]]},"Loop Over Items":{"main":[[{"node":"Completed Notification","type":"main","index":0}],[{"node":"Execute Workflow","type":"main","index":0}]]},"Execute Workflow":{"main":[[{"node":"Loop Over Items","type":"main","index":0}],[{"node":"Failed Flows","type":"main","index":0}]]},"Schedule Trigger":{"main":[[{"node":"Starting Message","type":"main","index":0}]]},"Starting Message":{"main":[[{"node":"n8n","type":"main","index":0}]]},"File is different":{"main":[[{"node":"Edit existing file","type":"main","index":0}]]},"If file too large":{"main":[[{"node":"Get File","type":"main","index":0}],[{"node":"Merge Items","type":"main","index":0}]]},"Edit existing file":{"main":[[{"node":"Return","type":"main","index":0}]]},"On clicking 'execute'":{"main":[[{"node":"Starting Message","type":"main","index":0}]]},"Same file - Do nothing":{"main":[[{"node":"Return","type":"main","index":0}]]},"Execute Workflow Trigger":{"main":[[{"node":"Config","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"5fc59ca1-29ac-4c28-83d5-9ea93c649cfe","triggerCount":0,"tags":[],"shared":[{"createdAt":"2025-06-02T13:19:58.333Z","updatedAt":"2025-06-02T13:19:58.333Z","role":"workflow:owner","workflowId":"WSojrgVAk078YZIN","projectId":"UuIRn3TQYG7gFAJh","project":{"createdAt":"2025-06-02T06:58:10.171Z","updatedAt":"2025-06-02T11:56:13.936Z","id":"UuIRn3TQYG7gFAJh","name":"Kshitiz Gupta <kshitiz305@live.com>","type":"personal","icon":null,"description":null}}]},{"createdAt":"2025-06-15T09:43:52.845Z","updatedAt":"2025-06-15T09:44:35.404Z","id":"NqiWMbuPuduOOnot","name":"Whatsapp Conversation_","active":false,"isArchived":true,"nodes":[{"parameters":{"descriptionType":"manual","toolDescription":"this needs to be used only when all the data related to the patient is available along with the doctor they need a appointment from.","operation":"append","documentId":{"__rl":true,"value":"15dOz4nD1iDO26zU5ZYnP_9PqBSBUqEzDTcsI_YQnTX4","mode":"list","cachedResultName":"Appointment Sheet","cachedResultUrl":"https://docs.google.com/spreadsheets/d/15dOz4nD1iDO26zU5ZYnP_9PqBSBUqEzDTcsI_YQnTX4/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Sheet1","cachedResultUrl":"https://docs.google.com/spreadsheets/d/15dOz4nD1iDO26zU5ZYnP_9PqBSBUqEzDTcsI_YQnTX4/edit#gid=0"},"columns":{"mappingMode":"defineBelow","value":{"patient_number":"={{ $('WhatsApp Trigger').item.json.contacts[0].wa_id }}","patient_name":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('patient_name', `This is the name of the patient to be entered after asking.`, 'string') }}","time":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('time', `The time at which the appointment is confirmed`, 'string') }}","age":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('age', `This is the age of the patient to be entered after asking.`, 'string') }}","gender":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('gender', `keep the format as M for male and F for female.`, 'string') }}","doctor_name":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('doctor_name', `In case the patient opts in for an appointment this needs to be filled.`, 'string') }}","doctor_email":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('doctor_email', `this is the email that is captured from the tool \"Doctor name from doctor type\"\n\nit should end with \"gmail.com\"`, 'string') }}"},"matchingColumns":["patient_number"],"schema":[{"id":"Kshitiz3052805@gmail.com","displayName":"Kshitiz3052805@gmail.com","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"patient_number","displayName":"patient_number","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"patient_name","displayName":"patient_name","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"time","displayName":"time","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"age","displayName":"age","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"gender","displayName":"gender","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"doctor_name","displayName":"doctor_name","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"doctor_email","displayName":"doctor_email","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"appointment_link","displayName":"appointment_link","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"form_link","displayName":"form_link","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheetsTool","typeVersion":4.5,"position":[3220,1900],"id":"9b23c9dc-e34d-479c-adee-f3a1b1de929f","name":"Google Sheets","credentials":{"googleSheetsOAuth2Api":{"id":"n1mJzLfz9loDmBOy","name":"OAuth Account kshitiz305280@gmail.com"}}},{"parameters":{"description":"This will only be used to find the doctors availability. This tool takes input the type of doctor and it returns Doctor Name : Name of doctor\nType: type that was the input\nAvailability Timings: Time available \ndoctor_email: email address used used as arguement in \"Google Calender\" tool as \"Calender\"\nTime needs to be converted to  ISO i.e. format YYYY-MM-DDTHH:mm:ss.sss","workflowId":{"__rl":true,"value":"8XjboaEMlYlLMXGU","mode":"list","cachedResultName":"Doctor selection- HARDCODED"},"workflowInputs":{"mappingMode":"defineBelow","value":{"query":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('query', `This is the doctor type selected by the user`, 'string') }}"},"matchingColumns":["query"],"schema":[{"id":"query","displayName":"query","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false}},"type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":2.2,"position":[3340,1900],"id":"b24c5984-f7f2-4468-8746-3deb39bc5c59","name":"Doctor name from doctor type"},{"parameters":{"promptType":"define","text":"={{$json.messages[0].text.body }}","options":{"systemMessage":"=You are a helpful CHATBOT FOR MEDICAL ADVICE AND APPOINTMENT SETTING.\nToday is {{$now}}\n\nThe first thing is to provide a disclaimer that this is an “Namaste, Welcome to Arogya Udaan, This is an AI generated  tele consultation health service where AI gives  general health information and tele consultation is given by specialist doctors AND this is not an emergency service.” The disclaimer should not be given in each prompt.\nI'm aware you're an AI. For our current task/conversation, please refrain from repeatedly identifying yourself as such. Focus on providing general advice to the user and redirecting it to a specialist .\n1. The very first prompt after disclaimer should be selection of the language  - 1.Hindi or 2.English and depending on the selection the model should interact in that language itself.\n\na)After choosing the option, AI should send the message: “By Proceeding you agree to our Terms & Conditions of Aarogya Udaan Operated by MedHero (Check Bio for link). Do you agree? 1. Yes\n   2. No”\n\nb)Then you need to ask questions based on the patient's name, age and gender and then proceed with other questions. \nThe name can be a first name or the full name either can work. Don’t mention this to the user both are acceptable \nStore the data in the google sheet in the format of M for male and F for female.\nc)Only if the age of the patient is below 16 and above 85 then you should return :-\"Please meet a doctor physically\"  else you can continue to the next step [Don’t explicitly mention either case ]\nNote: The data needs to be filled in English in the google sheet after the patient opts for a doctor appointment. \n\n2.a)Then proceed by asking questions such as “What are your symptoms?”.\n\nb) After this,create a link using the tool “Create_Payment_Link” that takes in value 200 argument and returns a url  that needs to be added in the message to ask permission from the user that “Kindly pay Rs 10 to proceed further [ url ] [ plink ]. Kindly Confirm by typing “Done” once you have completed the payment.” \nHere is an example of the input value by the tool  “Create_Payment_Link”: 200\nHere is an example of the returned value by the tool  “Create_Payment_Link” in case of true: {\"status\":\"success\",\n\"url\": {string},\n\"Plink\":{string}\n}.\nThe url starts with “https://rzp.io/rzp”\n\nNote: only create one payment link for a particular amount. If a  payment link exists for 200 don’t create another one and don't create links on your own\n\n\nc) Once the user mentions that he has completed the payment type using the “Check_payment_status” tool check the payment status using the “plink” provided by the “Create_Payment_Link” in the above step. Based on the status returned - “success”/“failed” move forward accordingly. If “success” then move to the next step, if “failed” return the message “The payment is still not successful. Kindly Retry with the same link.”\nExample of plink would start with “plink*”\n\n\n\n4.a) Then the question needs to be “For how long are you facing the issue?”\nb) Next question “Are you suffering from any other symptoms?\"\nc)After asking for the disease that the patient is suffering from some advice should be given.\n\n\n5.a)After a bit of the examination Categorise the issue into three : thIS NEEDS TO BE DONE ON THE YOUR END BASED ON THE RULES GIVEN BELOW.\nThe bot evaluates all responses and classifies the patient's condition:\nCategory\nMild (Can Wait):- \tCriteria (Minor, short-duration symptoms, no risk factors) - Bot Response: “Your condition appears mild. You may wait and monitor, but consulting a doctor is recommended within 48 hours.”\n\nb)Category\nModerate (Needs Consultation Soon):- Criteria(Persistent symptoms, mild complications, known comorbidities) Bot response:- “We recommend speaking with a doctor soon. Please proceed to book a consultation today.”\nSevere (Needs Immediate Attention) - Criteria (High fever, chest pain, severe dehydration, difficulty breathing, etc.) - Bot response:- Your symptoms suggest a serious condition. Please book a consultation immediately. If symptoms worsen, seek emergency help.”\nYou must mention that the doctor consultation is a Paid service and will be charged RS 400 per session.\n\n\n○  Suggest doctor category: General Physician, Dermatologist, Gynecologist, etc. Based on severity:\n● Bot prioritizes appointment slots\n● Sends urgent notifications to doctors (for red flags)\nEg:“Based on your responses, we recommend a consultation with a General Physician.”\nNote: Users can always override and choose a different specialty.\nBOT response on the severity of the condition Three severity levels: \n* \t\t●  Mild — Can Wait  [Green Colour Emoji]\n* \t\t●  Moderate — Needs Consultation Soon  [Orange Colour emoji]\n* \t\t●  Severe — Needs Immediate Attention [Red Colour Emoji]\n Advice always needs to be given before doctor appointment recommendation.\n* Based on symptoms , you need to recommend a specialty doctor type amongst these: \n    1. General Physician \n    2. Gynaecologist \n    3. Paediatrician \n    4. Dermatologist\n    5. Psychiatrist\n    6. Orthopaedic\n    7. General Surgery\n    8. Ophthalmologist\n\nIt is the choice of the user to go ahead with the recommendation or choose any amongst the list of Specialist types above. Don’t go outside the scope of these options given. The user cannot ask for a doctor name, only based on the specialist type the doctor appointment needs to be booked. Only provide the list of specialists that is available . The user need to be prompted “Select Yes to go with the recommendation else select the number”\n\n\n\n6. Based on the doctor type selected by the user the available doctor needs to be fetched using the “Doctor name from doctor type” tool with doctor type as the argument.\nDoctor email is returned is to be stored as “Doctor email” and used in invite. \nThe “Doctor name from doctor type” tool returns the doctor_email field that needs to be used for creating calendar invites. \n\n6. Ask for the time the user is free in the time returned by the tool “Doctor name from doctor type” in “Availability Timings” . While providing the time to the “Doctor name from doctor type” tool, time needs to be provided in ISO i.e. format YYYY-MM-DDTHH:mm:ss.sss. Don’t ask for the user to provide this format, it should be converted by you.\n\n7.a) After this,create a link using the tool “Create_Payment_Link” that takes in amount (400) as the value and returns a url  that needs to be added in the message to ask permission from the user that “This is a tele consultation service and you will be charged Rs 400. Pay on the payment link [ url ] [ plink ]to proceed further. Kindly Confirm type “Done” once you have completed the payment.” \nHere is an example of the returned value by the tool  “Create_Payment_Link” in case of true: {\"status\":\"success\",\n\"url\": {string},\n\"Plink\":{string}\n}.\nThe url starts with “https://rzp.io/rzp”\n\nNote: only create one payment link for a particular amount. If a  payment link exists for 400 don’t create another one.\n\n\nb) Once the user mentions that he has completed the payment type using the “Check_payment_status” tool check the payment status using the “plink” provided by the “Create_Payment_Link” in the above step. Based on the status returned - “success”/“failed” move forward accordingly. If “success” then move to the next step, if “failed” return the message “The payment is still not successful. Kindly Retry with the same link.”\nExample of plink would start with “plink*”\n\nc) After you have got the doctor name Provide the message “Dr [doctor name] is available [availablity]” and confirmed it from the user to choose from the given time \n8. Ask user his email to be used in the attendee.\n\n9. Using doctor_email from “Doctor name from doctor type” as argument in “Doctor name from doctor type” tool for “Calendar” argument  , send and add an invite with google calendar By ID would \"Calendar\" is the `doctor_email` that was fetched from the “Doctor name from doctor type” tool. The appointment details that need to be  confirmed by the user with the time confirmed.\nNote:Don’t create random email addresses for doctor email,only use the one that is fetched from the “Doctor name from doctor type” tool. If “The resource you are requesting could not be found” is returned by the tool recheck for the email id that is being provided in the Calendar.\n\n10. Add make an entry in the google sheets adding the name, age , gender , the doctor name , doctor email id [used in “Google Calender” tool as “Calender”] and the time that is fetched from the “Doctor name from doctor type” tool as confirmed by the user.\nWhile confirming the time Never give a json always return a human understandable text.\nAfter the appointment is confirmed. The user should be given a message “Your appointment with doctor name is confirmed for appointment time. The meeting link is: meeting_link.\nThe technology used in the backend should be kept confidential from the users. At all times use the data that has already been provided without the need to reconfirm it."}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.9,"position":[3260,1680],"id":"c179c760-fe94-4434-98c2-88fc768fa0c2","name":"AI Agent","retryOnFail":true},{"parameters":{"modelName":"models/gemini-2.5-flash-preview-04-17","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[2980,1900],"id":"7abd8bd2-f395-4e19-9ddd-18ec8093330a","name":"Google Gemini Chat Model","credentials":{"googlePalmApi":{"id":"Rr9Mu6c4pts6QuaI","name":"Google Gemini(PaLM) Api account 2"}}},{"parameters":{"descriptionType":"manual","toolDescription":"=It is\b this is the tool used to calendar event taking in time and the Calender arguement is value of doctor_email based on which it is decided which calender to be modified.The \"Calendar\" is the \"doctor_email\" is the same as it was returned by the \"Doctor name from doctor type\" tool. The conference data creates a google meets link.\n","calendar":{"__rl":true,"value":"={{ $fromAI('Calendar', ``, 'string') }}","mode":"id"},"start":"={{ $fromAI('Start', ``, 'string') }}","end":"={{ $fromAI('End', `All calls should be 30 minute calls `, 'string') }}","additionalFields":{"attendees":["={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('attendees0_Attendees', ``, 'string') }}"],"conferenceDataUi":{"conferenceDataValues":{"conferenceSolution":"hangoutsMeet"}},"description":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Description', `This is a doctors call to discuss the problems`, 'string') }}","sendUpdates":"all"}},"type":"n8n-nodes-base.googleCalendarTool","typeVersion":1.3,"position":[3460,1900],"id":"af9f5e8d-bff5-4f1c-bd84-4b833d7da283","name":"Google Calendar","notesInFlow":false,"credentials":{"googleCalendarOAuth2Api":{"id":"uD8AIc77E2dJeCtx","name":"Google Calendar account"}}},{"parameters":{"updates":["messages"],"options":{}},"type":"n8n-nodes-base.whatsAppTrigger","typeVersion":1,"position":[2540,1580],"id":"fb002783-2cc2-492b-be06-5c49d85f855d","name":"WhatsApp Trigger","webhookId":"2112e2d6-eb7b-4174-8036-561d8483a276","credentials":{"whatsAppTriggerApi":{"id":"UfASsGand3ZSI5HF","name":"client_whatsapp_credentials_test"}}},{"parameters":{"operation":"send","phoneNumberId":"663897360139971","recipientPhoneNumber":"={{ $('WhatsApp Trigger').item.json.contacts[0].wa_id }}","textBody":"={{ $json.output }}","additionalFields":{}},"type":"n8n-nodes-base.whatsApp","typeVersion":1,"position":[3900,1680],"id":"1200f5d7-0a57-45bf-a896-331ffcaf5107","name":"WhatsApp Business Cloud","webhookId":"a4951b12-66ee-4cfe-8dcc-bc0c9877b4c8","credentials":{"whatsAppApi":{"id":"nBVgZXsrvygmo4YW","name":"WhatsApp account"}}},{"parameters":{"sessionIdType":"customKey","sessionKey":"={{ $('WhatsApp Trigger').item.json.contacts[0].wa_id + \"-\" + $now.toFormat('ddMMyyyy') }}","databaseName":"n8n","contextWindowLength":60},"type":"@n8n/n8n-nodes-langchain.memoryMongoDbChat","typeVersion":1,"position":[3100,1900],"id":"b656dd1a-3511-424e-b2c3-db319ccc8af8","name":"MongoDB Chat Memory","credentials":{"mongoDb":{"id":"OHt6EMCkQvYJfIIU","name":"MongoDB account"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.chatTrigger","typeVersion":1.1,"position":[2760,1780],"id":"cac73b28-366e-4d45-acaa-8048f4f4ca54","name":"When chat message received","webhookId":"e689c07d-f31c-473f-a6f0-b9ff09556051","disabled":true},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"34db2c23-e7a9-4960-9ad6-021cee81b6ab","leftValue":"={{ $json.messages }}","rightValue":"","operator":{"type":"array","operation":"exists","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[2760,1580],"id":"ed64fd2d-4294-4240-b560-99ab2511de7f","name":"If"},{"parameters":{"description":"Call this tool to create an payment link that takes a json as inout with key as \"value\" and json value as a numerical value that is equal to or more than 100. The tool returns a json with keys \"status\" being \"sucess\" or \"failed\" and a \"url\" and another key \"plink\" that symbolises the paymentlink that is used to fetch the transaction status.","workflowId":{"__rl":true,"value":"Jm4jj4J39lBdwyhv","mode":"list","cachedResultName":"Create_Payment_Link"},"workflowInputs":{"mappingMode":"defineBelow","value":{"value":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('value', `a number value that is greater than or equal to 100`, 'number') }}"},"matchingColumns":["value"],"schema":[{"id":"value","displayName":"value","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"number","removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false}},"type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":2.2,"position":[3580,1900],"id":"55981e8b-f072-4c6d-9d96-0221f4d270cf","name":"Create payment link"},{"parameters":{"description":"Uses the plink from the tool \"Create_Payment_Link\" tool and check the status of the payment. It accepts a string plink as arguement, generated from the tool \"Create_Payment_Link\" and returns a json having the status.","workflowId":{"__rl":true,"value":"4P75zLRFqQuYYx0S","mode":"list","cachedResultName":"Check_payment_status"},"workflowInputs":{"mappingMode":"defineBelow","value":{"plink":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('plink', `a string generated from the tool \"Create_Payment_Link\"`, 'string') }}"},"matchingColumns":["plink"],"schema":[{"id":"plink","displayName":"plink","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string"}],"attemptToConvertTypes":false,"convertFieldsToString":false}},"type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":2.2,"position":[3700,1900],"id":"da7a47e7-52dd-4cdb-8a17-4cb432dc666b","name":"Check Payment Status"}],"connections":{"Google Sheets":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Doctor name from doctor type":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Google Gemini Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"Google Calendar":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"WhatsApp Trigger":{"main":[[{"node":"If","type":"main","index":0}]]},"AI Agent":{"main":[[{"node":"WhatsApp Business Cloud","type":"main","index":0}]]},"MongoDB Chat Memory":{"ai_memory":[[{"node":"AI Agent","type":"ai_memory","index":0}]]},"When chat message received":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"If":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"Create payment link":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Check Payment Status":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]}},"settings":{"executionOrder":"v1","timezone":"Asia/Kolkata","callerPolicy":"workflowsFromSameOwner"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"WhatsApp Trigger":[{"json":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"919211359833","phone_number_id":"663897360139971"},"contacts":[{"profile":{"name":"Rahul"},"wa_id":"917982128332"}],"messages":[{"from":"917982128332","id":"wamid.HBgMOTE3OTgyMTI4MzMyFQIAEhgUM0FFMEFBNDZGRjZEQzcxMEY1RDUA","timestamp":"1749632367","text":{"body":"Ok give a link"},"type":"text"}],"field":"messages"}}]},"versionId":"0e32dcfc-81fc-40d8-b439-503ff2bb2ae6","triggerCount":1,"tags":[],"shared":[{"createdAt":"2025-06-15T09:43:52.845Z","updatedAt":"2025-06-15T09:43:52.845Z","role":"workflow:owner","workflowId":"NqiWMbuPuduOOnot","projectId":"UuIRn3TQYG7gFAJh","project":{"createdAt":"2025-06-02T06:58:10.171Z","updatedAt":"2025-06-02T11:56:13.936Z","id":"UuIRn3TQYG7gFAJh","name":"Kshitiz Gupta <kshitiz305@live.com>","type":"personal","icon":null,"description":null}}]},{"createdAt":"2025-02-08T12:22:40.141Z","updatedAt":"2025-02-09T06:20:23.050Z","id":"mXcP3hZ8tVAnipUP","name":"My workflow","active":false,"isArchived":false,"nodes":[{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.chatTrigger","typeVersion":1.1,"position":[-60,-60],"id":"20cf32ad-3a42-4a50-8711-f520dfe9b8f0","name":"When chat message received","webhookId":"5b44818f-753e-4a03-8670-0d8fdfbbbdbd"},{"parameters":{"model":"google/gemini-2.0-flash-exp:free","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[240,140],"id":"5b0239c2-24c4-4490-af95-28b0d45566b1","name":"OpenRouter Chat Model","credentials":{"openRouterApi":{"id":"FFA0fFMM0Ktp2Glf","name":"OpenRouter account"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[240,-40],"id":"66c507a2-1fc7-4055-99b8-ba0a020583ab","name":"AI Agent"},{"parameters":{},"type":"@n8n/n8n-nodes-langchain.toolWikipedia","typeVersion":1,"position":[500,200],"id":"dc02fde3-4417-406b-b823-2b3f1f2846ba","name":"Wikipedia"}],"connections":{"When chat message received":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"OpenRouter Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"Wikipedia":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"193f4a6c-6317-4d13-953d-6b203462e1e0","triggerCount":0,"tags":[],"shared":[{"createdAt":"2025-06-02T13:19:58.333Z","updatedAt":"2025-06-02T13:19:58.333Z","role":"workflow:owner","workflowId":"mXcP3hZ8tVAnipUP","projectId":"UuIRn3TQYG7gFAJh","project":{"createdAt":"2025-06-02T06:58:10.171Z","updatedAt":"2025-06-02T11:56:13.936Z","id":"UuIRn3TQYG7gFAJh","name":"Kshitiz Gupta <kshitiz305@live.com>","type":"personal","icon":null,"description":null}}]},{"createdAt":"2025-05-11T06:29:23.212Z","updatedAt":"2025-05-11T06:50:57.233Z","id":"STPS1iNzacB4T6c2","name":"Whatsapp Conversation Optimized Query","active":false,"isArchived":false,"nodes":[{"parameters":{"descriptionType":"manual","toolDescription":"this needs to be used only when all the data related to the patient is available along with the doctor they need a appointment from.","operation":"append","documentId":{"__rl":true,"value":"15dOz4nD1iDO26zU5ZYnP_9PqBSBUqEzDTcsI_YQnTX4","mode":"list","cachedResultName":"Appointment Sheet","cachedResultUrl":"https://docs.google.com/spreadsheets/d/15dOz4nD1iDO26zU5ZYnP_9PqBSBUqEzDTcsI_YQnTX4/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Sheet1","cachedResultUrl":"https://docs.google.com/spreadsheets/d/15dOz4nD1iDO26zU5ZYnP_9PqBSBUqEzDTcsI_YQnTX4/edit#gid=0"},"columns":{"mappingMode":"defineBelow","value":{"patient_name":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('patient_name', `This is the name of the patient to be entered after asking.`, 'string') }}","age":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('age', `This is the age of the patient to be entered after asking.`, 'string') }}","gender":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('gender', `keep the format as M for male and F for female.`, 'string') }}","doctor_name":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('doctor_name', `In case the patient opts in for an appointment this needs to be filled.`, 'string') }}","time":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('time', `The time at which the appointment is confirmed`, 'string') }}","patient_number":"={{ $('WhatsApp Trigger').item.json.metadata.display_phone_number }}"},"matchingColumns":["patient_number"],"schema":[{"id":"appointment_id","displayName":"appointment_id","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"patient_number","displayName":"patient_number","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"patient_name","displayName":"patient_name","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"time","displayName":"time","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"age","displayName":"age","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"gender","displayName":"gender","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"doctor_name","displayName":"doctor_name","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"appointment_link","displayName":"appointment_link","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"form_link","displayName":"form_link","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheetsTool","typeVersion":4.5,"position":[3220,1900],"id":"3b7aeb39-50f8-46f3-97d0-b77287f68b4e","name":"Google Sheets","credentials":{"googleSheetsOAuth2Api":{"id":"n1mJzLfz9loDmBOy","name":"OAuth Account kshitiz305280@gmail.com"}}},{"parameters":{"description":"This will only be used to find the doctors availability. This tool takes input the type of doctor along with the time of appointment and it returns Doctor Name : Name of doctor\nType: type that was the input\nCall Link: Link of the call to b e scheduled\nAvailability Timings: Time available \ndoctor_email: email address used to book calendar invite\nif doctor available else if there is an error it should return that doctor is not available.Time needs to be converted to  ISO i.e. format YYYY-MM-DDTHH:mm:ss.sss","workflowId":{"__rl":true,"value":"M0SkIJsQzuCrQsYK","mode":"list","cachedResultName":"Doctor selection"},"workflowInputs":{"mappingMode":"defineBelow","value":{"query":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('query', `This is the doctor type selected by the user`, 'string') }}","time":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('time', `This is the time that is provided by the user to check for the availablity.This needs to be provided in ISO i.e. format YYYY-MM-DDTHH:mm:ss.sss`, 'string') }}"},"matchingColumns":[],"schema":[{"id":"query","displayName":"query","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string"},{"id":"time","displayName":"time","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string"}],"attemptToConvertTypes":false,"convertFieldsToString":false}},"type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":2.2,"position":[3340,1900],"id":"1a8f1cfb-10c0-49ac-a9d1-3e8dfeb43289","name":"Doctor name from doctor type"},{"parameters":{"promptType":"define","text":"={{$json.messages[0].text.body }}","options":{"systemMessage":"=You are a specialized CHATBOT. Your primary functions are to provide preliminary medical guidance and facilitate appointment setting.\nToday's date is: {{$now}}\nCore Directives (Apply Throughout):\nDisclaimer (Once at Start): Your VERY FIRST message to the user must be a disclaimer: \"Please remember, I am an AI assistant. The information provided is for general guidance only and cannot substitute professional medical advice. Always consult a qualified doctor for diagnosis and treatment.\" Do NOT repeat this disclaimer.\nNo AI Self-Identification: After the initial disclaimer, do NOT identify yourself as an AI, chatbot, or language model. Focus on the task.\nGuidance & Redirection: Provide general advice related to user-described symptoms and then guide them towards consulting a specialist.\nBackend Confidentiality: Do not mention or allude to backend technologies, Google Sheets, or specific tool names (like \"Doctor name from doctor type\" tool) to the user.\nData Persistence: Use information already provided by the user (name, age, etc.) without re-asking, unless clarification is genuinely needed.\nHuman-Readable Output: All responses to the user must be in natural, human-readable language. Never output JSON or technical formats to the user.\nGoogle Sheet Data: All data destined for Google Sheets must be in English, regardless of the interaction language with the user. Gender should be stored as 'M' for male and 'F' for female.\nConversational Flow & Logic:\nPhase 1: Setup & Initial Information\nLanguage Selection (After Disclaimer):\nAI Asks: \"Welcome! Please select your preferred language: \\n1. Hindi \\n2. English\"\nAction: Adapt all subsequent interactions to the chosen language.\nAI Service Fee & Payment (After Language Selection):\nAI States: \"Thank you. Please note that this AI guidance service has a fee of Rs 20. To proceed, please complete the payment using this link: [8882@upi]. Let me know once you have completed the payment.\"\nAction: Wait for user confirmation of payment before proceeding.\nPatient Demographics (After Payment Confirmation):\nAI Asks: \"Great, let's get started. Could you please tell me the patient's name, age, and gender?\"\nData Handling:\nName can be first name or full name.\nStore gender as 'M' or 'F' (for backend/Google Sheets).\nAge Gate (Internal Check - Do NOT mention the age numbers to the user):\nIF age < 16 OR age > 85:\nAI Responds: \"Thank you for the information. For patients of this age, it's best to consult a doctor in person. Please seek a physical consultation with a healthcare professional.\"\nAction: End the appointment setting flow here. You may offer to help find a clinic if that's a separate feature, but do not proceed with AI consultation or specialist booking.\nELSE (age is 16-85 inclusive):\nAction: Proceed to Phase 2.\nPhase 2: Symptom Assessment & Initial Advice\nIssue Inquiry:\nAI Asks: \"Thank you. Now, please describe the medical issue or symptoms the patient is experiencing.\"\nProvide General Advice (Crucial Step - Always Before Doctor Recommendation):\nAction: Based on the user's description of symptoms, provide brief, general, non-prescriptive advice.\nExample (if user mentions a cold): \"For symptoms like a runny nose and cough, ensuring adequate rest and hydration can be helpful. Over-the-counter remedies for symptom relief may also be considered, but it's good to understand the cause.\"\nPhase 3: Severity Categorization & Specialist Recommendation\nSeverity Categorization (Internal AI Logic - Do NOT explain criteria to user):\nBased on the symptoms described, classify the issue into one of the following categories. Present the category name with its corresponding emoji and response:\nMild 🟢 (Can Wait): Criteria (Minor, short-duration symptoms, no major risk factors).\nAI Responds: \"🟢 Your condition appears mild. You may wait and monitor your symptoms, but consulting a doctor is recommended within the next 48 hours to be safe.\"\nModerate 🟠 (Needs Consultation Soon): Criteria (Persistent symptoms, mild complications, known comorbidities).\nAI Responds: \"🟠 Based on your symptoms, we recommend speaking with a doctor soon. Please proceed to book a consultation, ideally today.\"\nSevere 🔴 (Needs Immediate Attention): Criteria (High fever, chest pain, severe dehydration, difficulty breathing, etc.).\nAI Responds: \"🔴 Your symptoms suggest a condition that may need prompt attention. Please book a consultation immediately. If your symptoms worsen or you experience any emergency signs, please seek emergency medical help without delay.\"\nConsultation Fee & Specialist Recommendation:\nAI States: \"A consultation with a doctor is a paid service and will be charged Rs 400 per session.\"\nAI Recommends (Based on symptoms and severity): \"Based on your responses, we recommend a consultation with a [Suggest one Specialist Type from list below].\"\nAvailable Specialist Types (Only offer from this list):\nGeneral Physician\nGynaecologist\nPaediatrician\nDermatologist\nPsychologist\nOrthopaedic\nGeneral Surgeon\nAI Asks for Confirmation/Choice: \"Do you want to proceed with this recommendation? (Select Yes) Or would you like to choose a different specialist from the list above? (Select the number corresponding to your choice).\"\nAction:\nIf \"Yes\", note the recommended specialist.\nIf user selects a number, note that specialist type. Do not allow choices outside the provided list. Do not offer specific doctor names.\nPhase 4: Appointment Booking & Payment\nTime Slot Selection:\nAI Asks: \"Understood. Please let me know your preferred time for the consultation. We have slots available between 9 AM and 5 PM today and for the next few days.\" (Adapt based on actual availability if possible, or offer general options like \"morning/afternoon\" and specific dates).\nInternal Conversion: Once the user provides a time, convert it to YYYY-MM-DDTHH:mm:ss.sss format for backend tool usage. Do NOT show this format to the user.\nConsultation Fee Payment:\nAI States: \"To confirm your appointment for the Rs 400 consultation fee, please complete the payment using this link: [8882@upi]. Let me know once this is done.\"\nAction: Wait for user confirmation of payment.\nPhase 5: Finalizing Appointment & Confirmation (Post-Payment)\nFetch Doctor Details (Simulated Tool Use):\nAI Action (Internal): \"I will now find an available [Chosen Specialist Type].\"\nYou will simulate using a tool (\"Doctor name from doctor type\"). Assume this tool returns:\ndoctor_name\ndoctor_email (e.g., doc_gp_alpha@example.com)\nconfirmed_time_slot (in a user-friendly format, e.g., \"Tomorrow, 3:00 PM\")\nError Handling (Internal): If the simulated tool were to fail (e.g., \"resource not found\" for calendar later), you would recheck the doctor_email if it's implicated. For now, assume success.\nConfirm Doctor & Time with User:\nAI States: \"Great! We have an appointment available with Dr. [doctor_name] ([Chosen Specialist Type]) at [confirmed_time_slot]. Would you like to confirm this?\"\nGoogle Sheet Entry (On User Confirmation - Simulated):\nAction (Internal): If the user confirms \"Yes\":\nPrepare the following data for Google Sheets (all in English): Patient Name, Age, Gender (M/F), Symptoms (brief summary if possible), Chosen Specialist Type, Dr. [doctor_name], [confirmed_time_slot in ISO if needed for sheet, or user-friendly if preferred for sheet].\nCreate Calendar Invite (Simulated Tool Use):\nAI Action (Internal): \"I will now schedule this on the doctor's calendar.\"\nYou will simulate using a Calendar tool. The doctor_email (e.g., doc_gp_alpha@example.com) is the Calendar ID. The event will include patient name and appointment time.\nFinal Confirmation to User:\nAI States: \"Excellent! Your appointment with Dr. [doctor_name] at [confirmed_time_slot] is confirmed. You will receive a confirmation shortly (if applicable, or simply state it's booked). Please be ready a few minutes before your scheduled time.\"\n(If applicable) \"If you need to reschedule or cancel, please contact us at [Support Channel/Number - if this exists].\"\n"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.9,"position":[3132,1680],"id":"ecca82dc-22b1-4dcf-b6df-6812f3a69a73","name":"AI Agent","retryOnFail":true},{"parameters":{"modelName":"models/gemini-2.5-pro-preview-05-06","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[2980,1900],"id":"bef0603e-54cd-4e08-b523-ed1241e92158","name":"Google Gemini Chat Model","credentials":{"googlePalmApi":{"id":"Rr9Mu6c4pts6QuaI","name":"Google Gemini(PaLM) Api account 2"}}},{"parameters":{"descriptionType":"manual","toolDescription":"=It is\b this is the tool used to calendar event taking in time and the Calender is value of doctor_email based on which it is decided which calender to be modified.The \"Calendar\" is the \"doctor_email\" is the same as it was returned by the \"Doctor name from doctor type\" tool. It should be ending with `@gmail.com`\nThe calender `Conference Data` - created a link that should be shared when a new calender event is created and this cannot be \"\" or null..","calendar":{"__rl":true,"value":"={{ $fromAI('Calendar', ``, 'string') }}","mode":"id"},"start":"={{ $fromAI('Start', ``, 'string') }}","end":"={{ $fromAI('End', `All calls should be 30 minute calls `, 'string') }}","additionalFields":{"attendees":["={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('attendees0_Attendees', ``, 'string') }}"],"conferenceDataUi":{"conferenceDataValues":{}},"description":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Description', `This is a doctors call to discuss the problems`, 'string') }}","sendUpdates":"all"}},"type":"n8n-nodes-base.googleCalendarTool","typeVersion":1.3,"position":[3460,1900],"id":"b4678d7e-828c-46a1-8481-0a6e429a5f92","name":"Google Calendar","notesInFlow":false,"credentials":{"googleCalendarOAuth2Api":{"id":"uD8AIc77E2dJeCtx","name":"Google Calendar account"}}},{"parameters":{"updates":["messages"],"options":{}},"type":"n8n-nodes-base.whatsAppTrigger","typeVersion":1,"position":[2540,1580],"id":"eb15d114-42e6-421f-a8a5-a27f6cce5419","name":"WhatsApp Trigger","webhookId":"75e85317-a0f1-4245-872a-0dace81bcf75","credentials":{"whatsAppTriggerApi":{"id":"UfASsGand3ZSI5HF","name":"client_whatsapp_credentials"}}},{"parameters":{"operation":"send","phoneNumberId":"572325512642102","recipientPhoneNumber":"={{ $('WhatsApp Trigger').item.json.contacts[0].wa_id }}","textBody":"={{ $json.output }}","additionalFields":{}},"type":"n8n-nodes-base.whatsApp","typeVersion":1,"position":[3660,1680],"id":"8eeba6f5-7226-44b7-ada0-2421885e65a8","name":"WhatsApp Business Cloud","webhookId":"b9d7fc45-cb2e-417e-a660-92ce984f9bea","credentials":{"whatsAppApi":{"id":"JAr6Zj4Rhqnze7CL","name":"WhatsApp Client "}}},{"parameters":{"sessionIdType":"customKey","sessionKey":"={{$('WhatsApp Trigger').item.json.contacts[0].wa_id}}","databaseName":"n8n","contextWindowLength":60},"type":"@n8n/n8n-nodes-langchain.memoryMongoDbChat","typeVersion":1,"position":[3100,1900],"id":"0513e453-85da-4ff8-8f1b-9803f714d96a","name":"MongoDB Chat Memory","credentials":{"mongoDb":{"id":"OHt6EMCkQvYJfIIU","name":"MongoDB account"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.chatTrigger","typeVersion":1.1,"position":[2760,1780],"id":"e35744dc-62c5-453a-9023-a2317506c8cc","name":"When chat message received","webhookId":"ed408887-8730-44ad-8c4c-c884421fcb54","disabled":true},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"34db2c23-e7a9-4960-9ad6-021cee81b6ab","leftValue":"={{ $json.messages }}","rightValue":"","operator":{"type":"array","operation":"exists","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[2760,1580],"id":"ab5963dd-fbc5-4868-9ad2-9a9ad3cfde5b","name":"If"},{"parameters":{"sessionIdType":"customKey","sessionKey":"={{ $('WhatsApp Trigger').item.json.contacts[0].wa_id }}","contextWindowLength":30},"type":"@n8n/n8n-nodes-langchain.memoryBufferWindow","typeVersion":1.3,"position":[2540,1920],"id":"0d229bc2-d772-48de-9301-48865864087e","name":"Simple Memory"}],"connections":{"Google Sheets":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Doctor name from doctor type":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Google Gemini Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"Google Calendar":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"WhatsApp Trigger":{"main":[[{"node":"If","type":"main","index":0}]]},"AI Agent":{"main":[[{"node":"WhatsApp Business Cloud","type":"main","index":0}]]},"MongoDB Chat Memory":{"ai_memory":[[{"node":"AI Agent","type":"ai_memory","index":0}]]},"When chat message received":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"If":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"Simple Memory":{"ai_memory":[[]]}},"settings":{"executionOrder":"v1","timezone":"Asia/Kolkata","callerPolicy":"workflowsFromSameOwner"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"WhatsApp Trigger":[{"json":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556439025","phone_number_id":"572325512642102"},"contacts":[{"profile":{"name":"KSHITIZ"},"wa_id":"918882961517"}],"messages":[{"from":"918882961517","id":"wamid.HBgMOTE4ODgyOTYxNTE3FQIAEhgWM0VCMDMzMEQ4QzcxODg3RkUzNDdCMwA=","timestamp":"1746945594","text":{"body":"retry"},"type":"text"}],"field":"messages"}}]},"versionId":"aebae479-7e1d-4bee-bcc3-e170a4490b08","triggerCount":1,"tags":[],"shared":[{"createdAt":"2025-06-02T13:19:58.333Z","updatedAt":"2025-06-02T13:19:58.333Z","role":"workflow:owner","workflowId":"STPS1iNzacB4T6c2","projectId":"UuIRn3TQYG7gFAJh","project":{"createdAt":"2025-06-02T06:58:10.171Z","updatedAt":"2025-06-02T11:56:13.936Z","id":"UuIRn3TQYG7gFAJh","name":"Kshitiz Gupta <kshitiz305@live.com>","type":"personal","icon":null,"description":null}}]},{"createdAt":"2025-05-10T10:30:05.822Z","updatedAt":"2025-05-10T10:30:05.822Z","id":"x3YeS0ByYVZAx1dE","name":"webhook test","active":false,"isArchived":false,"nodes":[],"connections":{},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"322fb7f2-166e-45a8-8f86-66396af709d2","triggerCount":0,"tags":[],"shared":[{"createdAt":"2025-06-02T13:19:58.333Z","updatedAt":"2025-06-02T13:19:58.333Z","role":"workflow:owner","workflowId":"x3YeS0ByYVZAx1dE","projectId":"UuIRn3TQYG7gFAJh","project":{"createdAt":"2025-06-02T06:58:10.171Z","updatedAt":"2025-06-02T11:56:13.936Z","id":"UuIRn3TQYG7gFAJh","name":"Kshitiz Gupta <kshitiz305@live.com>","type":"personal","icon":null,"description":null}}]},{"createdAt":"2025-08-21T06:43:48.093Z","updatedAt":"2025-08-30T07:04:43.308Z","id":"E0meNN3ktwlAa1jt","name":"parkplus","active":false,"isArchived":false,"nodes":[{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[0,0],"id":"e1524897-f374-4fd8-adb9-fbdbdab2b8b8","name":"When clicking ‘Execute workflow’"},{"parameters":{"language":"python","pythonCode":"import requests\n\nheaders = {\n    'accept': 'application/json, text/plain, */*',\n    'accept-language': 'en-US,en;q=0.9,af;q=0.8',\n    'app-name': 'Park+ PWA',\n    'authorization': 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJleHAiOjE3NTgzNTAwNTgsInN1YiI6Ijg2MjYxOTIiLCJ1bmlxdWVfaWQiOiJVUlNLT05Za1JrTFVYSWtZeHVkdklYTUFIUm5jUWtvalhzWnBhUXFDeG5GV0dEU2RtY2p2d1VsdlRXVmdXV0t4IiwiaHR0cHM6Ly9wYXJrd2hlZWxzLmNvLmluLyI6eyJ1c2VyX2lkIjo4NjI2MTkyLCJuYW1lIjoiS3NoaXRpeiBndXB0YSIsImVtYWlsIjoiIiwicGhvbmVfbnVtYmVyIjoiODg4Mjk2MTUxNyIsInJvbGUiOiJjbGllbnQiLCJkZXZpY2VfaWQiOiIiLCJ2ZXJzaW9uIjo0LCJ0ZXN0X3VzZXIiOmZhbHNlfX0.3SBmne5r1QVRdtu2goXENkfBOR7HZ0j-MORw9rQrjhEZdzKB02097kiNqp2igIuLArjO658Ze1gF1QK0x1Sqaw',\n    'cache-control': 'no-cache',\n    'client-id': '8186c1be-660f-428c-93a7-6480c2d8af66',\n    'client-secret': 'hjjh0uw8c3j7vw5jgba8',\n    'origin': 'https://parkplus.io',\n    'package-name': 'web.pwa',\n    'platform': 'web',\n    'priority': 'u=1, i',\n    'referer': 'https://parkplus.io/',\n    'sec-ch-ua': '\"Not;A=Brand\";v=\"99\", \"Google Chrome\";v=\"139\", \"Chromium\";v=\"139\"',\n    'sec-ch-ua-mobile': '?0',\n    'sec-ch-ua-platform': '\"macOS\"',\n    'sec-fetch-dest': 'empty',\n    'sec-fetch-mode': 'cors',\n    'sec-fetch-site': 'same-site',\n    'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36',\n}\n\nparams = {\n    'reward_group_id': '1',\n    'use_wallet': 'true',\n    'latitude': 'undefined',\n    'longitude': 'undefined',\n}\n\nresponse = requests.get('https://parkplus-gamification.parkplus.io/api/v1/spin-the-wheel/spin', params=params, headers=headers)\nprint(response.json())"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[220,0],"id":"2cbeee9a-ca68-4dfa-b478-375cb55fd0f1","name":"Code"}],"connections":{"When clicking ‘Execute workflow’":{"main":[[{"node":"Code","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"970eb9e7-3e27-4512-bc72-a5612613bcc7","triggerCount":0,"tags":[],"shared":[{"createdAt":"2025-08-21T06:43:48.093Z","updatedAt":"2025-08-21T06:43:48.093Z","role":"workflow:owner","workflowId":"E0meNN3ktwlAa1jt","projectId":"UuIRn3TQYG7gFAJh","project":{"createdAt":"2025-06-02T06:58:10.171Z","updatedAt":"2025-06-02T11:56:13.936Z","id":"UuIRn3TQYG7gFAJh","name":"Kshitiz Gupta <kshitiz305@live.com>","type":"personal","icon":null,"description":null}}]},{"createdAt":"2025-02-22T13:44:51.525Z","updatedAt":"2025-02-22T23:04:15.957Z","id":"ngrZ07cwWp9BQORt","name":"Generate Instagram Content from Top Trends with AI Image Generation","active":false,"isArchived":false,"nodes":[{"parameters":{"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"0304efee-33b2-499e-bad1-9238c1fc2999","operator":{"name":"filter.operator.equals","type":"string","operation":"equals"},"leftValue":"={{ $json.status_code }}","rightValue":"FINISHED"}]},"options":{}},"id":"8c49be2b-6320-4eb0-8303-6448ced34636","name":"If media status is finished","type":"n8n-nodes-base.if","position":[4980,1440],"typeVersion":2.2},{"parameters":{"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"0304efee-33b2-499e-bad1-9238c1fc2999","operator":{"name":"filter.operator.equals","type":"string","operation":"equals"},"leftValue":"={{ $json.status_code }}","rightValue":"PUBLISHED"}]},"options":{}},"id":"f0cc0be5-6d35-4334-a124-139fa8676d07","name":"If media status is finished1","type":"n8n-nodes-base.if","position":[5560,1440],"typeVersion":2.2},{"parameters":{"chatId":"={{ $('Telegram Params').item.json.telegram_chat_id }}","text":"Video upload edilmeden önce bir problem oldu","additionalFields":{}},"id":"c8d8d8cd-8501-4d1b-ac28-8cb3fa74d9d7","name":"Telegram","type":"n8n-nodes-base.telegram","position":[5140,1620],"typeVersion":1.2,"webhookId":"df35e14f-e0dc-4eea-a776-7d3e72e0b5ed"},{"parameters":{"chatId":"={{ $('Telegram Params').item.json.telegram_chat_id }}","text":"Instagram Content is shared","additionalFields":{}},"id":"ae91a5e0-4f70-4a1c-afa5-41f5449facab","name":"Telegram1","type":"n8n-nodes-base.telegram","position":[5720,1280],"typeVersion":1.2,"webhookId":"38a0e1e3-cb55-4eda-860a-30666891c13b"},{"parameters":{"chatId":"={{ $('Telegram Params').item.json.telegram_chat_id }}","text":"There was a problem when execution a upload content to instagram","additionalFields":{}},"id":"b8b38440-14a7-43f6-ac49-6ca9502ff54d","name":"Telegram2","type":"n8n-nodes-base.telegram","position":[5720,1620],"typeVersion":1.2,"webhookId":"c0d7531b-1904-4103-a249-f755412a058f"},{"parameters":{"options":{}},"id":"82e0e5d0-bf50-4b2e-8693-2612dffe53e2","name":"Loop Over Items","type":"n8n-nodes-base.splitInBatches","position":[2560,1400],"typeVersion":3},{"parameters":{"rule":{"interval":[{"field":"cronExpression","expression":"5 13,19 * * *"}]}},"id":"fb72beb1-1a6a-4148-9ee4-cdc564c4dc5c","name":"Schedule Trigger1","type":"n8n-nodes-base.scheduleTrigger","position":[480,1480],"typeVersion":1.2},{"parameters":{"assignments":{"assignments":[{"id":"d18cdca7-d301-4c70-a4d0-8d6e7ecfc2d1","name":"telegram_chat_id","type":"string","value":""}]},"options":{}},"id":"470f3406-19d2-420c-8f33-7031237d882c","name":"Telegram Params","type":"n8n-nodes-base.set","position":[1240,1480],"typeVersion":3.4},{"parameters":{"assignments":{"assignments":[{"id":"1e380c14-e908-4eeb-90e0-957a422829d0","name":"instagram_business_account_id","type":"string","value":""}]},"options":{}},"id":"12971505-7061-4d32-8921-d2e731eae9db","name":"Instagram params","type":"n8n-nodes-base.set","position":[1000,1480],"typeVersion":3.4},{"parameters":{"content":"## All Credentials You Need\n**  Instagram Business Account Id\n** Telegram Chat Id\n**  Rapid Api Key\n** Replicate Token","height":600,"width":1000,"color":4},"id":"3cb5f27d-eb3b-4fdc-bb55-1b54f85298e5","name":"Sticky Note2","type":"n8n-nodes-base.stickyNote","position":[700,1200],"typeVersion":1},{"parameters":{"assignments":{"assignments":[{"id":"48a33ec7-2b4f-496a-ad77-e4d5f1907ee4","name":"x-rapid-api-key","type":"string","value":""}]},"options":{}},"id":"2bc617b8-835c-48ba-8de6-341a6c87b853","name":"Rapid Api params","type":"n8n-nodes-base.set","position":[1480,1480],"notesInFlow":false,"typeVersion":3.4,"notes":"test"},{"parameters":{"jsCode":"const filteredData = $input.first().json.data.items.filter(item=> !item.is_video)\nreturn filteredData.map((item)=>{\n  return {\n    id: item.id,\n    prompt: item.caption.text,\n    content_code: item.code,\n    thumbnail_url: item.thumbnail_url,\n    tag: $input.first().json.data.additional_data.name\n  }\n})                                                                    \n\n"},"id":"23bad41e-40ac-4488-8b2f-0d54d22a927a","name":"filter the image content","type":"n8n-nodes-base.code","position":[2080,1560],"typeVersion":2},{"parameters":{"url":"https://instagram-scraper-api2.p.rapidapi.com/v1/hashtag","sendQuery":true,"queryParameters":{"parameters":[{"name":"hashtag","value":"blender3d"},{"name":"feed_type","value":"top"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"x-rapidapi-host","value":"instagram-scraper-api2.p.rapidapi.com"},{"name":"x-rapidapi-key","value":"={{ $json['x-rapid-api-key'] }}"}]},"options":{}},"id":"a65690cd-4d30-4541-b80d-aae872326a77","name":"get  top trends on instagram #blender3d","type":"n8n-nodes-base.httpRequest","position":[1840,1360],"typeVersion":4.2},{"parameters":{"url":"https://instagram-scraper-api2.p.rapidapi.com/v1/hashtag","sendQuery":true,"queryParameters":{"parameters":[{"name":"hashtag","value":"isometric"},{"name":"feed_type","value":"top"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"x-rapidapi-host","value":"instagram-scraper-api2.p.rapidapi.com"},{"name":"x-rapidapi-key","value":"={{ $json['x-rapid-api-key'] }}"}]},"options":{}},"id":"8707c475-7e28-4d80-92b8-ba24033c4632","name":"get top trends on instagram #isometric","type":"n8n-nodes-base.httpRequest","position":[1840,1560],"typeVersion":4.2},{"parameters":{},"id":"1c1bfd8f-b086-4147-ba08-578877f2a315","name":"merge the array content","type":"n8n-nodes-base.merge","position":[2280,1460],"typeVersion":3},{"parameters":{"content":"## Schedule Your Time To  Post\n","height":600,"width":280,"color":3},"id":"dcc2b6b6-9880-4676-8a1a-a3c21e583bba","name":"Sticky Note3","type":"n8n-nodes-base.stickyNote","position":[380,1200],"typeVersion":1},{"parameters":{"content":"## Guide \n** [Guide](https://docs.matillion.com/metl/docs/6957316//) of getting  of Instagram Business Account Id ","height":300,"width":180,"color":5},"id":"c1e0ac33-c4b7-47d8-bd2b-0b74b02afe38","name":"Sticky Note4","type":"n8n-nodes-base.stickyNote","position":[960,1340],"typeVersion":1},{"parameters":{"content":"## Guide \n** [Guide](https://rapidapi.com/i-yqerddkq0t/api/telegram92/tutorials/how-to-get-the-id-of-a-telegram-channel,-chat,-user-or-bot%3F) of Getting  of Telegram Chat Id ","height":300,"width":180,"color":5},"id":"321680da-ca7a-4c6f-98d4-a0d8f8d0347f","name":"Sticky Note5","type":"n8n-nodes-base.stickyNote","position":[1200,1340],"typeVersion":1},{"parameters":{"content":"## Guide \n** [Guide](https://docs.rapidapi.com/docs/keys-and-key-rotation) of Getting  of Rapid Api Key ","height":300,"width":180,"color":5},"id":"b3d07cf7-8d03-4644-88f7-2e94de0c43c2","name":"Sticky Note6","type":"n8n-nodes-base.stickyNote","position":[1440,1340],"typeVersion":1},{"parameters":{"content":"## Warning\n**Don't forgot the create bot and send a message to bot first","height":120,"width":180,"color":7},"id":"b6dbdfaa-fc71-4def-a723-bf6c0facd372","name":"Sticky Note7","type":"n8n-nodes-base.stickyNote","position":[1200,1660],"typeVersion":1},{"parameters":{"content":"## Getting Top Trend Posts On Instagram\n** Change the topic you want to get on http request","height":600,"width":660},"id":"81d598e2-8993-4315-9894-2e78dc26ad10","name":"Sticky Note8","type":"n8n-nodes-base.stickyNote","position":[1740,1200],"typeVersion":1},{"parameters":{"operation":"select","schema":{"__rl":true,"mode":"list","value":"public","cachedResultName":"public"},"table":{"__rl":true,"mode":"list","value":"top_trends","cachedResultName":"top_trends"},"where":{"values":[{"column":"code","value":"={{$json.content_code}}"}]},"options":{}},"id":"6beb79ef-8205-4882-9bb0-6a2e1a33f1d4","name":"Check Data on Database Is Exist","type":"n8n-nodes-base.postgres","position":[2800,1400],"typeVersion":2.5,"alwaysOutputData":true,"onError":"continueErrorOutput"},{"parameters":{"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"loose"},"combinator":"and","conditions":[{"id":"9dc20983-ae4d-40db-b969-7d43fa8b0c3e","operator":{"type":"boolean","operation":"true","singleValue":true},"leftValue":"={{ !$json.isEmpty() }}","rightValue":"we"},{"id":"0e1b9264-be56-4d0c-a83e-d9ca0b05b265","operator":{"name":"filter.operator.equals","type":"string","operation":"equals"},"leftValue":"","rightValue":""}]},"looseTypeValidation":true,"options":{}},"id":"5b0c05a8-3eb7-4ad8-88e8-ceef81fe7a61","name":"If Data is Exist","type":"n8n-nodes-base.if","position":[3020,1420],"executeOnce":false,"typeVersion":2.2,"alwaysOutputData":false},{"parameters":{"content":"## Looping Data And Checking For Is Exist On Database\n**We are checking until find a data we did not insert because we don't want to create content about in same content","height":600,"width":1060},"id":"557aa2c3-8d0b-42c4-b444-953a538d7ff4","name":"Sticky Note9","type":"n8n-nodes-base.stickyNote","position":[2420,1220],"typeVersion":1},{"parameters":{"chatId":"={{ $('Telegram Params').item.json.telegram_chat_id}}","text":"There was a problem execution a postgresql content","additionalFields":{}},"id":"9b510f11-9a44-4d54-b162-3ffb55d66677","name":"send error message to telegram","type":"n8n-nodes-base.telegram","position":[2560,1620],"typeVersion":1.2,"webhookId":"9819632c-5735-4a96-a9ba-a6cad91f7b8f"},{"parameters":{"schema":{"__rl":true,"mode":"list","value":"public"},"table":{"__rl":true,"mode":"list","value":"top_trends","cachedResultName":"top_trends"},"columns":{"value":{"tag":"={{$('Loop Over Items').item.json.tag}}","code":"={{$('Loop Over Items').item.json.content_code}}","prompt":"={{$('Loop Over Items').item.json.prompt}}","isposted":false,"thumbnail_url":"={{$('Loop Over Items').item.json.thumbnail_url}}"},"schema":[{"id":"id","type":"number","display":true,"removed":true,"required":false,"displayName":"id","defaultMatch":true,"canBeUsedToMatch":true},{"id":"prompt","type":"string","display":true,"required":true,"displayName":"prompt","defaultMatch":false,"canBeUsedToMatch":true},{"id":"isposted","type":"boolean","display":true,"required":false,"displayName":"isposted","defaultMatch":false,"canBeUsedToMatch":true},{"id":"createdat","type":"dateTime","display":true,"removed":true,"required":false,"displayName":"createdat","defaultMatch":false,"canBeUsedToMatch":true},{"id":"updatedat","type":"dateTime","display":true,"removed":true,"required":false,"displayName":"updatedat","defaultMatch":false,"canBeUsedToMatch":true},{"id":"deletedat","type":"dateTime","display":true,"removed":true,"required":false,"displayName":"deletedat","defaultMatch":false,"canBeUsedToMatch":true},{"id":"code","type":"string","display":true,"required":false,"displayName":"code","defaultMatch":false,"canBeUsedToMatch":true},{"id":"tag","type":"string","display":true,"required":false,"displayName":"tag","defaultMatch":false,"canBeUsedToMatch":true},{"id":"thumbnail_url","type":"string","display":true,"required":false,"displayName":"thumbnail_url","defaultMatch":false,"canBeUsedToMatch":true}],"mappingMode":"defineBelow","matchingColumns":["id"],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"id":"48bc61de-d416-4673-9e9b-8331ea841891","name":"insert data on db","type":"n8n-nodes-base.postgres","position":[3300,1420],"typeVersion":2.5},{"parameters":{"resource":"image","operation":"analyze","modelId":{"__rl":true,"mode":"list","value":"gpt-4o-mini","cachedResultName":"GPT-4O-MINI"},"text":"Create a clear and concise description of the object in the image, focusing on its physical and general features. Avoid detailed environmental aspects like background, lighting, or colors. Describe the shape, texture, size, and any unique characteristics of the object. Mention any notable features that make the object stand out, such as its surface details, materials, and design. The description should be focused on the object itself, not its surroundings.\n\nFor example, describe the following image:\n","imageUrls":"={{ $('Loop Over Items').item.json.thumbnail_url }}","options":{}},"id":"15e7d69d-a10f-48a1-b240-046e9950d077","name":"Analyze Image and give the content","type":"@n8n/n8n-nodes-langchain.openAi","position":[3640,1420],"typeVersion":1.8},{"parameters":{"modelId":{"__rl":true,"mode":"list","value":"gpt-4o-mini","cachedResultName":"GPT-4O-MINI"},"messages":{"values":[{"content":"=\nSummarize the following content description into a short, engaging Instagram caption under 150 words. The caption should focus on the content of the image, not the app. Keep it appealing to social media users, and highlight the visual details of the image. Include hashtags relevant to 3D modeling and design, such as #Blender3D, #3DArt, #DigitalArt, #3DModeling, and #ArtCommunity. Ensure the tone is friendly and inviting.\n\n\nContent description to summarize:\n{{ $json.content }}\n\nMake sure to craft the caption around the content's features, such as the color contrast, reflective surface, and artistic nature of the image.\n\n"}]},"options":{}},"id":"93e253b1-da7d-4193-b899-a38e6fd9f4e4","name":"Analyze Content And Generate Instagram Caption","type":"@n8n/n8n-nodes-langchain.openAi","position":[3840,1420],"typeVersion":1.8},{"parameters":{"content":"## Analyze Post Content\n** We are analyzing the image\n** We are generating a instagram caption by content\n** Then we are generating the image","height":600,"width":860,"color":4},"id":"9af1dc59-1d9e-4900-8f80-1eba946c4057","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","position":[3540,1200],"typeVersion":1},{"parameters":{"httpRequestMethod":"POST","graphApiVersion":"v20.0","node":"={{ $('Instagram params').item.json.instagram_business_account_id }}","edge":"media","options":{"queryParameters":{"parameter":[{"name":"image_url","value":"={{ $json.output[0] }}"},{"name":"caption","value":"={{ $('Analyze Content And Generate Instagram Caption').item.json.message.content }}"}]}}},"id":"2259f6df-dca9-4a7e-babb-e63375f7207f","name":"Prepare data on Instagram","type":"n8n-nodes-base.facebookGraphApi","position":[4540,1440],"typeVersion":1},{"parameters":{"graphApiVersion":"v20.0","node":"={{ $json.id }}","options":{"fields":{"field":[{"name":"id"},{"name":"status"},{"name":"status_code"}]}}},"id":"bcbb6058-1966-4bb5-915a-1e65b9131117","name":"Check Status Of Media Before Uploaded","type":"n8n-nodes-base.facebookGraphApi","position":[4760,1440],"typeVersion":1},{"parameters":{"httpRequestMethod":"POST","graphApiVersion":"v20.0","node":"={{ $('Instagram params').item.json.instagram_business_account_id }}","edge":"media_publish","options":{"queryParameters":{"parameter":[{"name":"creation_id","value":"={{ $json.id }}"}]}}},"id":"518d87ff-7808-4c06-b137-4e97d8f2ca28","name":"Publish Media on Instagram","type":"n8n-nodes-base.facebookGraphApi","position":[5160,1280],"typeVersion":1},{"parameters":{"graphApiVersion":"v20.0","node":"={{ $('Check Status Of Media Before Uploaded').item.json.id }}","options":{"fields":{"field":[{"name":"id"},{"name":"status"},{"name":"status_code"}]}}},"id":"a033d12b-524f-40e8-9208-5300bbc823d3","name":"Check status of post ","type":"n8n-nodes-base.facebookGraphApi","position":[5360,1440],"typeVersion":1},{"parameters":{"content":"## Publish On Instagram And Send Message When Published via Telegram\n","height":600,"width":1580,"color":5},"id":"f136e907-2938-4175-b51f-4201fbe3477d","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","position":[4440,1200],"typeVersion":1},{"parameters":{"content":"## For More About Api\n** [Facebook Scraper Api Guide](https://rapidapi.com/social-api1-instagram/api/instagram-scraper-api2/playground/apiendpoint_a45552b2-9850-4da9-b5cb-bbdd3ac2199d)","height":500,"width":260,"color":5},"id":"8145986c-5453-43ac-8d5c-c50a84a62136","name":"Sticky Note10","type":"n8n-nodes-base.stickyNote","position":[1760,1280],"typeVersion":1},{"parameters":{"jsCode":"const filteredData = $input.first().json.data.items.filter(item=> !item.is_video)\nreturn filteredData.map((item)=>{\n  return {\n    id: item.id,\n    prompt: item.caption.text,\n    content_code: item.code,\n    thumbnail_url: item.thumbnail_url,\n    tag: $input.first().json.data.additional_data.name\n  }\n})                                                                    \n\n"},"id":"02416fbb-4250-4278-af23-1f9189787123","name":"filter the image content-2","type":"n8n-nodes-base.code","position":[2080,1360],"typeVersion":2},{"parameters":{"content":"## Guide \n** [Guide](https://replicate.com) of getting  of Replicate Token ","height":300,"width":180,"color":5},"id":"2d1ea53d-1d32-4b86-8944-ce2ad4a69847","name":"Sticky Note11","type":"n8n-nodes-base.stickyNote","position":[740,1340],"typeVersion":1},{"parameters":{"assignments":{"assignments":[{"id":"1e380c14-e908-4eeb-90e0-957a422829d0","name":"replicate_token","type":"string","value":""}]},"options":{}},"id":"c8b933af-356e-49ae-92d3-42eaf4ee3e9f","name":"Replicate params","type":"n8n-nodes-base.set","position":[780,1480],"typeVersion":3.4},{"parameters":{"method":"POST","url":"https://api.replicate.com/v1/models/black-forest-labs/flux-schnell/predictions","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $('Replicate params').item.json.replicate_token}}"},{"name":"Prefer","value":"wait"}]},"sendBody":true,"specifyBody":"=json","bodyParameters":{"parameters":[{}]},"jsonBody":"={\n  \"input\": {\n    \"prompt\": \"A highly detailed 3D isometric model of {{$('Analyze Image and give the content').item.json.content   .replace(/\\\\n/g, ' ') \n.replace(/\\\\t/g, ' ') \n.replace(/\\s+/g, ' ')\n.trim(); }} rendered in a stylized miniature toy aesthetic. Materials: Matte plastic/painted metal/weathered stone texture with no self-shadowing. Lighting: - Completely shadowless rendering - Ultra bright and perfectly even illumination from all angles - Pure ambient lighting without directional shadows - Flat, consistent lighting across all surfaces - No ambient occlusion. Style specifications: - Clean, defined edges and surfaces - Slightly exaggerated proportions - Miniature/toy-like scale - Subtle wear and texturing - Rich color palette with muted tones - Isometric 3/4 view angle - Crisp details and micro-elements. Technical details: - 4K resolution - PBR materials without shadows - No depth of field - High-quality anti-aliasing - Perfect uniform lighting. Environment: Pure white background with zero shadows or gradients. Post-processing: High key lighting, maximum brightness, shadow removal.\",\n    \"output_format\": \"jpg\",\n    \"output_quality\": 100,\n    \"go_fast\":false\n  }\n}\n","options":{}},"id":"2c73cc9c-d436-459b-9b3c-bd870810b9b4","name":"Generate image on flux","type":"n8n-nodes-base.httpRequest","position":[4240,1440],"typeVersion":4.2},{"parameters":{"content":"## For top_trends Table\n```\nCREATE TABLE top_trends (\n    id SERIAL PRIMARY KEY,\n    isposted BOOLEAN DEFAULT false,\n    createdat TIMESTAMP WITHOUT TIME ZONE DEFAULT CURRENT_TIMESTAMP,\n    updatedat TIMESTAMP WITHOUT TIME ZONE DEFAULT CURRENT_TIMESTAMP,\n    deletedat TIMESTAMP WITHOUT TIME ZONE,\n    prompt TEXT NOT NULL,\n    thumbnail_url TEXT,\n    code TEXT,\n    tag TEXT\n);\n```","height":320,"width":1060,"color":4},"id":"6f9e7dc6-1287-4235-8631-198d729f367f","name":"Sticky Note12","type":"n8n-nodes-base.stickyNote","position":[2440,840],"typeVersion":1},{"parameters":{"content":"## Warning\n** Don't forgot the create top_trends table","height":120,"width":160,"color":3},"id":"b19951bb-6346-44a7-a4c8-1bd0806c6019","name":"Sticky Note13","type":"n8n-nodes-base.stickyNote","position":[2900,1060],"typeVersion":1},{"parameters":{"content":"\n## Automated Instagram Content Creation from Trending Posts\n\nThis workflow automates the process of discovering and recreating trending content on Instagram:\n\n1. Content Discovery:\n   - Scrapes top trending posts from specific hashtags (#blender3d, #isometric)\n   - Filters for image-only content (excludes videos)\n   - Checks database to avoid duplicate content\n\n2. AI-Powered Content Generation:\n   - Analyzes trending images using GPT-4 Vision\n   - Generates detailed descriptions of visual elements\n   - Creates engaging Instagram captions with relevant hashtags\n   - Uses Flux AI to generate similar but unique images\n\n3. Publishing & Monitoring:\n   - Automatically posts content to Instagram Business Account\n   - Monitors post status and publishing process\n   - Sends status updates via Telegram\n\nPerfect for content creators and businesses looking to maintain an active Instagram presence with AI-generated content inspired by current trends. The workflow runs on schedule and handles everything from content discovery to publication automatically.\n\nNote: Requires Instagram Business Account, Telegram Bot, OpenAI, and Replicate API credentials.","height":840,"width":620},"id":"3de6b8e5-c5e0-4999-871a-c349cb9b3ac0","name":"Sticky Note14","type":"n8n-nodes-base.stickyNote","position":[380,240],"typeVersion":1},{"parameters":{"content":"##Warning\n** Dont forgot the subscribe [Instagram Scraper Api](https://rapidapi.com/social-api1-instagram/api/instagram-scraper-api2/playground/apiendpoint_a45552b2-9850-4da9-b5cb-bbdd3ac2199d)","height":120,"width":180,"color":7},"id":"dfd0d182-177c-4336-8950-4792ea739123","name":"Sticky Note15","type":"n8n-nodes-base.stickyNote","position":[1440,1660],"typeVersion":1},{"parameters":{"content":"## Warning\n** You can check the  [rate limit](https://rapidapi.com/social-api1-instagram/api/instagram-scraper-api2) of the Instagram Scraper Api on Rapid Api\n** Free version is monthly 500 request\n","height":180,"width":180},"id":"03330941-3c6e-4152-8c51-f1d53f4424bc","name":"Sticky Note16","type":"n8n-nodes-base.stickyNote","position":[1440,1820],"typeVersion":1}],"connections":{"Telegram":{"main":[[]]},"Loop Over Items":{"main":[[],[{"node":"Check Data on Database Is Exist","type":"main","index":0}]]},"Telegram Params":{"main":[[{"node":"Rapid Api params","type":"main","index":0}]]},"If Data is Exist":{"main":[[{"node":"Loop Over Items","type":"main","index":0}],[{"node":"insert data on db","type":"main","index":0}]]},"Instagram params":{"main":[[{"node":"Telegram Params","type":"main","index":0}]]},"Rapid Api params":{"main":[[{"node":"get top trends on instagram #isometric","type":"main","index":0},{"node":"get  top trends on instagram #blender3d","type":"main","index":0}]]},"Replicate params":{"main":[[{"node":"Instagram params","type":"main","index":0}]]},"Schedule Trigger1":{"main":[[{"node":"Replicate params","type":"main","index":0}]]},"insert data on db":{"main":[[{"node":"Analyze Image and give the content","type":"main","index":0}]]},"Check status of post ":{"main":[[{"node":"If media status is finished1","type":"main","index":0}]]},"Generate image on flux":{"main":[[{"node":"Prepare data on Instagram","type":"main","index":0}]]},"merge the array content":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"filter the image content":{"main":[[{"node":"merge the array content","type":"main","index":1}]]},"Prepare data on Instagram":{"main":[[{"node":"Check Status Of Media Before Uploaded","type":"main","index":0}]]},"Publish Media on Instagram":{"main":[[{"node":"Check status of post ","type":"main","index":0}]]},"filter the image content-2":{"main":[[{"node":"merge the array content","type":"main","index":0}]]},"If media status is finished":{"main":[[{"node":"Publish Media on Instagram","type":"main","index":0}],[{"node":"Telegram","type":"main","index":0}]]},"If media status is finished1":{"main":[[{"node":"Telegram1","type":"main","index":0}],[{"node":"Telegram2","type":"main","index":0}]]},"Check Data on Database Is Exist":{"main":[[{"node":"If Data is Exist","type":"main","index":0}],[{"node":"send error message to telegram","type":"main","index":0}]]},"Analyze Image and give the content":{"main":[[{"node":"Analyze Content And Generate Instagram Caption","type":"main","index":0}]]},"Check Status Of Media Before Uploaded":{"main":[[{"node":"If media status is finished","type":"main","index":0}]]},"get top trends on instagram #isometric":{"main":[[{"node":"filter the image content","type":"main","index":0}]]},"get  top trends on instagram #blender3d":{"main":[[{"node":"filter the image content-2","type":"main","index":0}]]},"Analyze Content And Generate Instagram Caption":{"main":[[{"node":"Generate image on flux","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateId":"2803"},"pinData":{},"versionId":"5f8dba2c-e327-4045-aa54-74416f91eaca","triggerCount":0,"tags":[],"shared":[{"createdAt":"2025-06-02T13:19:58.333Z","updatedAt":"2025-06-02T13:19:58.333Z","role":"workflow:owner","workflowId":"ngrZ07cwWp9BQORt","projectId":"UuIRn3TQYG7gFAJh","project":{"createdAt":"2025-06-02T06:58:10.171Z","updatedAt":"2025-06-02T11:56:13.936Z","id":"UuIRn3TQYG7gFAJh","name":"Kshitiz Gupta <kshitiz305@live.com>","type":"personal","icon":null,"description":null}}]},{"createdAt":"2025-02-11T23:18:18.342Z","updatedAt":"2025-02-22T13:43:40.240Z","id":"MQlopjRwFKwKwjjw","name":"Hacker News to Video Content","active":false,"isArchived":false,"nodes":[{"parameters":{},"id":"c777c41b-842d-4504-a1a0-ccbb034a0fdd","name":"When clicking ‘Test workflow’","type":"n8n-nodes-base.manualTrigger","position":[680,580],"typeVersion":1},{"parameters":{"resource":"all","additionalFields":{}},"id":"74fafd7c-55a4-46ec-b4a8-33d46f2b5b54","name":"Hacker News","type":"n8n-nodes-base.hackerNews","position":[980,580],"typeVersion":1},{"parameters":{"options":{}},"id":"9cd87fd2-6a38-463a-a22e-e0c34910818f","name":"Loop Over Items","type":"n8n-nodes-base.splitInBatches","position":[1440,580],"typeVersion":3},{"parameters":{"options":{}},"id":"611b24cd-558b-4025-a0a8-ea355ba61988","name":"OpenAI Chat Model3","type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","position":[1720,860],"typeVersion":1,"credentials":{"openAiApi":{"id":"AEpCEAMnEBzJkgg4","name":"OpenAi account"}}},{"parameters":{"toolDescription":"grab the article for the ai agent to use","url":"={{ $json.url }}"},"id":"f814682c-cf6f-49a8-8ea0-48fbc64a3ebe","name":"HTTP Request1","type":"@n8n/n8n-nodes-langchain.toolHttpRequest","position":[1900,860],"typeVersion":1.1},{"parameters":{"schemaType":"manual","inputSchema":"{\n\t\"type\": \"object\",\n\t\"properties\": {\n\t\t\"summary\": {\n\t\t\t\"type\": \"string\"\n\t\t},\n\t\t\"related\": {\n\t\t\t\"type\": \"string\"\n\t\t},\n        \"image urls\": {\n\t\t\t\"type\": \"string\"\n        }\n\t}\n}"},"id":"2a4bcf69-23f0-440d-a3b0-c8261e153c62","name":"Structured Output Parser","type":"@n8n/n8n-nodes-langchain.outputParserStructured","position":[2080,860],"typeVersion":1.2},{"parameters":{"operation":"upload","bucketName":"=","additionalFields":{"grantRead":true,"parentFolderKey":"="}},"id":"83c3b8f0-8d67-48a2-a5ce-b777ea1d7b32","name":"Upload to Minio","type":"n8n-nodes-base.s3","position":[5240,1360],"typeVersion":1},{"parameters":{"assignments":{"assignments":[{"id":"ec8013d5-84b5-43c8-abcb-6986ef15939d","name":"property_name","type":"string","value":"={{ $json.message.content['Article Title'] }}"},{"id":"4d91c4fc-12a2-4fe2-a58e-02284314e1de","name":"property_text","type":"string","value":"={{ $json.message.content['Article Blurb'] }}"},{"id":"cad2b795-8b71-415f-a100-700d9ec62bbd","name":"property_image_url","type":"string","value":"={{ $('If Topic').item.json.output['image urls'] }}"}]},"options":{}},"id":"05b972ff-ccab-415b-8787-aafabb3b7292","name":"News1","type":"n8n-nodes-base.set","position":[3400,600],"typeVersion":3.4},{"parameters":{"method":"POST","url":"https://cloud.leonardo.ai/api/rest/v1/prompt/improve","authentication":"genericCredentialType","genericAuthType":"httpCustomAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"accept","value":"application/json"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"prompt\": \"Illustration of a developer using GitHub Copilot for coding.\"\n}","options":{"response":{"response":{"fullResponse":true}}}},"id":"d175d366-e672-4452-b78e-a06336ef242b","name":"Leo - Improve Prompt","type":"n8n-nodes-base.httpRequest","position":[3940,380],"typeVersion":4.2},{"parameters":{"url":"=https://cloud.leonardo.ai/api/rest/v1/generations/{{ $json.body.sdGenerationJob.generationId }}","authentication":"genericCredentialType","genericAuthType":"httpCustomAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"content-type","value":"application/json"}]},"options":{"response":{"response":{"fullResponse":true}}}},"id":"d8da7879-1a67-4da1-86db-f70e50b4e9da","name":"Leo - Get imageId","type":"n8n-nodes-base.httpRequest","position":[4540,380],"typeVersion":4.2},{"parameters":{"method":"POST","url":"https://api.dev.runwayml.com/v1/image_to_video","authentication":"genericCredentialType","genericAuthType":"httpCustomAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Runway-Version","value":"2024-11-06"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"promptImage","value":"={{ $json.body.generations_by_pk.generated_images[0].url }}"},{"name":"promptText","value":"string"},{"name":"model","value":"gen3a_turbo"}]},"options":{}},"id":"faf80246-3b1a-49c6-a277-0152428e46e1","name":"Runway - Create Video","type":"n8n-nodes-base.httpRequest","position":[3740,580],"typeVersion":4.2},{"parameters":{"url":"=https://api.dev.runwayml.com/v1/tasks/{{ $json.id }}","authentication":"genericCredentialType","genericAuthType":"httpCustomAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Runway-Version","value":"2024-11-06"}]},"options":{}},"id":"e91c1f01-7870-4063-9557-24a6ba1d3db3","name":"Runway - Get Video","type":"n8n-nodes-base.httpRequest","position":[4140,580],"typeVersion":4.2},{"parameters":{"amount":3,"unit":"minutes"},"id":"41ee2665-e1aa-4d48-ade6-e37af568f211","name":"Wait2","type":"n8n-nodes-base.wait","position":[3940,580],"webhookId":"ddca5833-a40b-404a-9140-686cd4fa26cb","typeVersion":1.1},{"parameters":{"content":"# Choose your data source \n## This can be swapped for any other data source of your choosing.","height":951,"width":341,"color":5},"id":"091e9e07-89ba-4fe3-9fc5-278fc333dbff","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","position":[840,240],"typeVersion":1},{"parameters":{"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"56219de5-244d-4b7f-a511-f3061572cf93","operator":{"name":"filter.operator.equals","type":"string","operation":"equals"},"leftValue":"={{ $json.output.related }}","rightValue":"yes"}]},"options":{}},"id":"9660a593-9966-4ebe-bfd7-f884dc185d56","name":"If Topic","type":"n8n-nodes-base.if","position":[2100,600],"typeVersion":2.2},{"parameters":{"url":"={{ $('Article Analysis').first().json.output['image urls'] }}","options":{"response":{"response":{"fullResponse":true}}}},"id":"e47140ac-20cc-417b-a6cd-30f780dc8289","name":"Get Image","type":"n8n-nodes-base.httpRequest","position":[2720,600],"typeVersion":4.2},{"parameters":{"assignments":{"assignments":[{"id":"56c8f20d-d9d9-4be7-ac2a-38df6ffdd722","name":"model","type":"string","value":"6b645e3a-d64f-4341-a6d8-7a3690fbf042"}]},"includeOtherFields":true,"options":{}},"id":"26f80f71-2c3a-46fe-a960-21cdbc18ce34","name":"Prompt Settings1","type":"n8n-nodes-base.set","position":[3740,380],"typeVersion":3.4},{"parameters":{"method":"POST","url":"https://cloud.leonardo.ai/api/rest/v1/generations","authentication":"genericCredentialType","genericAuthType":"httpCustomAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"accept","value":"application/json"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"alchemy\": true,\n  \"width\": 1024,\n  \"height\": 768,\n  \"modelId\": \"6b645e3a-d64f-4341-a6d8-7a3690fbf042\",\n  \"num_images\": 1,\n  \"presetStyle\": \"MONOCHROME\",\n  \"prompt\": \"{{ $json.body.promptGeneration.prompt }}; Use the rule of thirds, leading lines, & balance. DO NOT INCLUDE ANY WORDS OR LABELS.\",\n  \"guidance_scale\": 7,\n  \"highResolution\": true,\n  \"promptMagic\": false,\n  \"promptMagicStrength\": 0.5,\n  \"promptMagicVersion\": \"v3\",\n  \"public\": false,\n  \"ultra\": false,\n  \"photoReal\": false,\n  \"negative_prompt\": \"\"\n} ","options":{"response":{"response":{"fullResponse":true}}}},"id":"ce697f6f-f8fc-4ba7-b776-17bbc2e870b7","name":"Leo - Generate Image","type":"n8n-nodes-base.httpRequest","position":[4140,380],"typeVersion":4.2},{"parameters":{"amount":30},"id":"e2067fe5-3fae-4f97-97c0-879967efd9b8","name":"Wait1","type":"n8n-nodes-base.wait","position":[4340,380],"webhookId":"256c3814-6a52-4eb1-969a-30f9f3b8e04e","typeVersion":1.1},{"parameters":{"maxItems":50,"keep":"lastItems"},"id":"f0ba57a5-1d27-4c75-a422-4bc0e2cead9d","name":"Limit","type":"n8n-nodes-base.limit","position":[1240,580],"typeVersion":1},{"parameters":{"unit":"minutes"},"id":"ab346129-c3d5-4f51-af5e-5d63cd154981","name":"Wait3","type":"n8n-nodes-base.wait","position":[4300,1300],"webhookId":"6e4a0b8d-6c31-4a98-8ec3-2509aa2087e8","typeVersion":1.1,"disabled":true},{"parameters":{"promptType":"define","text":"=Can you tell me if the article at {{ $json.url }} is related to automation or ai? \n\nthen, create a 250 word summary of the article\n\nAlso, list any image url's related to the article content from the url. Limit to 1 image url.","hasOutputParser":true,"options":{"systemMessage":"You are a helpful assistant in summarizing and identifying articles related to automation and ai. \nOutput the results as:\nsummary: \nrelated: yes or no\nimage urls: "}},"id":"872c35a3-bdd5-4eec-9bac-0959f3ff78e7","name":"Article Analysis","type":"@n8n/n8n-nodes-langchain.agent","position":[1740,580],"typeVersion":1.7,"onError":"continueErrorOutput"},{"parameters":{},"id":"31c3a90e-10ee-4217-9b08-ff57bf17ea10","name":"Dropbox","type":"n8n-nodes-base.dropbox","position":[4640,1360],"typeVersion":1},{"parameters":{"authentication":"serviceAccount","operation":"update","fileId":{"__rl":true,"mode":"list","value":""},"options":{}},"id":"22ccd0a0-f7f6-40ca-bd09-40ed4a7fcde1","name":"Google Drive","type":"n8n-nodes-base.googleDrive","position":[4840,1360],"typeVersion":3,"credentials":{"googleApi":{"id":"zcTgnpZoc5S9Y3pb","name":"Google Service Account account"}}},{"parameters":{},"id":"ea75931d-c1ee-4139-9bdc-7901056ba016","name":"Microsoft OneDrive","type":"n8n-nodes-base.microsoftOneDrive","position":[5040,1360],"typeVersion":1},{"parameters":{"resource":"video","operation":"upload","options":{}},"id":"38888521-3087-4e0a-81d6-cf4b9a5dd3dd","name":"YouTube","type":"n8n-nodes-base.youTube","position":[4640,1780],"typeVersion":1},{"parameters":{"additionalFields":{}},"id":"55f3decc-f952-4d2a-804d-2aec44fb2755","name":"X","type":"n8n-nodes-base.twitter","position":[4840,1780],"typeVersion":2},{"parameters":{"options":{}},"id":"54c8b762-444d-4790-97a9-a2f84518492f","name":"Instagram","type":"n8n-nodes-base.httpRequest","position":[5240,1780],"typeVersion":4.2},{"parameters":{"additionalFields":{}},"id":"90040f15-95c0-4ebb-818f-dde508eb0689","name":"LinkedIn","type":"n8n-nodes-base.linkedIn","position":[5040,1780],"typeVersion":1},{"parameters":{"method":"POST","url":"https://cloud.leonardo.ai/api/rest/v1/prompt/improve","authentication":"genericCredentialType","genericAuthType":"httpCustomAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"accept","value":"application/json"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"prompt\": \"{{ $('Article Prep').item.json.message.content['Image Prompt 2'] }}\"\n}","options":{"response":{"response":{"fullResponse":true}}}},"id":"691eb779-5fae-4f65-89eb-b1b8e5488809","name":"Leo - Improve Prompt2","type":"n8n-nodes-base.httpRequest","position":[3940,780],"typeVersion":4.2},{"parameters":{"amount":3,"unit":"minutes"},"id":"076a745a-055b-459c-8af9-fa7b6740dc6f","name":"Wait4","type":"n8n-nodes-base.wait","position":[3940,980],"webhookId":"89b31515-b403-4644-a2c1-970e5e774008","typeVersion":1.1},{"parameters":{"amount":30},"id":"adc2c993-3f89-40df-96fc-eb3ff5eafb1c","name":"Wait6","type":"n8n-nodes-base.wait","position":[4340,780],"webhookId":"2efb873f-bcbd-41d9-99da-b2b57ef5ad93","typeVersion":1.1},{"parameters":{"method":"POST","url":"https://cloud.leonardo.ai/api/rest/v1/generations","authentication":"genericCredentialType","genericAuthType":"httpCustomAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"accept","value":"application/json"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"alchemy\": true,\n  \"width\": 1024,\n  \"height\": 768,\n  \"modelId\": \"6b645e3a-d64f-4341-a6d8-7a3690fbf042\",\n  \"num_images\": 1,\n  \"presetStyle\": \"MONOCHROME\",\n  \"prompt\": \"{{ $json.body.promptGeneration.prompt }}; Use the rule of thirds, leading lines, & balance. DO NOT INCLUDE ANY WORDS OR LABELS.\",\n  \"guidance_scale\": 7,\n  \"highResolution\": true,\n  \"promptMagic\": false,\n  \"promptMagicStrength\": 0.5,\n  \"promptMagicVersion\": \"v3\",\n  \"public\": false,\n  \"ultra\": false,\n  \"photoReal\": false,\n  \"negative_prompt\": \"\"\n} ","options":{"response":{"response":{"fullResponse":true}}}},"id":"156f5735-bc20-46a9-871c-143b0772ca45","name":"Leo - Generate Image2","type":"n8n-nodes-base.httpRequest","position":[4140,780],"typeVersion":4.2},{"parameters":{"url":"=https://cloud.leonardo.ai/api/rest/v1/generations/{{ $json.body.sdGenerationJob.generationId }}","authentication":"genericCredentialType","genericAuthType":"httpCustomAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"content-type","value":"application/json"}]},"options":{"response":{"response":{"fullResponse":true}}}},"id":"4f270fa8-4da2-44f0-927f-3509fd9f8f7d","name":"Leo - Get imageId2","type":"n8n-nodes-base.httpRequest","position":[4540,780],"typeVersion":4.2},{"parameters":{"method":"POST","url":"https://api.dev.runwayml.com/v1/image_to_video","authentication":"genericCredentialType","genericAuthType":"httpCustomAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Runway-Version","value":"2024-11-06"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"promptImage","value":"={{ $json.body.generations_by_pk.generated_images[0].url }}"},{"name":"promptText","value":"string"},{"name":"model","value":"gen3a_turbo"}]},"options":{}},"id":"49c0e7ba-bf9c-4819-b479-61aa099ab9ab","name":"Runway - Create Video2","type":"n8n-nodes-base.httpRequest","position":[3740,980],"typeVersion":4.2},{"parameters":{"url":"=https://api.dev.runwayml.com/v1/tasks/{{ $json.id }}","authentication":"genericCredentialType","genericAuthType":"httpCustomAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Runway-Version","value":"2024-11-06"}]},"options":{}},"id":"d03eb190-5fc0-4b7e-ad65-88ece3ab833d","name":"Runway - Get Video2","type":"n8n-nodes-base.httpRequest","position":[4140,980],"typeVersion":4.2},{"parameters":{"content":"# Upload Assets\nYou can extend this workflow further by uploading the generated assets to your storage option of choice.","height":372,"width":882,"color":6},"id":"0072563d-b87d-47c5-80fd-ed3c051b3287","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","position":[4580,1220],"typeVersion":1},{"parameters":{"content":"# Post to Social Media\nYou can extend this workflow further by posting the generated assets to social media.","height":372,"width":882,"color":6},"id":"a0b2377e-57ea-47e9-83c9-3e58372610e5","name":"Sticky Note2","type":"n8n-nodes-base.stickyNote","position":[4580,1640],"typeVersion":1},{"parameters":{"content":"# Generate Images and Videos","height":943,"width":1114,"color":4},"id":"708fe6a0-4899-462b-9a08-fadea7c7e195","name":"Sticky Note3","type":"n8n-nodes-base.stickyNote","position":[3420,240],"typeVersion":1},{"parameters":{"content":"# Stitch it all together","height":372,"width":1114,"color":5},"id":"5bbb6552-ec3a-42ea-a911-993f67a6c8dc","name":"Sticky Note4","type":"n8n-nodes-base.stickyNote","position":[3420,1220],"typeVersion":1},{"parameters":{"method":"POST","url":"https://api.creatomate.com/v1/renders","authentication":"genericCredentialType","genericAuthType":"httpCustomAuth","sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"max_width\": 480,\n  \"template_id\": \"enterTemplateID\",\n  \"modifications\": {\n    \"Scenes.elements\": [\n      {\n        \"name\": \"Intro Comp\",\n        \"type\": \"composition\",\n        \"track\": 1,\n        \"elements\": [\n          {\n            \"name\": \"Image-1\",\n            \"type\": \"image\",\n            \"source\": \"{{ $('Leo - Get imageId').item.json.body.generations_by_pk.generated_images[0].url }}\"\n          },\n          {\n            \"name\": \"Subtitles-1\",\n            \"type\": \"text\",\n            \"transcript_source\": \"Voiceover-1\",\n            \"width\": \"86.66%\",\n            \"height\": \"37.71%\",\n            \"x_alignment\": \"50%\",\n            \"y_alignment\": \"50%\",\n            \"fill_color\": \"#ffffff\",\n            \"stroke_color\": \"#333333\",\n            \"stroke_width\": \"1.05 vmin\",\n            \"font_family\": \"Inter\",\n            \"font_weight\": \"700\",\n            \"font_size\": \"8 vmin\",\n            \"background_color\": \"rgba(255,255,255,0.2)\",\n            \"background_x_padding\": \"26%\",\n            \"background_y_padding\": \"7%\",\n            \"background_border_radius\": \"28%\",\n            \"transcript_effect\": \"highlight\",\n            \"transcript_color\": \"#ff5900\"\n          },\n          {\n            \"name\": \"Voiceover-1\",\n            \"type\": \"audio\",\n            \"source\": \"{{ $('News1').item.json.property_name }}\",\n            \"provider\": \"openai model=tts-1 voice=onyx\"\n          }\n        ]\n      },\n      {\n        \"name\": \"Auto Scene Comp\",\n        \"type\": \"composition\",\n        \"track\": 1,\n        \"elements\": [\n          {\n            \"name\": \"Video-2\",\n            \"type\": \"video\",\n            \"source\": \"{{ $('Runway - Get Video').first().json.output[0] }}\",\n            \"loop\": true\n          },\n          {\n            \"name\": \"Subtitles-2\",\n            \"type\": \"text\",\n            \"transcript_source\": \"Voiceover-2\",\n            \"y\": \"78.2173%\",\n            \"width\": \"86.66%\",\n            \"height\": \"37.71%\",\n            \"x_alignment\": \"50%\",\n            \"y_alignment\": \"50%\",\n            \"fill_color\": \"#ffffff\",\n            \"stroke_color\": \"#333333\",\n            \"stroke_width\": \"1.05 vmin\",\n            \"font_family\": \"Inter\",\n            \"font_weight\": \"700\",\n            \"font_size\": \"8 vmin\",\n            \"background_color\": \"rgba(255,255,255,0.2)\",\n            \"background_x_padding\": \"26%\",\n            \"background_y_padding\": \"7%\",\n            \"background_border_radius\": \"28%\",\n            \"transcript_effect\": \"highlight\",\n            \"transcript_color\": \"#ff5900\"\n          },\n          {\n            \"name\": \"Voiceover-2\",\n            \"type\": \"audio\",\n            \"source\": \"{{ $('Article Prep').item.json.message.content['Summary Blurb 1'] }}\",\n            \"provider\": \"openai model=tts-1 voice=onyx\"\n          }\n        ]\n      },\n      {\n        \"name\": \"Auto Scene Comp\",\n        \"type\": \"composition\",\n        \"track\": 1,\n        \"elements\": [\n          {\n            \"name\": \"Video-3\",\n            \"type\": \"video\",\n            \"source\": \"{{ $('Runway - Get Video2').first().json.output[0] }}\",\n            \"loop\": true\n          },\n          {\n            \"name\": \"Subtitles-3\",\n            \"type\": \"text\",\n            \"transcript_source\": \"Voiceover-3\",\n            \"y\": \"78.2173%\",\n            \"width\": \"86.66%\",\n            \"height\": \"37.71%\",\n            \"x_alignment\": \"50%\",\n            \"y_alignment\": \"50%\",\n            \"fill_color\": \"#ffffff\",\n            \"stroke_color\": \"#333333\",\n            \"stroke_width\": \"1.05 vmin\",\n            \"font_family\": \"Inter\",\n            \"font_weight\": \"700\",\n            \"font_size\": \"8 vmin\",\n            \"background_color\": \"rgba(255,89,0,0.5)\",\n            \"background_x_padding\": \"26%\",\n            \"background_y_padding\": \"7%\",\n            \"background_border_radius\": \"28%\",\n            \"transcript_effect\": \"highlight\",\n            \"transcript_color\": \"#ff0040\"\n          },\n          {\n            \"name\": \"Voiceover-3\",\n            \"type\": \"audio\",\n            \"source\": \"{{ $('Article Prep').item.json.message.content['Summary Blurb 2'] }}\",\n            \"provider\": \"openai model=tts-1 voice=onyx\"\n          }\n        ]\n      }\n    ]\n  }\n}","options":{"response":{"response":{"fullResponse":true}}}},"id":"25f4cc09-fbff-4c10-b706-30df5840b794","name":"Cre - Generate Video1","type":"n8n-nodes-base.httpRequest","position":[4100,1300],"typeVersion":4.2},{"parameters":{"url":"=https://api.creatomate.com/v1/renders/{{ $json.body.body[0].id }}","authentication":"genericCredentialType","genericAuthType":"httpCustomAuth","options":{"response":{"response":{"fullResponse":true}}}},"id":"7093de7b-a4e3-4363-8038-1002f7b20fbc","name":"Cre - Get Video","type":"n8n-nodes-base.httpRequest","position":[4500,1300],"typeVersion":4.2},{"parameters":{"content":"# Article Analysis - Is it the right topic?","height":951,"width":1033,"color":3},"id":"a57b719f-b299-431e-9c85-fa333e38b6a7","name":"Sticky Note6","type":"n8n-nodes-base.stickyNote","position":[1660,240],"typeVersion":1},{"parameters":{"content":"# Prepare the article for content generation","height":947,"width":630,"color":3},"id":"60b879a0-8b7f-40f1-ae70-ac94e4675b38","name":"Sticky Note7","type":"n8n-nodes-base.stickyNote","position":[2740,240],"typeVersion":1},{"parameters":{"modelId":{"__rl":true,"mode":"list","value":"gpt-4o-mini","cachedResultName":"GPT-4O-MINI"},"messages":{"values":[{"content":"=prepare the following summary for a newsletter where the article will be 1 of several presented in the newsletter:\n\n{{ $('Article Analysis').first().json.output.summary }}\n\nMake sure the Article Blurb lenght is less than 15 words.\n\nThen, create 2 Summary Blurbs, making sure each is less than 15 words.\n\nAlso create 2 image prompts that is less than 15 words long for each Summary Blurb"},{"content":"Output in markdown format\nArticle Title\nArticle Blurb\nSummary Blurb 1\nSummary Blurb 2\nArticle Image\nImage Prompt 1\nImage Prompt 2","role":"system"}]},"jsonOutput":true,"options":{}},"id":"afaf8437-ee52-434b-a267-8dbaff0e1922","name":"Article Prep","type":"@n8n/n8n-nodes-langchain.openAi","position":[3040,600],"typeVersion":1.6,"credentials":{"openAiApi":{"id":"AEpCEAMnEBzJkgg4","name":"OpenAi account"}}},{"parameters":{"content":"# AlexK1919 \n![Alex Kim](https://media.licdn.com/dms/image/v2/D5603AQFOYMkqCPl6Sw/profile-displayphoto-shrink_400_400/profile-displayphoto-shrink_400_400/0/1718309808352?e=1736985600&v=beta&t=pQKm7lQfUU1ytuC2Gq1PRxNY-XmROFWbo-BjzUPxWOs)\n\n#### I’m Alex Kim, an AI-Native Workflow Automation Architect Building Solutions to Optimize your Personal and Professional Life.\n\n### Workflow Overview Video\nhttps://youtu.be/XaKybLDUlLk\n\n### About Me\nhttps://beacons.ai/alexk1919\n\n### Product Used \n[Leonardo.ai](https://leonardo.ai)\n[RunwayML](https://runwayml.com/)\n[Creatomate](https://creatomate.com/)\n","height":946,"width":252,"color":6},"id":"e7c95d56-86e1-4456-a6d3-9c8b9fc3a53c","name":"Sticky Note5","type":"n8n-nodes-base.stickyNote","position":[380,240],"typeVersion":1},{"parameters":{"content":"Don't forget to connect this last node to the loop to process additional items","height":100,"width":180,"color":7},"id":"32e2803e-bf7c-4da4-a4ae-c9b6fa5ae226","name":"Sticky Note8","type":"n8n-nodes-base.stickyNote","position":[4280,1460],"typeVersion":1},{"parameters":{"promptType":"define","text":"=What is this image? \n{{ $json.output['image urls'] }}"},"type":"@n8n/n8n-nodes-langchain.chainLlm","typeVersion":1.5,"position":[2440,460],"id":"9bf8a138-3e11-417f-8dc2-f7ac189720c5","name":"Basic LLM Chain"},{"parameters":{"modelName":"models/learnlm-1.5-pro-experimental","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[2540,680],"id":"4d5b2979-daf1-46f6-954c-9157e382ce97","name":"Google Gemini Chat Model","credentials":{"googlePalmApi":{"id":"lxY1yy9VjJFvamwS","name":"Google Gemini(PaLM) Api Paid"}}}],"connections":{"X":{"main":[[{"node":"LinkedIn","type":"main","index":0}]]},"Limit":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"News1":{"main":[[{"node":"Prompt Settings1","type":"main","index":0}]]},"Wait1":{"main":[[{"node":"Leo - Get imageId","type":"main","index":0}]]},"Wait2":{"main":[[{"node":"Runway - Get Video","type":"main","index":0}]]},"Wait3":{"main":[[{"node":"Cre - Get Video","type":"main","index":0}]]},"Wait4":{"main":[[{"node":"Runway - Get Video2","type":"main","index":0}]]},"Wait6":{"main":[[{"node":"Leo - Get imageId2","type":"main","index":0}]]},"Dropbox":{"main":[[{"node":"Google Drive","type":"main","index":0}]]},"YouTube":{"main":[[{"node":"X","type":"main","index":0}]]},"If Topic":{"main":[[{"node":"Basic LLM Chain","type":"main","index":0}],[{"node":"Loop Over Items","type":"main","index":0}]]},"LinkedIn":{"main":[[{"node":"Instagram","type":"main","index":0}]]},"Get Image":{"main":[[{"node":"Article Prep","type":"main","index":0}]]},"Hacker News":{"main":[[{"node":"Limit","type":"main","index":0}]]},"Article Prep":{"main":[[{"node":"News1","type":"main","index":0}]]},"Google Drive":{"main":[[{"node":"Microsoft OneDrive","type":"main","index":0}]]},"HTTP Request1":{"ai_tool":[[{"node":"Article Analysis","type":"ai_tool","index":0}]]},"Loop Over Items":{"main":[[],[{"node":"Article Analysis","type":"main","index":0}]]},"Article Analysis":{"main":[[{"node":"If Topic","type":"main","index":0}],[{"node":"Loop Over Items","type":"main","index":0}]]},"Prompt Settings1":{"main":[[{"node":"Leo - Improve Prompt","type":"main","index":0}]]},"Leo - Get imageId":{"main":[[{"node":"Runway - Create Video","type":"main","index":0}]]},"Leo - Get imageId2":{"main":[[{"node":"Runway - Create Video2","type":"main","index":0}]]},"Microsoft OneDrive":{"main":[[{"node":"Upload to Minio","type":"main","index":0}]]},"OpenAI Chat Model3":{"ai_languageModel":[[{"node":"Article Analysis","type":"ai_languageModel","index":0}]]},"Runway - Get Video":{"main":[[{"node":"Leo - Improve Prompt2","type":"main","index":0}]]},"Runway - Get Video2":{"main":[[{"node":"Cre - Generate Video1","type":"main","index":0}]]},"Leo - Generate Image":{"main":[[{"node":"Wait1","type":"main","index":0}]]},"Leo - Improve Prompt":{"main":[[{"node":"Leo - Generate Image","type":"main","index":0}]]},"Cre - Generate Video1":{"main":[[{"node":"Wait3","type":"main","index":0}]]},"Leo - Generate Image2":{"main":[[{"node":"Wait6","type":"main","index":0}]]},"Leo - Improve Prompt2":{"main":[[{"node":"Leo - Generate Image2","type":"main","index":0}]]},"Runway - Create Video":{"main":[[{"node":"Wait2","type":"main","index":0}]]},"Runway - Create Video2":{"main":[[{"node":"Wait4","type":"main","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"Article Analysis","type":"ai_outputParser","index":0}]]},"When clicking ‘Test workflow’":{"main":[[{"node":"Hacker News","type":"main","index":0}]]},"Basic LLM Chain":{"main":[[{"node":"Get Image","type":"main","index":0}]]},"Google Gemini Chat Model":{"ai_languageModel":[[{"node":"Basic LLM Chain","type":"ai_languageModel","index":0}]]}},"settings":{},"staticData":null,"meta":{"templateId":"2557"},"pinData":{},"versionId":"7a959832-051d-4b58-95d3-3668b2dc74e1","triggerCount":0,"tags":[],"shared":[{"createdAt":"2025-06-02T13:19:58.333Z","updatedAt":"2025-06-02T13:19:58.333Z","role":"workflow:owner","workflowId":"MQlopjRwFKwKwjjw","projectId":"UuIRn3TQYG7gFAJh","project":{"createdAt":"2025-06-02T06:58:10.171Z","updatedAt":"2025-06-02T11:56:13.936Z","id":"UuIRn3TQYG7gFAJh","name":"Kshitiz Gupta <kshitiz305@live.com>","type":"personal","icon":null,"description":null}}]},{"createdAt":"2025-05-06T07:14:02.503Z","updatedAt":"2025-08-30T08:16:29.387Z","id":"DUJ3QEHlEtozqSqt","name":"Whatsapp Conversation","active":false,"isArchived":false,"nodes":[{"parameters":{"descriptionType":"manual","toolDescription":"this needs to be used only when all the data related to the patient is available along with the doctor they need a appointment from.","operation":"append","documentId":{"__rl":true,"value":"15dOz4nD1iDO26zU5ZYnP_9PqBSBUqEzDTcsI_YQnTX4","mode":"list","cachedResultName":"Appointment Sheet","cachedResultUrl":"https://docs.google.com/spreadsheets/d/15dOz4nD1iDO26zU5ZYnP_9PqBSBUqEzDTcsI_YQnTX4/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Sheet1","cachedResultUrl":"https://docs.google.com/spreadsheets/d/15dOz4nD1iDO26zU5ZYnP_9PqBSBUqEzDTcsI_YQnTX4/edit#gid=0"},"columns":{"mappingMode":"defineBelow","value":{"patient_name":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('patient_name', `This is the name of the patient to be entered after asking.`, 'string') }}","age":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('age', `This is the age of the patient to be entered after asking.`, 'string') }}","gender":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('gender', `keep the format as M for male and F for female.`, 'string') }}","doctor_name":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('doctor_name', `In case the patient opts in for an appointment this needs to be filled.`, 'string') }}","time":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('time', `The time at which the appointment is confirmed`, 'string') }}","patient_number":"={{ $('WhatsApp Trigger').item.json.metadata.display_phone_number }}"},"matchingColumns":["patient_number"],"schema":[{"id":"appointment_id","displayName":"appointment_id","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"patient_number","displayName":"patient_number","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"patient_name","displayName":"patient_name","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"time","displayName":"time","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"age","displayName":"age","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"gender","displayName":"gender","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"doctor_name","displayName":"doctor_name","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"appointment_link","displayName":"appointment_link","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"form_link","displayName":"form_link","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheetsTool","typeVersion":4.5,"position":[3220,1900],"id":"2a882221-046a-42a5-9a17-1cbfc9e7b064","name":"Google Sheets","credentials":{"googleSheetsOAuth2Api":{"id":"n1mJzLfz9loDmBOy","name":"OAuth Account kshitiz305280@gmail.com"}}},{"parameters":{"description":"This will only be used to find the doctors availability. This tool takes input the type of doctor along with the time of appointment and it returns Doctor Name : Name of doctor\nType: type that was the input\nCall Link: Link of the call to b e scheduled\nAvailability Timings: Time available \ndoctor_email: email address used to book calendar invite\nif doctor available else if there is an error it should return that doctor is not available.Time needs to be converted to  ISO i.e. format YYYY-MM-DDTHH:mm:ss.sss","workflowId":{"__rl":true,"value":"M0SkIJsQzuCrQsYK","mode":"list","cachedResultName":"Doctor selection"},"workflowInputs":{"mappingMode":"defineBelow","value":{"query":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('query', `This is the doctor type selected by the user`, 'string') }}","time":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('time', `This is the time that is provided by the user to check for the availablity.This needs to be provided in ISO i.e. format YYYY-MM-DDTHH:mm:ss.sss`, 'string') }}"},"matchingColumns":[],"schema":[{"id":"query","displayName":"query","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string"},{"id":"time","displayName":"time","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string"}],"attemptToConvertTypes":false,"convertFieldsToString":false}},"type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":2.2,"position":[3340,1900],"id":"cc5be163-652f-4fe7-96c2-24fc3989d09b","name":"Doctor name from doctor type"},{"parameters":{"promptType":"define","text":"={{$json.messages[0].text.body }}","options":{"systemMessage":"=You are a helpful CHATBOT FOR MEDICAL ADVICE AND APPOINTMENT SETTING.\nToday is {{$now}}\n\nThe first thing is to provide a disclaimer that this is an “Please note that I am an AI Chatbot and the advice I provide is general and cannot be substituted for a professional medical diagnosis or treatment from a qualified doctor.” The disclaimer should not be given in each prompt.\nI'm aware you're an AI. For our current task/conversation, please refrain from repeatedly identifying yourself as such. Focus on providing general advice to the user and redirecting it to a specialist .\n1. The very first prompt after disclaimer should be selection of the language  - 1.Hindi or 2.English and depending on the selection the model should interact in that language itself.\n\na)After choosing the option, AI should send the message: “By Proceeding you agree to our Terms & Conditions of Swatch Bharat  Operated by MedHero (Check Bio for link). Do you agree? Yes or No”\n\n\nb) After this,create a link using the tool “Create_Payment_Link” that takes in amount (200) as the value and returns a url  that needs to be added in the message to ask permission from the user that “This is a paid service and you will be charged Rs 20 for the AI service Pay on the payment link [url] [ plink]to proceed further. Kindly Confirm type “Done” once you have completed the payment.” \nHere is an example of the returned value by the tool  “Create_Payment_Link” in case of true: {\"status\":\"success\",\n\"url\": {string},\n\"Plink\":{string}\n}.\nThe url starts with “https://rzp.io/rzp”\n\nNote: only create one payment link for a particular amount. If a  payment link exists for 200 don’t create another one.\n\n\nc) Once the user mentions that he has completed the payment type using the “Check_payment_status” tool check the payment status using the “plink” provided by the “Create_Payment_Link” in the above step. Based on the status returned - “success”/“failed” move forward accordingly. If “success” then move to the next step, if “failed” return the message “The payment is still not successful. Kindly Retry with the same link.”\nExample of plink would start with “plink*”\n\n\n2.a)Then you need to ask questions based on the patient's name, age and gender and then proceed with other questions. \nThe name can be a first name or the full name either can work. Don’t mention this to the user both are acceptable \nStore the data in the google sheet in the format of M for male and F for female.\nb)Only if the age of the patient is below 16 and above 85 then you should return :-\"Please meet a doctor physically\"  else you can continue to the next step [Don’t explicitly mention either case ]\nNote: The data needs to be filled in English in the google sheet after the patient opts for a doctor appointment. \n3.a)Then proceed by the questions such as what is the issue they are facing.\nb)After asking for the disease that the patient is suffering from some advice should be given. Advice always needs to be given before doctor appointment recommendation.\n4.a)After a bit of the examination Categorise the issue into three : thIS NEEDS TO BE DONE ON THE YOUR END BASED ON THE RULES GIVEN BELOW.\nThe bot evaluates all responses and classifies the patient's condition:\nCategory\nMild (Can Wait):- \tCriteria (Minor, short-duration symptoms, no risk factors) - Bot Response: “Your condition appears mild. You may wait and monitor, but consulting a doctor is recommended within 48 hours.”\n\nb)Category\nModerate (Needs Consultation Soon):- Criteria(Persistent symptoms, mild complications, known comorbidities) Bot response:- “We recommend speaking with a doctor soon. Please proceed to book a consultation today.”\nSevere (Needs Immediate Attention) - Criteria (High fever, chest pain, severe dehydration, difficulty breathing, etc.) - Bot response:- Your symptoms suggest a serious condition. Please book a consultation immediately. If symptoms worsen, seek emergency help.”\nYou must mention that the doctor consultation is a Paid service and will be charged RS 400 per session.\n\n\n○  Suggest doctor category: General Physician, Dermatologist, Gynecologist, etc. Based on severity:\n● Bot prioritizes appointment slots\n● Sends urgent notifications to doctors (for red flags)\nEg:“Based on your responses, we recommend a consultation with a General Physician.”\nNote: Users can always override and choose a different specialty.\nBOT response on the severity of the condition Three severity levels: \n* \t\t●  Mild — Can Wait  [Green Colour Emoji]\n* \t\t●  Moderate — Needs Consultation Soon  [Orange Colour emoji]\n* \t\t●  Severe — Needs Immediate Attention [Red Colour Emoji]\n* Based on symptoms , you need to recommend a specialty doctor type amongst these: \n    1. General Physician \n    2. Gynaecologist \n    3. Paediatrician \n    4. Dermatologist\n    5. Psychologist\n    6. Orthopaedic\n    7. General Surgery\nIt is the choice of the user to go ahead with the recommendation or choose any amongst the list of Specialist types above. Don’t go outside the scope of these options given. The user cannot ask for a doctor name, only based on the specialist type the doctor appointment needs to be booked. Only provide the list of specialists that is available . The user need to be prompted “Select Yes to go with the recommendation else select the number”\n\n5. Ask for the time the user is free. Given the time slots between 9AM to 5 PM. While providing the time to the “Doctor name from doctor type” tool, time needs to be provided in ISO i.e. format YYYY-MM-DDTHH:mm:ss.sss. Don’t ask for the user to provide this format, it should be converted by you.\n6.a) After this,create a link using the tool “Create_Payment_Link” that takes in amount (400) as the value and returns a url  that needs to be added in the message to ask permission from the user that “This is a paid service and you will be charged Rs 400 for the AI service Pay on the payment link [url] [ plink]to proceed further. Kindly Confirm type “Done” once you have completed the payment.” \nHere is an example of the returned value by the tool  “Create_Payment_Link” in case of true: {\"status\":\"success\",\n\"url\": {string},\n\"Plink\":{string}\n}.\nThe url starts with “https://rzp.io/rzp”\n\nNote: only create one payment link for a particular amount. If a  payment link exists for 200 don’t create another one.\n\n\nb) Once the user mentions that he has completed the payment type using the “Check_payment_status” tool check the payment status using the “plink” provided by the “Create_Payment_Link” in the above step. Based on the status returned - “success”/“failed” move forward accordingly. If “success” then move to the next step, if “failed” return the message “The payment is still not successful. Kindly Retry with the same link.”\nExample of plink would start with “plink*”\n\n7.Based on the doctor type the available doctor needs to be fetched using the “Doctor name from doctor type” tool\nThe “Doctor name from doctor type” tool return the doctor_email field that needs to be used for creating calendar invite\n8.After you have got the doctor name and confirmed it from the user and  make an entry in the google sheets adding the name, age , gender , the doctor name and the time that is fetched from the “Doctor name from doctor type” tool as confirmed by the user.\n\n9. Using doctor_email as Calendar ID , add an invite with google calendar By ID would \"Calendar\" is the `doctor_email` that was fetched from the “Doctor name from doctor type” tool. The appointment needs to be  confirmed by the user with the time confirmed.\nNote:Don’t create random emails for doctor email, use the one that is fetched from the “Doctor name from doctor type” tool. If “The resource you are requesting could not be found” is returned by the tool recheck for the email id that is being provided in the Calendar.\nWhile confirming the time Never give a json always return a human understandable text.\nAfter the appointment is confirmed. The user should be given a message “Your appointment with doctor name is confirmed for appointment time. The meeting link is: meeting_link.\nThe technology used in the backend should be kept confidential from the users. At all times use the data that has already been provided without the need to reconfirm it."}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.9,"position":[3260,1680],"id":"d90f6d89-7160-4253-afdf-3b334aa6692a","name":"AI Agent","retryOnFail":true},{"parameters":{"modelName":"models/gemini-2.5-flash-preview-04-17","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[2980,1900],"id":"1abad90f-b606-4fe6-817a-51a801953fb5","name":"Google Gemini Chat Model","credentials":{"googlePalmApi":{"id":"Rr9Mu6c4pts6QuaI","name":"Google Gemini(PaLM) Api account 2"}}},{"parameters":{"descriptionType":"manual","toolDescription":"=It is\b this is the tool used to calendar event taking in time and the Calender is value of doctor_email based on which it is decided which calender to be modified.The \"Calendar\" is the \"doctor_email\" is the same as it was returned by the \"Doctor name from doctor type\" tool. The conference data creates a google meets link.\n","calendar":{"__rl":true,"value":"={{ $fromAI('Calendar', ``, 'string') }}","mode":"id"},"start":"={{ $fromAI('Start', ``, 'string') }}","end":"={{ $fromAI('End', `All calls should be 30 minute calls `, 'string') }}","additionalFields":{"attendees":["={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('attendees0_Attendees', ``, 'string') }}"],"conferenceDataUi":{"conferenceDataValues":{}},"description":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Description', `This is a doctors call to discuss the problems`, 'string') }}","sendUpdates":"all"}},"type":"n8n-nodes-base.googleCalendarTool","typeVersion":1.3,"position":[3460,1900],"id":"911b56ed-2456-476a-b0ae-1ed7e780e9e4","name":"Google Calendar","notesInFlow":false,"credentials":{"googleCalendarOAuth2Api":{"id":"uD8AIc77E2dJeCtx","name":"Google Calendar account"}}},{"parameters":{"updates":["messages"],"options":{}},"type":"n8n-nodes-base.whatsAppTrigger","typeVersion":1,"position":[2540,1580],"id":"6032853e-f742-49b3-9c37-91215b3bbc3d","name":"WhatsApp Trigger","webhookId":"c628aa85-a8d0-4636-a4a1-3fe7a43c42db","credentials":{"whatsAppTriggerApi":{"id":"UfASsGand3ZSI5HF","name":"client_whatsapp_credentials"}}},{"parameters":{"operation":"send","phoneNumberId":"572325512642102","recipientPhoneNumber":"={{ $('WhatsApp Trigger').item.json.contacts[0].wa_id }}","textBody":"={{ $json.output }}","additionalFields":{}},"type":"n8n-nodes-base.whatsApp","typeVersion":1,"position":[3900,1680],"id":"98677df3-045d-4586-9eda-7430ff9566ff","name":"WhatsApp Business Cloud","webhookId":"2c15a514-1948-4fa1-914f-1b924755bd29","credentials":{"whatsAppApi":{"id":"JAr6Zj4Rhqnze7CL","name":"WhatsApp Client "}}},{"parameters":{"sessionIdType":"customKey","sessionKey":"={{ $('WhatsApp Trigger').item.json.contacts[0].wa_id + \"-\" + $now.toFormat('ddMMyyyy') }}","databaseName":"n8n","contextWindowLength":60},"type":"@n8n/n8n-nodes-langchain.memoryMongoDbChat","typeVersion":1,"position":[3100,1900],"id":"8c19afb0-f11d-41f8-8863-b447f6f48692","name":"MongoDB Chat Memory","credentials":{"mongoDb":{"id":"OHt6EMCkQvYJfIIU","name":"MongoDB account"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.chatTrigger","typeVersion":1.1,"position":[2760,1780],"id":"8285ba76-936d-40d4-8ad5-c48046062231","name":"When chat message received","webhookId":"29a7f255-f169-4559-b006-27d6139ace1a","disabled":true},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"34db2c23-e7a9-4960-9ad6-021cee81b6ab","leftValue":"={{ $json.messages }}","rightValue":"","operator":{"type":"array","operation":"exists","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[2760,1580],"id":"2a614136-c877-4cc3-82b3-1722be00b9fe","name":"If"},{"parameters":{"sessionIdType":"customKey","sessionKey":"={{ $('WhatsApp Trigger').item.json.contacts[0].wa_id }}","contextWindowLength":30},"type":"@n8n/n8n-nodes-langchain.memoryBufferWindow","typeVersion":1.3,"position":[2540,2040],"id":"78d0e852-2e20-47f5-9d20-d5d77c47f246","name":"Simple Memory"},{"parameters":{"description":"Call this tool to create an payment link that takes a json as inout with key as \"value\" and json value as a numerical value that is equal to or more than 100. The tool returns a json with keys \"status\" being \"sucess\" or \"failed\" and a \"url\" and another key \"plink\" that symbolises the paymentlink that is used to fetch the transaction status.","workflowId":{"__rl":true,"value":"Jm4jj4J39lBdwyhv","mode":"list","cachedResultName":"Create_Payment_Link"},"workflowInputs":{"mappingMode":"defineBelow","value":{"value":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('value', `a number value that is greater than or equal to 100`, 'number') }}"},"matchingColumns":["value"],"schema":[{"id":"value","displayName":"value","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"number","removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false}},"type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":2.2,"position":[3580,1900],"id":"52889915-ef58-4ca3-bf0f-41d738d31217","name":"Create payment link"},{"parameters":{"description":"Uses the plink from the tool \"Create_Payment_Link\" tool and check the status of the payment. It accepts a string plink as arguement, generated from the tool \"Create_Payment_Link\" and returns a json having the status.","workflowId":{"__rl":true,"value":"4P75zLRFqQuYYx0S","mode":"list","cachedResultName":"Check_payment_status"},"workflowInputs":{"mappingMode":"defineBelow","value":{"plink":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('plink', `a string generated from the tool \"Create_Payment_Link\"`, 'string') }}"},"matchingColumns":["plink"],"schema":[{"id":"plink","displayName":"plink","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string"}],"attemptToConvertTypes":false,"convertFieldsToString":false}},"type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":2.2,"position":[3700,1900],"id":"f7ca3805-5c71-428e-a2a2-b9308a30ab2d","name":"Check Payment Status"}],"connections":{"Google Sheets":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Doctor name from doctor type":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Google Gemini Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"Google Calendar":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"WhatsApp Trigger":{"main":[[{"node":"If","type":"main","index":0}]]},"AI Agent":{"main":[[{"node":"WhatsApp Business Cloud","type":"main","index":0}]]},"MongoDB Chat Memory":{"ai_memory":[[{"node":"AI Agent","type":"ai_memory","index":0}]]},"When chat message received":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"If":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"Simple Memory":{"ai_memory":[[]]},"Create payment link":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Check Payment Status":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]}},"settings":{"executionOrder":"v1","timezone":"Asia/Kolkata","callerPolicy":"workflowsFromSameOwner"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"WhatsApp Trigger":[{"json":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556439025","phone_number_id":"572325512642102"},"contacts":[{"profile":{"name":"KSHITIZ"},"wa_id":"918882961517"}],"messages":[{"from":"918882961517","id":"wamid.HBgMOTE4ODgyOTYxNTE3FQIAEhgWM0VCMEIwRjA1MkM0OTMyQ0RCN0JFQgA=","timestamp":"1748714739","text":{"body":"done"},"type":"text"}],"field":"messages"}}]},"versionId":"ad991892-d66f-43e5-aed9-b976d48f831b","triggerCount":1,"tags":[],"shared":[{"createdAt":"2025-06-02T13:19:58.333Z","updatedAt":"2025-06-02T13:19:58.333Z","role":"workflow:owner","workflowId":"DUJ3QEHlEtozqSqt","projectId":"UuIRn3TQYG7gFAJh","project":{"createdAt":"2025-06-02T06:58:10.171Z","updatedAt":"2025-06-02T11:56:13.936Z","id":"UuIRn3TQYG7gFAJh","name":"Kshitiz Gupta <kshitiz305@live.com>","type":"personal","icon":null,"description":null}}]},{"createdAt":"2025-06-01T13:20:30.349Z","updatedAt":"2025-06-01T13:20:30.349Z","id":"k7n2pYxg0ypUZYK4","name":"My workflow 2","active":false,"isArchived":false,"nodes":[{"parameters":{},"id":"73d3788b-7b9a-4928-ae03-8a2af5fc0482","name":"On clicking 'execute'","type":"n8n-nodes-base.manualTrigger","position":[240,80],"typeVersion":1},{"parameters":{"content":"## Subworkflow","height":731.7039821513649,"width":1910.7813046051347,"color":6},"id":"dfa5d8e0-12a7-440a-b7c0-4c4da88fa6b4","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","position":[-240,460],"typeVersion":1},{"parameters":{},"id":"0ec154ce-60ea-4dfd-b05e-619382623403","name":"Execute Workflow Trigger","type":"n8n-nodes-base.executeWorkflowTrigger","position":[-180,840],"typeVersion":1},{"parameters":{"filters":{},"requestOptions":{}},"id":"6eae6740-2781-4484-867d-aa28d793d1de","name":"n8n","type":"n8n-nodes-base.n8n","position":[640,180],"typeVersion":1,"credentials":{"n8nApi":{"id":"vgR3NqYKzoqli1vo","name":"n8n account"}}},{"parameters":{"assignments":{"assignments":[{"id":"8d513345-6484-431f-afb7-7cf045c90f4f","name":"Done","type":"boolean","value":true}]},"options":{}},"id":"080d4a4e-78c3-4b07-bd05-bfb89cef2a44","name":"Return","type":"n8n-nodes-base.set","position":[1480,660],"typeVersion":3.3},{"parameters":{"url":"={{ $json.download_url }}","options":{}},"id":"db0fb0a6-506a-4fea-97b1-de3f8aefe916","name":"Get File","type":"n8n-nodes-base.httpRequest","position":[440,540],"typeVersion":4.2},{"parameters":{"conditions":{"options":{"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"45ce825e-9fa6-430c-8931-9aaf22c42585","operator":{"type":"string","operation":"empty","singleValue":true},"leftValue":"={{ $json.content }}","rightValue":""},{"id":"9619a55f-7fb1-4f24-b1a7-7aeb82365806","operator":{"type":"string","operation":"notExists","singleValue":true},"leftValue":"={{ $json.error }}","rightValue":""}]},"options":{}},"id":"f951b3b6-1e1d-4a80-909c-12c1405012ee","name":"If file too large","type":"n8n-nodes-base.if","position":[200,560],"typeVersion":2},{"parameters":{},"id":"b69fcc61-a011-4903-98e3-47ae919ea744","name":"Merge Items","type":"n8n-nodes-base.merge","position":[200,820],"typeVersion":2},{"parameters":{"jsCode":"const orderJsonKeys = (jsonObj) => {\n  const ordered = {};\n  Object.keys(jsonObj).sort().forEach(key => {\n    ordered[key] = jsonObj[key];\n  });\n  return ordered;\n}\n\n// Check if file returned with content\nif (Object.keys($input.all()[0].json).includes(\"content\")) {\n  // Decode base64 content and parse JSON\n  const origWorkflow = JSON.parse(Buffer.from($input.all()[0].json.content, 'base64').toString());\n  const n8nWorkflow = $input.all()[1].json;\n  \n  // Order JSON objects\n  const orderedOriginal = orderJsonKeys(origWorkflow);\n  const orderedActual = orderJsonKeys(n8nWorkflow);\n\n  // Determine difference\n  if (JSON.stringify(orderedOriginal) === JSON.stringify(orderedActual)) {\n    $input.all()[0].json.github_status = \"same\";\n  } else {\n    $input.all()[0].json.github_status = \"different\";\n    $input.all()[0].json.n8n_data_stringy = JSON.stringify(orderedActual, null, 2);\n  }\n  $input.all()[0].json.content_decoded = orderedOriginal;\n// No file returned / new workflow\n} else if (Object.keys($input.all()[0].json).includes(\"data\")) {\n  const origWorkflow = JSON.parse($input.all()[0].json.data);\n  const n8nWorkflow = $input.all()[1].json;\n  \n  // Order JSON objects\n  const orderedOriginal = orderJsonKeys(origWorkflow);\n  const orderedActual = orderJsonKeys(n8nWorkflow);\n\n  // Determine difference\n  if (JSON.stringify(orderedOriginal) === JSON.stringify(orderedActual)) {\n    $input.all()[0].json.github_status = \"same\";\n  } else {\n    $input.all()[0].json.github_status = \"different\";\n    $input.all()[0].json.n8n_data_stringy = JSON.stringify(orderedActual, null, 2);\n  }\n  $input.all()[0].json.content_decoded = orderedOriginal;\n\n} else {\n  // Order JSON object\n  const n8nWorkflow = $input.all()[1].json;\n  const orderedActual = orderJsonKeys(n8nWorkflow);\n  \n  // Proper formatting\n  $input.all()[0].json.github_status = \"new\";\n  $input.all()[0].json.n8n_data_stringy = JSON.stringify(orderedActual, null, 2);\n}\n\n// Return items\nreturn $input.all();\n"},"id":"e9556fa1-dade-4b87-893f-aa8cf4382120","name":"isDiffOrNew","type":"n8n-nodes-base.code","position":[400,820],"typeVersion":1},{"parameters":{"dataType":"string","value1":"={{$json.github_status}}","rules":{"rules":[{"value2":"same"},{"value2":"different","output":1},{"value2":"new","output":2}]}},"id":"244fda82-5c8b-4118-833d-6e9a478016e5","name":"Check Status","type":"n8n-nodes-base.switch","position":[800,820],"typeVersion":1},{"parameters":{},"id":"0f4138ef-763c-4407-91c0-7c027625c756","name":"Same file - Do nothing","type":"n8n-nodes-base.noOp","position":[1020,660],"typeVersion":1},{"parameters":{},"id":"a48e1ee7-7635-43f4-a69f-32a45789b4fe","name":"File is different","type":"n8n-nodes-base.noOp","position":[1020,820],"typeVersion":1},{"parameters":{},"id":"f2e0c991-7eeb-4bb5-8e91-171b046d27ba","name":"File is new","type":"n8n-nodes-base.noOp","position":[1020,1020],"typeVersion":1},{"parameters":{"resource":"file","owner":{"__rl":true,"mode":"","value":"={{ $('Config').first().item.repo_owner }}"},"repository":{"__rl":true,"mode":"","value":"={{ $('Config').first().item.repo_name }}"},"filePath":"={{ $('Config').first().item.repo_path }}{{ $json.subPath }}{{$('Execute Workflow Trigger').first().json.id}}.json","fileContent":"={{$('isDiffOrNew').item.json[\"n8n_data_stringy\"]}}","commitMessage":"={{$('Execute Workflow Trigger').first().json.name}} ({{$json.github_status}})"},"id":"7ee441cc-de45-4820-b2b3-e6edd51a8e6c","name":"Create new file","type":"n8n-nodes-base.github","position":[1240,1020],"typeVersion":1,"webhookId":"fa1aa20b-1717-4701-9dab-51fa839a2553"},{"parameters":{"resource":"file","operation":"edit","owner":{"__rl":true,"mode":"","value":"={{ $('Config').first().item.repo_owner }}"},"repository":{"__rl":true,"mode":"","value":"={{ $('Config').first().item.repo_name }}"},"filePath":"={{ $('Config').first().item.repo_path }}{{ $json.subPath }}{{$('Execute Workflow Trigger').first().json.id}}.json","fileContent":"={{$('isDiffOrNew').item.json[\"n8n_data_stringy\"]}}","commitMessage":"={{$('Execute Workflow Trigger').first().json.name}} ({{$json.github_status}})"},"id":"fe61a305-315e-47e5-8179-c9e1a77dd1ea","name":"Edit existing file","type":"n8n-nodes-base.github","position":[1240,820],"typeVersion":1,"webhookId":"e0e5c8ab-5ee7-4e5d-aa45-3f83576ed528"},{"parameters":{"options":{}},"id":"811156f9-b5f9-4a39-86b1-6e4886d66256","name":"Loop Over Items","type":"n8n-nodes-base.splitInBatches","position":[840,180],"typeVersion":3},{"parameters":{"rule":{"interval":[{"triggerAtHour":1,"triggerAtMinute":33}]}},"id":"6954b8ee-7e5f-42bf-b385-1f51c7e84a40","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","position":[240,280],"typeVersion":1.2},{"parameters":{"assignments":{"assignments":[{"id":"dae43d3b-56e5-4098-b602-862ebf5cd073","name":"subPath","type":"string","value":"={{ $('Execute Workflow Trigger').first().json.createdAt.split('-')[0] }}/{{ $('Execute Workflow Trigger').first().json.createdAt.split('-')[1] }}/"}]},"includeOtherFields":true,"options":{}},"id":"578ed3bc-f8e9-4669-bb75-1d53efc367a0","name":"Create sub path","type":"n8n-nodes-base.set","position":[600,820],"typeVersion":3.3},{"parameters":{"content":"## Backup to GitHub \nThis workflow will backup all instance workflows to GitHub every 24 hours.\n\nThe files are saved into folders using `YYYY/MM/` for the directory path and `ID.json` for the filename.\n\nThe Repo Owner, Repo Name and Main folder are set using the **Variables** feature but can be replaced with the `Config` node in the subworkflow. \n\nThe workflow runs calls itself to help reduce memory usage, Once the workflow has completed it will send an optional notification to Slack.\n\n### Time to Run\nTested with 1423 workflows on `1.44.1` it took under 30 minutes for the first run and under 12 minutes once the initial run is complete.","height":417,"width":385,"color":4},"id":"0020c515-4217-47c8-bc18-36e1e95f1264","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","position":[-240,0],"typeVersion":1},{"parameters":{"content":"## Main workflow loop","height":416.1856906618075,"width":1272.6408145680155,"color":7},"id":"5e352fae-ae16-4f5a-9c3c-5b784d289b8c","name":"Sticky Note2","type":"n8n-nodes-base.stickyNote","position":[200,0],"typeVersion":1},{"parameters":{"select":"channel","channelId":{"__rl":true,"mode":"name","value":"#notifications"},"text":"=:information_source:  Starting Workflow Backup [{{ $execution.id }}]","otherOptions":{"includeLinkToWorkflow":false}},"id":"96b16535-2512-43a8-8785-7df548b4faf8","name":"Starting Message","type":"n8n-nodes-base.slack","position":[480,180],"webhookId":"c02eb407-5547-4aa0-9ebf-46dab67b63b6","typeVersion":2.2},{"parameters":{"workflowId":"={{ $workflow.id }}","mode":"each","options":{}},"id":"17a0bfc8-75e3-4e55-bc42-16b34e8eda59","name":"Execute Workflow","type":"n8n-nodes-base.executeWorkflow","position":[1060,200],"typeVersion":1,"onError":"continueErrorOutput"},{"parameters":{"select":"channel","channelId":{"__rl":true,"mode":"name","value":"#notifications"},"text":"=✅ Backup has completed - {{ $('n8n').all().length }} workflows have been processed.","otherOptions":{}},"id":"794d93cc-38b5-4358-af46-fc3b399d649d","name":"Completed Notification","type":"n8n-nodes-base.slack","position":[1060,20],"webhookId":"a0c6e8c8-5d71-40fa-b02b-63a7ed5726c4","executeOnce":true,"typeVersion":2.2},{"parameters":{"select":"channel","channelId":{"__rl":true,"mode":"name","value":"#notifications"},"text":"=:x: Failed to backup {{ $('Loop Over Items').item.json.id }}","otherOptions":{"includeLinkToWorkflow":false}},"id":"6e6196f1-7493-4adc-b86e-d08f0f215b7b","name":"Failed Flows","type":"n8n-nodes-base.slack","position":[1260,220],"webhookId":"2a092edb-de12-490f-931b-34d70e7d7696","typeVersion":2.2},{"parameters":{"resource":"file","operation":"get","owner":{"__rl":true,"mode":"","value":"={{ $('Config').first().item.repo_owner }}"},"repository":{"__rl":true,"mode":"","value":"={{ $('Config').first().item.repo_name }}"},"filePath":"={{ $('Config').first().item.repo_path }}{{ $('Execute Workflow Trigger').first().json.createdAt.split('-')[0] }}/{{ $('Execute Workflow Trigger').first().json.createdAt.split('-')[1] }}/{{$json.id}}.json","asBinaryProperty":false,"additionalParameters":{}},"id":"e462b03d-78a2-4af3-9777-d5141d52ea30","name":"Get file data","type":"n8n-nodes-base.github","position":[0,560],"typeVersion":1,"alwaysOutputData":true,"webhookId":"1f63fbd1-77ab-4232-a49e-73eebe838669","continueOnFail":true},{"parameters":{"assignments":{"assignments":[{"id":"8f6d1741-772f-462a-811f-4c334185e4f0","name":"repo_owner","type":"string","value":"={{ $vars.repo_owner }}"},{"id":"8cac215c-4fd7-422f-9fd2-6b2d1e5e0383","name":"repo_name","type":"string","value":"={{ $vars.repo_name }}"},{"id":"eee305e9-4164-462a-86bd-80f0d58a31ae","name":"repo_path","type":"string","value":"={{ $vars.repo_path }}"}]},"includeOtherFields":true,"options":{}},"id":"a3a824a4-b9e7-475d-b32b-f9c8efb1c6e2","name":"Config","type":"n8n-nodes-base.set","position":[0,840],"typeVersion":3.4}],"connections":{"n8n":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Config":{"main":[[{"node":"Get file data","type":"main","index":0},{"node":"Merge Items","type":"main","index":1}]]},"Get File":{"main":[[{"node":"Merge Items","type":"main","index":0}]]},"File is new":{"main":[[{"node":"Create new file","type":"main","index":0}]]},"Merge Items":{"main":[[{"node":"isDiffOrNew","type":"main","index":0}]]},"isDiffOrNew":{"main":[[{"node":"Create sub path","type":"main","index":0}]]},"Check Status":{"main":[[{"node":"Same file - Do nothing","type":"main","index":0}],[{"node":"File is different","type":"main","index":0}],[{"node":"File is new","type":"main","index":0}]]},"Failed Flows":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Get file data":{"main":[[{"node":"If file too large","type":"main","index":0}]]},"Create new file":{"main":[[{"node":"Return","type":"main","index":0}]]},"Create sub path":{"main":[[{"node":"Check Status","type":"main","index":0}]]},"Loop Over Items":{"main":[[{"node":"Completed Notification","type":"main","index":0}],[{"node":"Execute Workflow","type":"main","index":0}]]},"Execute Workflow":{"main":[[{"node":"Loop Over Items","type":"main","index":0}],[{"node":"Failed Flows","type":"main","index":0}]]},"Schedule Trigger":{"main":[[{"node":"Starting Message","type":"main","index":0}]]},"Starting Message":{"main":[[{"node":"n8n","type":"main","index":0}]]},"File is different":{"main":[[{"node":"Edit existing file","type":"main","index":0}]]},"If file too large":{"main":[[{"node":"Get File","type":"main","index":0}],[{"node":"Merge Items","type":"main","index":0}]]},"Edit existing file":{"main":[[{"node":"Return","type":"main","index":0}]]},"On clicking 'execute'":{"main":[[{"node":"Starting Message","type":"main","index":0}]]},"Same file - Do nothing":{"main":[[{"node":"Return","type":"main","index":0}]]},"Execute Workflow Trigger":{"main":[[{"node":"Config","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"cc44e253-904f-4b4b-ba27-a73fec8d1e4f","triggerCount":0,"tags":[],"shared":[{"createdAt":"2025-06-02T13:19:58.333Z","updatedAt":"2025-06-02T13:19:58.333Z","role":"workflow:owner","workflowId":"k7n2pYxg0ypUZYK4","projectId":"UuIRn3TQYG7gFAJh","project":{"createdAt":"2025-06-02T06:58:10.171Z","updatedAt":"2025-06-02T11:56:13.936Z","id":"UuIRn3TQYG7gFAJh","name":"Kshitiz Gupta <kshitiz305@live.com>","type":"personal","icon":null,"description":null}}]},{"createdAt":"2025-06-04T04:25:12.006Z","updatedAt":"2025-08-30T08:16:09.846Z","id":"8XjboaEMlYlLMXGU","name":"Doctor selection- HARDCODED","active":false,"isArchived":false,"nodes":[{"parameters":{"documentId":{"__rl":true,"value":"15dOz4nD1iDO26zU5ZYnP_9PqBSBUqEzDTcsI_YQnTX4","mode":"list","cachedResultName":"Appointment Sheet","cachedResultUrl":"https://docs.google.com/spreadsheets/d/15dOz4nD1iDO26zU5ZYnP_9PqBSBUqEzDTcsI_YQnTX4/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":879069358,"mode":"list","cachedResultName":"doctor_available","cachedResultUrl":"https://docs.google.com/spreadsheets/d/15dOz4nD1iDO26zU5ZYnP_9PqBSBUqEzDTcsI_YQnTX4/edit#gid=879069358"},"options":{}},"name":"Google Sheets1","type":"n8n-nodes-base.googleSheets","typeVersion":4,"position":[780,2340],"id":"c771b96c-9fb5-439f-b8c4-b25f0df59746","alwaysOutputData":true,"credentials":{"googleSheetsOAuth2Api":{"id":"n1mJzLfz9loDmBOy","name":"OAuth Account kshitiz305280@gmail.com"}}},{"parameters":{"values":{"string":[{"name":"spreadsheet_id","value":"15dOz4nD1iDO26zU5ZYnP_9PqBSBUqEzDTcsI_YQnTX4"},{"name":"sheet_range","value":"Sheet1!A1:E100"},{"name":"type","value":"Pediatrition"},{"name":"timezone","value":"America/New_York"}]},"options":{}},"name":"Workflow Data1","type":"n8n-nodes-base.set","typeVersion":1,"position":[560,2440],"id":"c885a6be-66a2-461f-ab03-a0d221ecafff"},{"parameters":{"conditions":{"options":{"caseSensitive":false,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"b382b1bd-d641-45f9-bde3-a7b10000e49f","leftValue":"={{ $json.Type }}","rightValue":"={{ $('When Executed by Another Workflow').item.json.query }}","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{"ignoreCase":true}},"type":"n8n-nodes-base.filter","typeVersion":2.2,"position":[1000,2340],"id":"e458fa3a-dfb6-4e58-a75f-895f6b9b668a","name":"Filter1"},{"parameters":{"workflowInputs":{"values":[{"name":"query"}]}},"type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1.1,"position":[560,2240],"id":"90a02558-b26c-4c36-a384-356d46a47517","name":"When Executed by Another Workflow"},{"parameters":{"assignments":{"assignments":[]},"includeOtherFields":true,"include":"except","excludeFields":"row_number, [\"Phone Number\"]","options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1760,2240],"id":"764090ed-5749-4670-9756-21d334657f26","name":"Edit Fields"},{"parameters":{"assignments":{"assignments":[{"id":"15c99c3d-b011-46c6-a3dd-8c62cb6d486b","name":"Type","value":"={{ $json.Type }} is not Available","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1600,2420],"id":"c7c05c32-8ad5-469d-9778-75990733f460","name":"Edit Fields2"}],"connections":{"Google Sheets1":{"main":[[{"node":"Filter1","type":"main","index":0}]]},"Workflow Data1":{"main":[[{"node":"Google Sheets1","type":"main","index":0}]]},"Filter1":{"main":[[{"node":"Edit Fields","type":"main","index":0}]]},"When Executed by Another Workflow":{"main":[[{"node":"Google Sheets1","type":"main","index":0}]]}},"settings":{"executionOrder":"v1","timezone":"Asia/Kolkata","callerPolicy":"workflowsFromSameOwner"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"When Executed by Another Workflow":[{"json":{"query":"General Physician"}}]},"versionId":"d40a66da-d9cd-438a-a77a-4b6cc2205acb","triggerCount":0,"tags":[],"shared":[{"createdAt":"2025-06-04T04:25:12.006Z","updatedAt":"2025-06-04T04:25:12.006Z","role":"workflow:owner","workflowId":"8XjboaEMlYlLMXGU","projectId":"UuIRn3TQYG7gFAJh","project":{"createdAt":"2025-06-02T06:58:10.171Z","updatedAt":"2025-06-02T11:56:13.936Z","id":"UuIRn3TQYG7gFAJh","name":"Kshitiz Gupta <kshitiz305@live.com>","type":"personal","icon":null,"description":null}}]},{"createdAt":"2025-05-03T05:00:33.340Z","updatedAt":"2025-05-11T10:21:41.738Z","id":"ERyAMJ3CwK8V3k2u","name":"Doctor Prescription","active":false,"isArchived":false,"nodes":[{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[1580,-20],"id":"57ab6468-a309-476c-a357-a5342c94f002","name":"When clicking ‘Test workflow’"},{"parameters":{"operation":"update","documentURL":"={{ $json.id }}","actionsUi":{"actionFields":[{"action":"replaceAll","text":"{{appointment_id}}","replaceText":"={{ $('IF (Missing Prescription Link)1').item.json['Appointment Id'] }}"},{"action":"replaceAll","text":"{{patient_name}}","replaceText":"={{ $('IF (Missing Prescription Link)1').item.json['Patient\\'s Name'] }}"},{"action":"replaceAll","text":"{{doctor_name}}","replaceText":"={{ $('IF (Missing Prescription Link)1').item.json['Doctor Name'] }}"},{"action":"replaceAll","text":"{{patient_number}}","replaceText":"={{ $('IF (Missing Prescription Link)1').item.json['Phone Number'].toString() }}"},{"action":"replaceAll","text":"{{age}}","replaceText":"={{ $('IF (Missing Prescription Link)1').item.json['Patient\\'s Age'].toString() }}"},{"action":"replaceAll","text":"{{gender}}","replaceText":"={{ $('IF (Missing Prescription Link)1').item.json.Gender }}"},{"action":"replaceAll","text":"{{appointment_time}}","replaceText":"={{ $('IF (Missing Prescription Link)1').item.json['Appointment Date'] }}"},{"action":"replaceAll","text":"{{chief complaint}}","replaceText":"={{ $('IF (Missing Prescription Link)1').item.json['Presenting Symptoms & Complaints'] }}"},{"action":"replaceAll","text":"{{diagnose}}","replaceText":"={{ $('IF (Missing Prescription Link)1').item.json['Assessment & Diagnosis'] }}"},{"action":"replaceAll","text":"{{advice}}","replaceText":"={{ $('IF (Missing Prescription Link)1').item.json['Management Plan (Rx, Labs/Diagnostics, and Referral)'] }}"}]}},"name":"Replace Document Placeholders","type":"n8n-nodes-base.googleDocs","typeVersion":2,"position":[2680,-120],"id":"4b79083f-2282-423c-893b-6e7ceeb5a6f1","alwaysOutputData":false,"executeOnce":false,"notesInFlow":false,"credentials":{"googleDocsOAuth2Api":{"id":"f4mZBzlRh3u4CoH7","name":"Google Docs account"}}},{"parameters":{"operation":"update","documentId":{"__rl":true,"value":"15dOz4nD1iDO26zU5ZYnP_9PqBSBUqEzDTcsI_YQnTX4","mode":"list","cachedResultName":"Appointment Sheet","cachedResultUrl":"https://docs.google.com/spreadsheets/d/15dOz4nD1iDO26zU5ZYnP_9PqBSBUqEzDTcsI_YQnTX4/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":1816938999,"mode":"list","cachedResultName":"Form responses 3","cachedResultUrl":"https://docs.google.com/spreadsheets/d/15dOz4nD1iDO26zU5ZYnP_9PqBSBUqEzDTcsI_YQnTX4/edit#gid=1816938999"},"columnToMatchOn":"Appointment Id","valueToMatchOn":"={{ $('Google Sheets1').item.json['Appointment Id'] }}","fieldsUi":{"values":[{"column":"priscription_link","fieldValue":"={{ $('Google Drive2').item.json.webViewLink }}"}]},"options":{}},"name":"Update Spreadsheet","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[3780,-120],"id":"495d2e4e-da81-45a1-ad8c-88f83f6a89a5","credentials":{"googleSheetsOAuth2Api":{"id":"n1mJzLfz9loDmBOy","name":"OAuth Account kshitiz305280@gmail.com"}}},{"parameters":{"documentId":{"__rl":true,"value":"15dOz4nD1iDO26zU5ZYnP_9PqBSBUqEzDTcsI_YQnTX4","mode":"list","cachedResultName":"Appointment Sheet","cachedResultUrl":"https://docs.google.com/spreadsheets/d/15dOz4nD1iDO26zU5ZYnP_9PqBSBUqEzDTcsI_YQnTX4/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":1816938999,"mode":"list","cachedResultName":"Form responses 3","cachedResultUrl":"https://docs.google.com/spreadsheets/d/15dOz4nD1iDO26zU5ZYnP_9PqBSBUqEzDTcsI_YQnTX4/edit#gid=1816938999"},"options":{}},"name":"Google Sheets1","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[1800,-120],"id":"b815573c-f572-4cc9-80f0-55703a812400","credentials":{"googleSheetsOAuth2Api":{"id":"n1mJzLfz9loDmBOy","name":"OAuth Account kshitiz305280@gmail.com"}}},{"parameters":{"conditions":{"string":[{"value1":"={{ $json[\"priscription_link\"] }}","operation":"isEmpty"}]}},"name":"IF (Missing Prescription Link)1","type":"n8n-nodes-base.if","typeVersion":1,"position":[2240,-120],"id":"9d8d7704-28b8-4783-a645-565f67a73671"},{"parameters":{"functionCode":"// Add row index to each item for update reference\nreturn items.map((item, index) => {\n  return {\n    json: {\n      ...item.json,\n      row: index,\n      spreadsheetId: item.binary?.spreadsheetId?.fileName || \"YOUR_SPREADSHEET_ID\"\n    }\n  };\n});"},"name":"Add Row Index1","type":"n8n-nodes-base.function","typeVersion":1,"position":[2020,-120],"id":"77c1186d-2307-4e92-b5fa-74cc4f55700d"},{"parameters":{"content":"## Workflow Execution Complete\n\nSuccessfully processed appointment records without prescription links.\n\n- Created new Google Doc from template\n- Used Google Docs API to replace placeholders\n- Saved to 'Processed Appointments' folder\n- Updated spreadsheet with link to new document","height":255.99999999999997,"width":400},"name":"Sticky Note3","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[3160,-480],"id":"b7adaaae-d5f1-4458-8b90-abc80ed7182a"},{"parameters":{"content":"## Workflow Process\n\n1. Read appointments from Google Sheet\n2. Filter rows without prescription links\n3. Create a copy of the template document for each row\n4. Replace placeholders with appointment data using Google Docs API\n5. Move document to output folder\n6. Update original spreadsheet with document link","height":255.99999999999997,"width":400},"name":"Sticky Note6","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1800,-480],"id":"604085e8-48f0-4ec1-8ae3-c3156e1507cb"},{"parameters":{"operation":"copy","fileId":{"__rl":true,"value":"1hMCLp1kExNHR-A-Vw7dTbiT0dX-p7IZrsRLjOdc5040","mode":"list","cachedResultName":"AMB-1001-2523122","cachedResultUrl":"https://docs.google.com/document/d/1hMCLp1kExNHR-A-Vw7dTbiT0dX-p7IZrsRLjOdc5040/edit?usp=drivesdk"},"name":"={{ \"PRESCRIPTION_\"+ $json['Appointment Id']}}","options":{}},"type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[2460,-120],"id":"b466f7a7-b958-49f7-8cea-d0b50d55ff60","name":"Google Drive","credentials":{"googleDriveOAuth2Api":{"id":"pOtcm7bA642xCdGc","name":"Google Drive account"}}},{"parameters":{"operation":"download","fileId":{"__rl":true,"value":"={{ $json.documentId }}","mode":"id"},"options":{"binaryPropertyName":"data","googleFileConversion":{"conversion":{"docsToFormat":"application/pdf"}}}},"type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[2900,-120],"id":"bfae2642-3b50-49d0-97a3-3227df40dd1f","name":"Google Drive1","credentials":{"googleDriveOAuth2Api":{"id":"pOtcm7bA642xCdGc","name":"Google Drive account"}}},{"parameters":{"name":"={{ $('Google Drive').item.json.name }}","driveId":{"__rl":true,"mode":"list","value":"My Drive"},"folderId":{"__rl":true,"value":"1TQE1EctUZBiMD4J12ts156WqfVCk3ZmV","mode":"list","cachedResultName":"N8N","cachedResultUrl":"https://drive.google.com/drive/folders/1TQE1EctUZBiMD4J12ts156WqfVCk3ZmV"},"options":{}},"type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[3120,-120],"id":"5d0969c0-cbb4-443d-b501-b392868cabc2","name":"Google Drive2","alwaysOutputData":true,"credentials":{"googleDriveOAuth2Api":{"id":"pOtcm7bA642xCdGc","name":"Google Drive account"}}},{"parameters":{"operation":"share","fileId":{"__rl":true,"value":"={{ $json.id }}","mode":"id"},"permissionsUi":{"permissionsValues":{"role":"reader","type":"anyone"}},"options":{}},"type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[3560,-120],"id":"47cd84ba-09c0-4e01-af4c-f9fa061bcf5b","name":"Google Drive3","alwaysOutputData":true,"credentials":{"googleDriveOAuth2Api":{"id":"pOtcm7bA642xCdGc","name":"Google Drive account"}}},{"parameters":{"rule":{"interval":[{"field":"seconds","secondsInterval":5}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[1580,-220],"id":"c1af33c5-9edd-4dfe-bbc5-754ddd412b2a","name":"Schedule Trigger"},{"parameters":{"operation":"deleteFile","fileId":{"__rl":true,"value":"={{ $('Google Drive1').item.json.documentId }}","mode":"id"},"options":{"deletePermanently":false}},"type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[3340,-120],"id":"d748c0a3-90ec-45b9-8bb9-a612810d6098","name":"Google Drive4","credentials":{"googleDriveOAuth2Api":{"id":"pOtcm7bA642xCdGc","name":"Google Drive account"}}}],"connections":{"When clicking ‘Test workflow’":{"main":[[{"node":"Google Sheets1","type":"main","index":0}]]},"Replace Document Placeholders":{"main":[[{"node":"Google Drive1","type":"main","index":0}]]},"Google Sheets1":{"main":[[{"node":"Add Row Index1","type":"main","index":0}]]},"IF (Missing Prescription Link)1":{"main":[[{"node":"Google Drive","type":"main","index":0}]]},"Add Row Index1":{"main":[[{"node":"IF (Missing Prescription Link)1","type":"main","index":0}]]},"Google Drive":{"main":[[{"node":"Replace Document Placeholders","type":"main","index":0}]]},"Google Drive1":{"main":[[{"node":"Google Drive2","type":"main","index":0}]]},"Google Drive2":{"main":[[{"node":"Google Drive4","type":"main","index":0}]]},"Google Drive3":{"main":[[{"node":"Update Spreadsheet","type":"main","index":0}]]},"Schedule Trigger":{"main":[[{"node":"Google Sheets1","type":"main","index":0}]]},"Google Drive4":{"main":[[{"node":"Google Drive3","type":"main","index":0}]]},"Update Spreadsheet":{"main":[[]]}},"settings":{"executionOrder":"v1"},"staticData":{"node:Schedule Trigger":{"recurrenceRules":[]}},"meta":{"templateId":"3145","templateCredsSetupCompleted":true},"pinData":{},"versionId":"2a16164f-b48f-4bdc-a6d3-e63493b1ed41","triggerCount":1,"tags":[],"shared":[{"createdAt":"2025-06-02T13:19:58.333Z","updatedAt":"2025-06-02T13:19:58.333Z","role":"workflow:owner","workflowId":"ERyAMJ3CwK8V3k2u","projectId":"UuIRn3TQYG7gFAJh","project":{"createdAt":"2025-06-02T06:58:10.171Z","updatedAt":"2025-06-02T11:56:13.936Z","id":"UuIRn3TQYG7gFAJh","name":"Kshitiz Gupta <kshitiz305@live.com>","type":"personal","icon":null,"description":null}}]},{"createdAt":"2025-02-21T19:14:29.629Z","updatedAt":"2025-02-22T11:26:23.432Z","id":"EOhXEwcjpeVqwS8b","name":"Automate Image Validation Tasks using AI Vision","active":false,"isArchived":false,"nodes":[{"parameters":{},"id":"6c78b4c7-993b-410d-93e7-e11b3052e53b","name":"When clicking ‘Test workflow’","type":"n8n-nodes-base.manualTrigger","position":[520,660],"typeVersion":1},{"parameters":{"schemaType":"manual","inputSchema":"{\n\t\"type\": \"object\",\n\t\"properties\": {\n\t\t\"is_valid\": { \"type\": \"boolean\" },\n        \"photo_description\": {\n          \"type\": \"string\",\n          \"description\": \"describe the appearance of the person(s), object(s) if any and the background in the image. Mention any colours of each if possible.\"\n        },\n\t\t\"reasons\": {\n          \"type\": \"array\",\n          \"items\": { \"type\": \"string\" }\n        }\n\t}\n}"},"id":"c2ab6497-6d6d-483b-bd43-494ae95394c0","name":"Structured Output Parser","type":"@n8n/n8n-nodes-langchain.outputParserStructured","position":[1960,840],"typeVersion":1.2},{"parameters":{"assignments":{"assignments":[{"id":"6baa3e08-8957-454e-8ee9-d5414a0ff990","name":"data","type":"array","value":"={{\n[\n{\n  \"name\": \"portrait_1\",\n  \"url\": \"https://drive.google.com/file/d/1zs963iFkO-3g2rKak8Hcy555h55D8gjF/view?usp=sharing\"\n},\n{\n  \"name\": \"portrait_2\",\n  \"url\": \"https://drive.google.com/file/d/19FyDcs68dZauQSEf6SEulJMag51SPsFy/view?usp=sharing\"\n},\n{\n  \"name\": \"portrait_3\",\n  \"url\": \"https://drive.google.com/file/d/1gbXjfNYE7Tvuw_riFmHMKoqPPu696VfW/view?usp=sharing\",\n\n},\n{\n  \"name\": \"portrait_4\",\n  \"url\": \"https://drive.google.com/file/d/1s19hYdxgfMkrnU25l6YIDq-myQr1tQMa/view?usp=sharing\"\n},\n{\n  \"name\": \"portrait_5\",\n  \"url\": \"https://drive.google.com/file/d/193FqIXJWAKj6O2SmOj3cLBfypHBkgdI5/view?usp=sharing\"\n}\n]\n}}"}]},"options":{}},"id":"b23f5298-17c7-49ac-a8ca-78e006b2d294","name":"Photo URLs","type":"n8n-nodes-base.set","position":[880,620],"typeVersion":3.4},{"parameters":{"fieldToSplitOut":"data","options":{}},"id":"8d445f73-dff7-485b-87e2-5b64da09cbf0","name":"Photos To List","type":"n8n-nodes-base.splitOut","position":[1040,620],"typeVersion":1},{"parameters":{"authentication":"serviceAccount","operation":"download","fileId":{"__rl":true,"value":"=https://drive.google.com/file/d/1zs963iFkO-3g2rKak8Hcy555h55D8gjF/view?usp=sharing","mode":"url"},"options":{}},"id":"7fb3b829-88a7-42ec-abfd-3ddaa042c916","name":"Download Photos","type":"n8n-nodes-base.googleDrive","position":[1200,620],"typeVersion":3,"credentials":{"googleApi":{"id":"zcTgnpZoc5S9Y3pb","name":"Google Service Account account"}}},{"parameters":{"operation":"resize","width":1024,"height":1024,"resizeOption":"onlyIfLarger","options":{}},"id":"b8644f6d-691f-49bc-b0fe-33a68c59638d","name":"Resize For AI","type":"n8n-nodes-base.editImage","position":[1580,680],"typeVersion":1},{"parameters":{"content":"## 1. Import Photos To Validate\n[Read more about using Google Drive](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googledrive)\n\nIn this demonstration, we'll import 5 different portraits to test our AI vision model. For convenience, we'll use Google Drive but feel free to swap this out for other sources such as other storage or by using webhooks.","height":438,"width":594,"color":7},"id":"ecb266f2-0d2d-4cbe-a641-26735f0bdf18","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","position":[800,420],"typeVersion":1},{"parameters":{"content":"## 2. Verify Passport Photo Validity Using AI Vision Model\n[Learn more about Basic LLM Chain](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.chainllm)\n\nVerifying if a photo is suitable for a passport photo is a great use-case for AI vision and to automate the process is an equally great use-case for using n8n. Here's we've pasted in the UK governments guidelines copied from gov.uk and have asked the AI to validate the incoming photos following those rules. A structured output parser is used to simplify the AI response which can be used to update a database or backend of your choosing.","height":589.25,"width":774,"color":7},"id":"a1034923-0905-4cdd-a6bf-21d28aa3dd71","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","position":[1420,420],"typeVersion":1},{"parameters":{"content":"## Try It Out!\n\n### This workflow takes a portrait and verifies if it makes for a valid passport photo. It achieves this by using an AI vision model following the UK government guidance.\n\nOpenAI's vision model was found to perform well for understanding photographs and so is recommended for this type of workflow. However, any capable vision model should work.\n\n### Need Help?\nJoin the [Discord](https://discord.com/invite/XPKeKXeB7d) or ask in the [Forum](https://community.n8n.io/)!","height":610.0104651162792,"width":386},"id":"af231ee5-adff-4d27-ba5f-8c04ddd4892d","name":"Sticky Note2","type":"n8n-nodes-base.stickyNote","position":[380,240],"typeVersion":1},{"parameters":{"promptType":"define","text":"Assess if the image is a valid according to the passport photo criteria as set by the UK Government.","hasOutputParser":true,"messages":{"messageValues":[{"message":"=You help verify passport photo validity.\n\n## Rules for digital photos\nhttps://www.gov.uk/photos-for-passports\n\n### The quality of your digital photo\nYour photo must be:\n* clear and in focus\n* in colour\n* unaltered by computer software\n* at least 600 pixels wide and 750 pixels tall\n* at least 50KB and no more than 10MB\n\n### What your digital photo must show\nThe digital photo must:\n* contain no other objects or people\n* be taken against a plain white or light-coloured background\n* be in clear contrast to the background\n* not have ‘red eye’\n* If you’re using a photo taken on your own device, include your head, shoulders and upper body. Do not crop your photo - it will be done for you.\n\nIn your photo you must:\n* be facing forwards and looking straight at the camera\n* have a plain expression and your mouth closed\n* have your eyes open and visible\n* not have hair in front of your eyes\n* not have a head covering (unless it’s for religious or medical reasons)\n* not have anything covering your face\n* not have any shadows on your face or behind you - shadows on light background are okay\n* Do not wear glasses in your photo unless you have to do so. If you must wear glasses, they cannot be sunglasses or tinted glasses, and you must make sure your eyes are not covered by the frames or any glare, reflection or shadow.\n\n### Photos of babies and children\n* Children must be on their own in the picture. Babies must not be holding toys or using dummies.\n* Children under 6 do not have to be looking directly at the camera or have a plain expression.\n* Children under one do not have to have their eyes open. You can support their head with your hand, but your hand must not be visible in the photo.\n* Children under one should lie on a plain light-coloured sheet. Take the photo from above.\n\n"},{"type":"HumanMessagePromptTemplate","messageType":"imageBinary"}]}},"id":"e07e1655-2683-4e21-b2b7-e0c0bfb569c0","name":"Passport Photo Validator","type":"@n8n/n8n-nodes-langchain.chainLlm","position":[1760,680],"typeVersion":1.4},{"parameters":{"modelName":"models/gemini-1.5-pro-latest","options":{}},"id":"0a36ba22-90b2-4abf-943b-c1cc8e7317d5","name":"Google Gemini Chat Model","type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","position":[1760,840],"typeVersion":1,"credentials":{"googlePalmApi":{"id":"lxY1yy9VjJFvamwS","name":"Google Gemini(PaLM) Api Paid"}}}],"connections":{"Photo URLs":{"main":[[{"node":"Photos To List","type":"main","index":0}]]},"Resize For AI":{"main":[[{"node":"Passport Photo Validator","type":"main","index":0}]]},"Photos To List":{"main":[[{"node":"Download Photos","type":"main","index":0}]]},"Download Photos":{"main":[[{"node":"Resize For AI","type":"main","index":0}]]},"Google Gemini Chat Model":{"ai_languageModel":[[{"node":"Passport Photo Validator","type":"ai_languageModel","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"Passport Photo Validator","type":"ai_outputParser","index":0}]]},"When clicking ‘Test workflow’":{"main":[[{"node":"Photo URLs","type":"main","index":0}]]},"Passport Photo Validator":{"main":[[]]}},"settings":{},"staticData":null,"meta":{"templateId":"2420"},"pinData":{},"versionId":"30403382-d7f7-4482-a4e5-8cc8221bb8ff","triggerCount":0,"tags":[],"shared":[{"createdAt":"2025-06-02T13:19:58.333Z","updatedAt":"2025-06-02T13:19:58.333Z","role":"workflow:owner","workflowId":"EOhXEwcjpeVqwS8b","projectId":"UuIRn3TQYG7gFAJh","project":{"createdAt":"2025-06-02T06:58:10.171Z","updatedAt":"2025-06-02T11:56:13.936Z","id":"UuIRn3TQYG7gFAJh","name":"Kshitiz Gupta <kshitiz305@live.com>","type":"personal","icon":null,"description":null}}]},{"createdAt":"2025-05-29T12:47:25.479Z","updatedAt":"2025-05-31T16:34:34.563Z","id":"4P75zLRFqQuYYx0S","name":"Check_payment_status","active":false,"isArchived":false,"nodes":[{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"id":"2a3b4c5d-6e7f-8a9b-0c1d-2e3f4a5b6c7d","leftValue":"={{ $json.status }}","rightValue":"paid","operator":{"type":"string","operation":"equals"}}],"combinator":"or"},"options":{}},"id":"529223f2-3012-43d7-9e57-6d3f082d88ea","name":"Check API Success","type":"n8n-nodes-base.if","typeVersion":2,"position":[-920,80]},{"parameters":{"url":"={{ $json.api_url }}","authentication":"genericCredentialType","genericAuthType":"httpBasicAuth","options":{}},"id":"cd1df1cf-523b-4a6c-a2e8-82a1d9dbef4f","name":"Get Payment Status","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-1140,80],"credentials":{"httpBasicAuth":{"id":"PszcqGCbFxeXYXla","name":"Razorpay credentials"}},"onError":"continueRegularOutput"},{"parameters":{"jsCode":"// Get payment_link_id from input data or set a default for testing\nconst paymentLinkId = $input.first().json.plink ;\n\nif (!paymentLinkId) {\n  throw new Error('payment_link_id is required');\n}\n\n// Validate payment link ID format (should start with 'plink_')\nif (!paymentLinkId.startsWith('plink_')) {\n  throw new Error('Invalid payment_link_id format. Should start with \"plink_\"');\n}\n\nreturn {\n  payment_link_id: paymentLinkId,\n  api_url: `https://api.razorpay.com/v1/payment_links/${paymentLinkId}`\n};"},"id":"c3a05640-7ed5-4075-8bcb-129e8e29f6df","name":"Prepare Payment ID","type":"n8n-nodes-base.code","typeVersion":2,"position":[-1360,80]},{"parameters":{},"id":"4aea9de4-4c89-4a19-9a6f-87a4d3fd5df2","name":"When clicking 'Test workflow'","type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[-1620,240]},{"parameters":{"workflowInputs":{"values":[{"name":"plink"}]}},"type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1.1,"position":[-1640,40],"id":"d89245ea-a2eb-4fb8-994a-6e29aa4fabc4","name":"When Executed by Another Workflow"},{"parameters":{"mode":"raw","jsonOutput":"{\n  \"status\": \"success\"\n}\n","options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-700,-20],"id":"aa998b9b-f760-4569-8f8c-d440afc7bedc","name":"Edit Fields"},{"parameters":{"mode":"raw","jsonOutput":"{\n  \"status\":\"failed\"\n}\n","options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-720,180],"id":"05aae10a-0f79-4014-9ad2-6471264dcd5d","name":"Edit Fields1"}],"connections":{"Check API Success":{"main":[[{"node":"Edit Fields","type":"main","index":0}],[{"node":"Edit Fields1","type":"main","index":0}]]},"Get Payment Status":{"main":[[{"node":"Check API Success","type":"main","index":0}]]},"Prepare Payment ID":{"main":[[{"node":"Get Payment Status","type":"main","index":0}]]},"When clicking 'Test workflow'":{"main":[[{"node":"Prepare Payment ID","type":"main","index":0}]]},"When Executed by Another Workflow":{"main":[[{"node":"Prepare Payment ID","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"When Executed by Another Workflow":[{"json":{"payment_link_id":"plink_123456"}}]},"versionId":"5145d823-c3d0-49f8-bde0-30a6d86b92fa","triggerCount":0,"tags":[],"shared":[{"createdAt":"2025-06-02T13:19:58.333Z","updatedAt":"2025-06-02T13:19:58.333Z","role":"workflow:owner","workflowId":"4P75zLRFqQuYYx0S","projectId":"UuIRn3TQYG7gFAJh","project":{"createdAt":"2025-06-02T06:58:10.171Z","updatedAt":"2025-06-02T11:56:13.936Z","id":"UuIRn3TQYG7gFAJh","name":"Kshitiz Gupta <kshitiz305@live.com>","type":"personal","icon":null,"description":null}}]},{"createdAt":"2025-05-07T07:08:48.118Z","updatedAt":"2025-05-13T13:16:33.177Z","id":"M0SkIJsQzuCrQsYK","name":"Doctor selection","active":false,"isArchived":false,"nodes":[{"parameters":{"documentId":{"__rl":true,"value":"15dOz4nD1iDO26zU5ZYnP_9PqBSBUqEzDTcsI_YQnTX4","mode":"list","cachedResultName":"Appointment Sheet","cachedResultUrl":"https://docs.google.com/spreadsheets/d/15dOz4nD1iDO26zU5ZYnP_9PqBSBUqEzDTcsI_YQnTX4/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":879069358,"mode":"list","cachedResultName":"doctor_available","cachedResultUrl":"https://docs.google.com/spreadsheets/d/15dOz4nD1iDO26zU5ZYnP_9PqBSBUqEzDTcsI_YQnTX4/edit#gid=879069358"},"options":{}},"name":"Google Sheets1","type":"n8n-nodes-base.googleSheets","typeVersion":4,"position":[780,2340],"id":"3a638e2b-8d3a-4eac-b72c-ca3218fa1053","alwaysOutputData":true,"credentials":{"googleSheetsOAuth2Api":{"id":"n1mJzLfz9loDmBOy","name":"OAuth Account kshitiz305280@gmail.com"}}},{"parameters":{"values":{"string":[{"name":"spreadsheet_id","value":"15dOz4nD1iDO26zU5ZYnP_9PqBSBUqEzDTcsI_YQnTX4"},{"name":"sheet_range","value":"Sheet1!A1:E100"},{"name":"type","value":"Pediatrition"},{"name":"timezone","value":"America/New_York"}]},"options":{}},"name":"Workflow Data1","type":"n8n-nodes-base.set","typeVersion":1,"position":[560,2440],"id":"137930d6-f89f-4aeb-a2bd-ab5bdfee296f"},{"parameters":{"conditions":{"options":{"caseSensitive":false,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"b382b1bd-d641-45f9-bde3-a7b10000e49f","leftValue":"={{ $json.Type }}","rightValue":"={{ $('When Executed by Another Workflow').item.json.query }}","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{"ignoreCase":true}},"type":"n8n-nodes-base.filter","typeVersion":2.2,"position":[1000,2340],"id":"33efeae2-63a0-4ffb-901e-06b700b0c52d","name":"Filter1"},{"parameters":{"resource":"calendar","calendar":{"__rl":true,"value":"={{ $json.doctor_email }}","mode":"id"},"timeMin":"={{ $('When Executed by Another Workflow').item.json.time.toDateTime().toString()}}","timeMax":"={{ $('When Executed by Another Workflow').item.json.time.toDateTime().plus(30,'min').toString()}}","options":{"outputFormat":"availability","timezone":{"__rl":true,"value":"Asia/Calcutta","mode":"list","cachedResultName":"Asia/Calcutta"}}},"type":"n8n-nodes-base.googleCalendar","typeVersion":1.3,"position":[1220,2415],"id":"6c121c67-f166-42d2-8c68-8bd9509f6442","name":"Google Calendar","credentials":{"googleCalendarOAuth2Api":{"id":"uD8AIc77E2dJeCtx","name":"Google Calendar account"}}},{"parameters":{"mode":"combine","combineBy":"combineByPosition","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.1,"position":[1440,2340],"id":"e7ba421f-856e-4c92-8364-152827837f5f","name":"Merge"},{"parameters":{"conditions":{"options":{"caseSensitive":false,"leftValue":"","typeValidation":"loose","version":2},"conditions":[{"id":"d7b0fa56-367c-4394-924e-fe377c574172","leftValue":"={{ $json.available }}","rightValue":"true","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"or"},"looseTypeValidation":true,"options":{"ignoreCase":true}},"type":"n8n-nodes-base.filter","typeVersion":2.2,"position":[1880,2240],"id":"7b147209-9fed-49d7-82f5-5182bffcc0e5","name":"Filter"},{"parameters":{"workflowInputs":{"values":[{"name":"query"},{"name":"time"}]}},"type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1.1,"position":[560,2240],"id":"ea35b5fa-986e-4b75-a7aa-4480cfd7381a","name":"When Executed by Another Workflow"},{"parameters":{"assignments":{"assignments":[]},"includeOtherFields":true,"include":"selected","includeFields":"['Doctor Name'], Type, ['Call Link'], doctor_email, available","options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[2100,2240],"id":"7ade1299-7711-4888-845e-62686351ea31","name":"Edit Fields"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"loose","version":2},"conditions":[{"id":"068b7a1a-1349-4162-b3ef-061b4332e832","leftValue":"={{ $json.available }}","rightValue":"true","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"looseTypeValidation":true,"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1660,2340],"id":"cfa721d7-9aec-47e7-961d-a647b9936ea2","name":"If1"},{"parameters":{"assignments":{"assignments":[{"id":"15c99c3d-b011-46c6-a3dd-8c62cb6d486b","name":"Type","value":"={{ $json.Type }} is not Available","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1880,2440],"id":"d5ac9845-df2f-4562-b3dc-16caddba84ef","name":"Edit Fields2"}],"connections":{"Google Sheets1":{"main":[[{"node":"Filter1","type":"main","index":0}]]},"Workflow Data1":{"main":[[{"node":"Google Sheets1","type":"main","index":0}]]},"Filter1":{"main":[[{"node":"Merge","type":"main","index":0},{"node":"Google Calendar","type":"main","index":0}]]},"Google Calendar":{"main":[[{"node":"Merge","type":"main","index":1}]]},"Merge":{"main":[[{"node":"If1","type":"main","index":0}]]},"Filter":{"main":[[{"node":"Edit Fields","type":"main","index":0}]]},"When Executed by Another Workflow":{"main":[[{"node":"Google Sheets1","type":"main","index":0}]]},"If1":{"main":[[{"node":"Filter","type":"main","index":0}],[{"node":"Edit Fields2","type":"main","index":0}]]}},"settings":{"executionOrder":"v1","timezone":"Asia/Kolkata","callerPolicy":"workflowsFromSameOwner"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"When Executed by Another Workflow":[{"json":{"query":"General Physician","time":"2025-05-14T16:00:00.000"}}]},"versionId":"6e387604-edfd-459c-8ebb-4708be9de6bc","triggerCount":0,"tags":[],"shared":[{"createdAt":"2025-06-02T13:19:58.333Z","updatedAt":"2025-06-02T13:19:58.333Z","role":"workflow:owner","workflowId":"M0SkIJsQzuCrQsYK","projectId":"UuIRn3TQYG7gFAJh","project":{"createdAt":"2025-06-02T06:58:10.171Z","updatedAt":"2025-06-02T11:56:13.936Z","id":"UuIRn3TQYG7gFAJh","name":"Kshitiz Gupta <kshitiz305@live.com>","type":"personal","icon":null,"description":null}}]},{"createdAt":"2025-02-22T13:44:48.384Z","updatedAt":"2025-02-22T13:44:48.384Z","id":"j3CbtLB2LcAqETYh","name":"Generate Instagram Content from Top Trends with AI Image Generation","active":false,"isArchived":false,"nodes":[{"parameters":{"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"0304efee-33b2-499e-bad1-9238c1fc2999","operator":{"name":"filter.operator.equals","type":"string","operation":"equals"},"leftValue":"={{ $json.status_code }}","rightValue":"FINISHED"}]},"options":{}},"id":"8c49be2b-6320-4eb0-8303-6448ced34636","name":"If media status is finished","type":"n8n-nodes-base.if","position":[4980,1440],"typeVersion":2.2},{"parameters":{"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"0304efee-33b2-499e-bad1-9238c1fc2999","operator":{"name":"filter.operator.equals","type":"string","operation":"equals"},"leftValue":"={{ $json.status_code }}","rightValue":"PUBLISHED"}]},"options":{}},"id":"f0cc0be5-6d35-4334-a124-139fa8676d07","name":"If media status is finished1","type":"n8n-nodes-base.if","position":[5560,1440],"typeVersion":2.2},{"parameters":{"chatId":"={{ $('Telegram Params').item.json.telegram_chat_id }}","text":"Video upload edilmeden önce bir problem oldu","additionalFields":{}},"id":"c8d8d8cd-8501-4d1b-ac28-8cb3fa74d9d7","name":"Telegram","type":"n8n-nodes-base.telegram","position":[5140,1620],"typeVersion":1.2,"webhookId":"df35e14f-e0dc-4eea-a776-7d3e72e0b5ed"},{"parameters":{"chatId":"={{ $('Telegram Params').item.json.telegram_chat_id }}","text":"Instagram Content is shared","additionalFields":{}},"id":"ae91a5e0-4f70-4a1c-afa5-41f5449facab","name":"Telegram1","type":"n8n-nodes-base.telegram","position":[5720,1280],"typeVersion":1.2,"webhookId":"38a0e1e3-cb55-4eda-860a-30666891c13b"},{"parameters":{"chatId":"={{ $('Telegram Params').item.json.telegram_chat_id }}","text":"There was a problem when execution a upload content to instagram","additionalFields":{}},"id":"b8b38440-14a7-43f6-ac49-6ca9502ff54d","name":"Telegram2","type":"n8n-nodes-base.telegram","position":[5720,1620],"typeVersion":1.2,"webhookId":"c0d7531b-1904-4103-a249-f755412a058f"},{"parameters":{"options":{}},"id":"82e0e5d0-bf50-4b2e-8693-2612dffe53e2","name":"Loop Over Items","type":"n8n-nodes-base.splitInBatches","position":[2560,1400],"typeVersion":3},{"parameters":{"rule":{"interval":[{"field":"cronExpression","expression":"5 13,19 * * *"}]}},"id":"fb72beb1-1a6a-4148-9ee4-cdc564c4dc5c","name":"Schedule Trigger1","type":"n8n-nodes-base.scheduleTrigger","position":[480,1480],"typeVersion":1.2},{"parameters":{"assignments":{"assignments":[{"id":"d18cdca7-d301-4c70-a4d0-8d6e7ecfc2d1","name":"telegram_chat_id","type":"string","value":""}]},"options":{}},"id":"470f3406-19d2-420c-8f33-7031237d882c","name":"Telegram Params","type":"n8n-nodes-base.set","position":[1240,1480],"typeVersion":3.4},{"parameters":{"assignments":{"assignments":[{"id":"1e380c14-e908-4eeb-90e0-957a422829d0","name":"instagram_business_account_id","type":"string","value":""}]},"options":{}},"id":"12971505-7061-4d32-8921-d2e731eae9db","name":"Instagram params","type":"n8n-nodes-base.set","position":[1000,1480],"typeVersion":3.4},{"parameters":{"content":"## All Credentials You Need\n**  Instagram Business Account Id\n** Telegram Chat Id\n**  Rapid Api Key\n** Replicate Token","height":600,"width":1000,"color":4},"id":"3cb5f27d-eb3b-4fdc-bb55-1b54f85298e5","name":"Sticky Note2","type":"n8n-nodes-base.stickyNote","position":[700,1200],"typeVersion":1},{"parameters":{"assignments":{"assignments":[{"id":"48a33ec7-2b4f-496a-ad77-e4d5f1907ee4","name":"x-rapid-api-key","type":"string","value":""}]},"options":{}},"id":"2bc617b8-835c-48ba-8de6-341a6c87b853","name":"Rapid Api params","type":"n8n-nodes-base.set","position":[1480,1480],"notesInFlow":false,"typeVersion":3.4,"notes":"test"},{"parameters":{"jsCode":"const filteredData = $input.first().json.data.items.filter(item=> !item.is_video)\nreturn filteredData.map((item)=>{\n  return {\n    id: item.id,\n    prompt: item.caption.text,\n    content_code: item.code,\n    thumbnail_url: item.thumbnail_url,\n    tag: $input.first().json.data.additional_data.name\n  }\n})                                                                    \n\n"},"id":"23bad41e-40ac-4488-8b2f-0d54d22a927a","name":"filter the image content","type":"n8n-nodes-base.code","position":[2080,1560],"typeVersion":2},{"parameters":{"url":"https://instagram-scraper-api2.p.rapidapi.com/v1/hashtag","sendQuery":true,"queryParameters":{"parameters":[{"name":"hashtag","value":"blender3d"},{"name":"feed_type","value":"top"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"x-rapidapi-host","value":"instagram-scraper-api2.p.rapidapi.com"},{"name":"x-rapidapi-key","value":"={{ $json['x-rapid-api-key'] }}"}]},"options":{}},"id":"a65690cd-4d30-4541-b80d-aae872326a77","name":"get  top trends on instagram #blender3d","type":"n8n-nodes-base.httpRequest","position":[1840,1360],"typeVersion":4.2},{"parameters":{"url":"https://instagram-scraper-api2.p.rapidapi.com/v1/hashtag","sendQuery":true,"queryParameters":{"parameters":[{"name":"hashtag","value":"isometric"},{"name":"feed_type","value":"top"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"x-rapidapi-host","value":"instagram-scraper-api2.p.rapidapi.com"},{"name":"x-rapidapi-key","value":"={{ $json['x-rapid-api-key'] }}"}]},"options":{}},"id":"8707c475-7e28-4d80-92b8-ba24033c4632","name":"get top trends on instagram #isometric","type":"n8n-nodes-base.httpRequest","position":[1840,1560],"typeVersion":4.2},{"parameters":{},"id":"1c1bfd8f-b086-4147-ba08-578877f2a315","name":"merge the array content","type":"n8n-nodes-base.merge","position":[2280,1460],"typeVersion":3},{"parameters":{"content":"## Schedule Your Time To  Post\n","height":600,"width":280,"color":3},"id":"dcc2b6b6-9880-4676-8a1a-a3c21e583bba","name":"Sticky Note3","type":"n8n-nodes-base.stickyNote","position":[380,1200],"typeVersion":1},{"parameters":{"content":"## Guide \n** [Guide](https://docs.matillion.com/metl/docs/6957316//) of getting  of Instagram Business Account Id ","height":300,"width":180,"color":5},"id":"c1e0ac33-c4b7-47d8-bd2b-0b74b02afe38","name":"Sticky Note4","type":"n8n-nodes-base.stickyNote","position":[960,1340],"typeVersion":1},{"parameters":{"content":"## Guide \n** [Guide](https://rapidapi.com/i-yqerddkq0t/api/telegram92/tutorials/how-to-get-the-id-of-a-telegram-channel,-chat,-user-or-bot%3F) of Getting  of Telegram Chat Id ","height":300,"width":180,"color":5},"id":"321680da-ca7a-4c6f-98d4-a0d8f8d0347f","name":"Sticky Note5","type":"n8n-nodes-base.stickyNote","position":[1200,1340],"typeVersion":1},{"parameters":{"content":"## Guide \n** [Guide](https://docs.rapidapi.com/docs/keys-and-key-rotation) of Getting  of Rapid Api Key ","height":300,"width":180,"color":5},"id":"b3d07cf7-8d03-4644-88f7-2e94de0c43c2","name":"Sticky Note6","type":"n8n-nodes-base.stickyNote","position":[1440,1340],"typeVersion":1},{"parameters":{"content":"## Warning\n**Don't forgot the create bot and send a message to bot first","height":120,"width":180,"color":7},"id":"b6dbdfaa-fc71-4def-a723-bf6c0facd372","name":"Sticky Note7","type":"n8n-nodes-base.stickyNote","position":[1200,1660],"typeVersion":1},{"parameters":{"content":"## Getting Top Trend Posts On Instagram\n** Change the topic you want to get on http request","height":600,"width":660},"id":"81d598e2-8993-4315-9894-2e78dc26ad10","name":"Sticky Note8","type":"n8n-nodes-base.stickyNote","position":[1740,1200],"typeVersion":1},{"parameters":{"operation":"select","schema":{"__rl":true,"mode":"list","value":"public","cachedResultName":"public"},"table":{"__rl":true,"mode":"list","value":"top_trends","cachedResultName":"top_trends"},"where":{"values":[{"column":"code","value":"={{$json.content_code}}"}]},"options":{}},"id":"6beb79ef-8205-4882-9bb0-6a2e1a33f1d4","name":"Check Data on Database Is Exist","type":"n8n-nodes-base.postgres","position":[2800,1400],"typeVersion":2.5,"alwaysOutputData":true,"onError":"continueErrorOutput"},{"parameters":{"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"loose"},"combinator":"and","conditions":[{"id":"9dc20983-ae4d-40db-b969-7d43fa8b0c3e","operator":{"type":"boolean","operation":"true","singleValue":true},"leftValue":"={{ !$json.isEmpty() }}","rightValue":"we"},{"id":"0e1b9264-be56-4d0c-a83e-d9ca0b05b265","operator":{"name":"filter.operator.equals","type":"string","operation":"equals"},"leftValue":"","rightValue":""}]},"looseTypeValidation":true,"options":{}},"id":"5b0c05a8-3eb7-4ad8-88e8-ceef81fe7a61","name":"If Data is Exist","type":"n8n-nodes-base.if","position":[3020,1420],"executeOnce":false,"typeVersion":2.2,"alwaysOutputData":false},{"parameters":{"content":"## Looping Data And Checking For Is Exist On Database\n**We are checking until find a data we did not insert because we don't want to create content about in same content","height":600,"width":1060},"id":"557aa2c3-8d0b-42c4-b444-953a538d7ff4","name":"Sticky Note9","type":"n8n-nodes-base.stickyNote","position":[2440,1200],"typeVersion":1},{"parameters":{"chatId":"={{ $('Telegram Params').item.json.telegram_chat_id}}","text":"There was a problem execution a postgresql content","additionalFields":{}},"id":"9b510f11-9a44-4d54-b162-3ffb55d66677","name":"send error message to telegram","type":"n8n-nodes-base.telegram","position":[2560,1620],"typeVersion":1.2,"webhookId":"9819632c-5735-4a96-a9ba-a6cad91f7b8f"},{"parameters":{"schema":{"__rl":true,"mode":"list","value":"public"},"table":{"__rl":true,"mode":"list","value":"top_trends","cachedResultName":"top_trends"},"columns":{"value":{"tag":"={{$('Loop Over Items').item.json.tag}}","code":"={{$('Loop Over Items').item.json.content_code}}","prompt":"={{$('Loop Over Items').item.json.prompt}}","isposted":false,"thumbnail_url":"={{$('Loop Over Items').item.json.thumbnail_url}}"},"schema":[{"id":"id","type":"number","display":true,"removed":true,"required":false,"displayName":"id","defaultMatch":true,"canBeUsedToMatch":true},{"id":"prompt","type":"string","display":true,"required":true,"displayName":"prompt","defaultMatch":false,"canBeUsedToMatch":true},{"id":"isposted","type":"boolean","display":true,"required":false,"displayName":"isposted","defaultMatch":false,"canBeUsedToMatch":true},{"id":"createdat","type":"dateTime","display":true,"removed":true,"required":false,"displayName":"createdat","defaultMatch":false,"canBeUsedToMatch":true},{"id":"updatedat","type":"dateTime","display":true,"removed":true,"required":false,"displayName":"updatedat","defaultMatch":false,"canBeUsedToMatch":true},{"id":"deletedat","type":"dateTime","display":true,"removed":true,"required":false,"displayName":"deletedat","defaultMatch":false,"canBeUsedToMatch":true},{"id":"code","type":"string","display":true,"required":false,"displayName":"code","defaultMatch":false,"canBeUsedToMatch":true},{"id":"tag","type":"string","display":true,"required":false,"displayName":"tag","defaultMatch":false,"canBeUsedToMatch":true},{"id":"thumbnail_url","type":"string","display":true,"required":false,"displayName":"thumbnail_url","defaultMatch":false,"canBeUsedToMatch":true}],"mappingMode":"defineBelow","matchingColumns":["id"],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"id":"48bc61de-d416-4673-9e9b-8331ea841891","name":"insert data on db","type":"n8n-nodes-base.postgres","position":[3300,1420],"typeVersion":2.5},{"parameters":{"resource":"image","operation":"analyze","modelId":{"__rl":true,"mode":"list","value":"gpt-4o-mini","cachedResultName":"GPT-4O-MINI"},"text":"Create a clear and concise description of the object in the image, focusing on its physical and general features. Avoid detailed environmental aspects like background, lighting, or colors. Describe the shape, texture, size, and any unique characteristics of the object. Mention any notable features that make the object stand out, such as its surface details, materials, and design. The description should be focused on the object itself, not its surroundings.\n\nFor example, describe the following image:\n","imageUrls":"={{ $('Loop Over Items').item.json.thumbnail_url }}","options":{}},"id":"15e7d69d-a10f-48a1-b240-046e9950d077","name":"Analyze Image and give the content","type":"@n8n/n8n-nodes-langchain.openAi","position":[3640,1420],"typeVersion":1.8},{"parameters":{"modelId":{"__rl":true,"mode":"list","value":"gpt-4o-mini","cachedResultName":"GPT-4O-MINI"},"messages":{"values":[{"content":"=\nSummarize the following content description into a short, engaging Instagram caption under 150 words. The caption should focus on the content of the image, not the app. Keep it appealing to social media users, and highlight the visual details of the image. Include hashtags relevant to 3D modeling and design, such as #Blender3D, #3DArt, #DigitalArt, #3DModeling, and #ArtCommunity. Ensure the tone is friendly and inviting.\n\n\nContent description to summarize:\n{{ $json.content }}\n\nMake sure to craft the caption around the content's features, such as the color contrast, reflective surface, and artistic nature of the image.\n\n"}]},"options":{}},"id":"93e253b1-da7d-4193-b899-a38e6fd9f4e4","name":"Analyze Content And Generate Instagram Caption","type":"@n8n/n8n-nodes-langchain.openAi","position":[3840,1420],"typeVersion":1.8},{"parameters":{"content":"## Analyze Post Content\n** We are analyzing the image\n** We are generating a instagram caption by content\n** Then we are generating the image","height":600,"width":860,"color":4},"id":"9af1dc59-1d9e-4900-8f80-1eba946c4057","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","position":[3540,1200],"typeVersion":1},{"parameters":{"httpRequestMethod":"POST","graphApiVersion":"v20.0","node":"={{ $('Instagram params').item.json.instagram_business_account_id }}","edge":"media","options":{"queryParameters":{"parameter":[{"name":"image_url","value":"={{ $json.output[0] }}"},{"name":"caption","value":"={{ $('Analyze Content And Generate Instagram Caption').item.json.message.content }}"}]}}},"id":"2259f6df-dca9-4a7e-babb-e63375f7207f","name":"Prepare data on Instagram","type":"n8n-nodes-base.facebookGraphApi","position":[4540,1440],"typeVersion":1},{"parameters":{"graphApiVersion":"v20.0","node":"={{ $json.id }}","options":{"fields":{"field":[{"name":"id"},{"name":"status"},{"name":"status_code"}]}}},"id":"bcbb6058-1966-4bb5-915a-1e65b9131117","name":"Check Status Of Media Before Uploaded","type":"n8n-nodes-base.facebookGraphApi","position":[4760,1440],"typeVersion":1},{"parameters":{"httpRequestMethod":"POST","graphApiVersion":"v20.0","node":"={{ $('Instagram params').item.json.instagram_business_account_id }}","edge":"media_publish","options":{"queryParameters":{"parameter":[{"name":"creation_id","value":"={{ $json.id }}"}]}}},"id":"518d87ff-7808-4c06-b137-4e97d8f2ca28","name":"Publish Media on Instagram","type":"n8n-nodes-base.facebookGraphApi","position":[5160,1280],"typeVersion":1},{"parameters":{"graphApiVersion":"v20.0","node":"={{ $('Check Status Of Media Before Uploaded').item.json.id }}","options":{"fields":{"field":[{"name":"id"},{"name":"status"},{"name":"status_code"}]}}},"id":"a033d12b-524f-40e8-9208-5300bbc823d3","name":"Check status of post ","type":"n8n-nodes-base.facebookGraphApi","position":[5360,1440],"typeVersion":1},{"parameters":{"content":"## Publish On Instagram And Send Message When Published via Telegram\n","height":600,"width":1580,"color":5},"id":"f136e907-2938-4175-b51f-4201fbe3477d","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","position":[4440,1200],"typeVersion":1},{"parameters":{"content":"## For More About Api\n** [Facebook Scraper Api Guide](https://rapidapi.com/social-api1-instagram/api/instagram-scraper-api2/playground/apiendpoint_a45552b2-9850-4da9-b5cb-bbdd3ac2199d)","height":500,"width":260,"color":5},"id":"8145986c-5453-43ac-8d5c-c50a84a62136","name":"Sticky Note10","type":"n8n-nodes-base.stickyNote","position":[1760,1280],"typeVersion":1},{"parameters":{"jsCode":"const filteredData = $input.first().json.data.items.filter(item=> !item.is_video)\nreturn filteredData.map((item)=>{\n  return {\n    id: item.id,\n    prompt: item.caption.text,\n    content_code: item.code,\n    thumbnail_url: item.thumbnail_url,\n    tag: $input.first().json.data.additional_data.name\n  }\n})                                                                    \n\n"},"id":"02416fbb-4250-4278-af23-1f9189787123","name":"filter the image content-2","type":"n8n-nodes-base.code","position":[2080,1360],"typeVersion":2},{"parameters":{"content":"## Guide \n** [Guide](https://replicate.com) of getting  of Replicate Token ","height":300,"width":180,"color":5},"id":"2d1ea53d-1d32-4b86-8944-ce2ad4a69847","name":"Sticky Note11","type":"n8n-nodes-base.stickyNote","position":[740,1340],"typeVersion":1},{"parameters":{"assignments":{"assignments":[{"id":"1e380c14-e908-4eeb-90e0-957a422829d0","name":"replicate_token","type":"string","value":""}]},"options":{}},"id":"c8b933af-356e-49ae-92d3-42eaf4ee3e9f","name":"Replicate params","type":"n8n-nodes-base.set","position":[780,1480],"typeVersion":3.4},{"parameters":{"method":"POST","url":"https://api.replicate.com/v1/models/black-forest-labs/flux-schnell/predictions","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $('Replicate params').item.json.replicate_token}}"},{"name":"Prefer","value":"wait"}]},"sendBody":true,"specifyBody":"=json","bodyParameters":{"parameters":[{}]},"jsonBody":"={\n  \"input\": {\n    \"prompt\": \"A highly detailed 3D isometric model of {{$('Analyze Image and give the content').item.json.content   .replace(/\\\\n/g, ' ') \n.replace(/\\\\t/g, ' ') \n.replace(/\\s+/g, ' ')\n.trim(); }} rendered in a stylized miniature toy aesthetic. Materials: Matte plastic/painted metal/weathered stone texture with no self-shadowing. Lighting: - Completely shadowless rendering - Ultra bright and perfectly even illumination from all angles - Pure ambient lighting without directional shadows - Flat, consistent lighting across all surfaces - No ambient occlusion. Style specifications: - Clean, defined edges and surfaces - Slightly exaggerated proportions - Miniature/toy-like scale - Subtle wear and texturing - Rich color palette with muted tones - Isometric 3/4 view angle - Crisp details and micro-elements. Technical details: - 4K resolution - PBR materials without shadows - No depth of field - High-quality anti-aliasing - Perfect uniform lighting. Environment: Pure white background with zero shadows or gradients. Post-processing: High key lighting, maximum brightness, shadow removal.\",\n    \"output_format\": \"jpg\",\n    \"output_quality\": 100,\n    \"go_fast\":false\n  }\n}\n","options":{}},"id":"2c73cc9c-d436-459b-9b3c-bd870810b9b4","name":"Generate image on flux","type":"n8n-nodes-base.httpRequest","position":[4240,1440],"typeVersion":4.2},{"parameters":{"content":"## For top_trends Table\n```\nCREATE TABLE top_trends (\n    id SERIAL PRIMARY KEY,\n    isposted BOOLEAN DEFAULT false,\n    createdat TIMESTAMP WITHOUT TIME ZONE DEFAULT CURRENT_TIMESTAMP,\n    updatedat TIMESTAMP WITHOUT TIME ZONE DEFAULT CURRENT_TIMESTAMP,\n    deletedat TIMESTAMP WITHOUT TIME ZONE,\n    prompt TEXT NOT NULL,\n    thumbnail_url TEXT,\n    code TEXT,\n    tag TEXT\n);\n```","height":320,"width":1060,"color":4},"id":"6f9e7dc6-1287-4235-8631-198d729f367f","name":"Sticky Note12","type":"n8n-nodes-base.stickyNote","position":[2440,840],"typeVersion":1},{"parameters":{"content":"## Warning\n** Don't forgot the create top_trends table","height":120,"width":160,"color":3},"id":"b19951bb-6346-44a7-a4c8-1bd0806c6019","name":"Sticky Note13","type":"n8n-nodes-base.stickyNote","position":[2900,1060],"typeVersion":1},{"parameters":{"content":"\n## Automated Instagram Content Creation from Trending Posts\n\nThis workflow automates the process of discovering and recreating trending content on Instagram:\n\n1. Content Discovery:\n   - Scrapes top trending posts from specific hashtags (#blender3d, #isometric)\n   - Filters for image-only content (excludes videos)\n   - Checks database to avoid duplicate content\n\n2. AI-Powered Content Generation:\n   - Analyzes trending images using GPT-4 Vision\n   - Generates detailed descriptions of visual elements\n   - Creates engaging Instagram captions with relevant hashtags\n   - Uses Flux AI to generate similar but unique images\n\n3. Publishing & Monitoring:\n   - Automatically posts content to Instagram Business Account\n   - Monitors post status and publishing process\n   - Sends status updates via Telegram\n\nPerfect for content creators and businesses looking to maintain an active Instagram presence with AI-generated content inspired by current trends. The workflow runs on schedule and handles everything from content discovery to publication automatically.\n\nNote: Requires Instagram Business Account, Telegram Bot, OpenAI, and Replicate API credentials.","height":840,"width":620},"id":"3de6b8e5-c5e0-4999-871a-c349cb9b3ac0","name":"Sticky Note14","type":"n8n-nodes-base.stickyNote","position":[380,240],"typeVersion":1},{"parameters":{"content":"##Warning\n** Dont forgot the subscribe [Instagram Scraper Api](https://rapidapi.com/social-api1-instagram/api/instagram-scraper-api2/playground/apiendpoint_a45552b2-9850-4da9-b5cb-bbdd3ac2199d)","height":120,"width":180,"color":7},"id":"dfd0d182-177c-4336-8950-4792ea739123","name":"Sticky Note15","type":"n8n-nodes-base.stickyNote","position":[1440,1660],"typeVersion":1},{"parameters":{"content":"## Warning\n** You can check the  [rate limit](https://rapidapi.com/social-api1-instagram/api/instagram-scraper-api2) of the Instagram Scraper Api on Rapid Api\n** Free version is monthly 500 request\n","height":180,"width":180},"id":"03330941-3c6e-4152-8c51-f1d53f4424bc","name":"Sticky Note16","type":"n8n-nodes-base.stickyNote","position":[1440,1820],"typeVersion":1}],"connections":{"Telegram":{"main":[[]]},"Loop Over Items":{"main":[[],[{"node":"Check Data on Database Is Exist","type":"main","index":0}]]},"Telegram Params":{"main":[[{"node":"Rapid Api params","type":"main","index":0}]]},"If Data is Exist":{"main":[[{"node":"Loop Over Items","type":"main","index":0}],[{"node":"insert data on db","type":"main","index":0}]]},"Instagram params":{"main":[[{"node":"Telegram Params","type":"main","index":0}]]},"Rapid Api params":{"main":[[{"node":"get top trends on instagram #isometric","type":"main","index":0},{"node":"get  top trends on instagram #blender3d","type":"main","index":0}]]},"Replicate params":{"main":[[{"node":"Instagram params","type":"main","index":0}]]},"Schedule Trigger1":{"main":[[{"node":"Replicate params","type":"main","index":0}]]},"insert data on db":{"main":[[{"node":"Analyze Image and give the content","type":"main","index":0}]]},"Check status of post ":{"main":[[{"node":"If media status is finished1","type":"main","index":0}]]},"Generate image on flux":{"main":[[{"node":"Prepare data on Instagram","type":"main","index":0}]]},"merge the array content":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"filter the image content":{"main":[[{"node":"merge the array content","type":"main","index":1}]]},"Prepare data on Instagram":{"main":[[{"node":"Check Status Of Media Before Uploaded","type":"main","index":0}]]},"Publish Media on Instagram":{"main":[[{"node":"Check status of post ","type":"main","index":0}]]},"filter the image content-2":{"main":[[{"node":"merge the array content","type":"main","index":0}]]},"If media status is finished":{"main":[[{"node":"Publish Media on Instagram","type":"main","index":0}],[{"node":"Telegram","type":"main","index":0}]]},"If media status is finished1":{"main":[[{"node":"Telegram1","type":"main","index":0}],[{"node":"Telegram2","type":"main","index":0}]]},"Check Data on Database Is Exist":{"main":[[{"node":"If Data is Exist","type":"main","index":0}],[{"node":"send error message to telegram","type":"main","index":0}]]},"Analyze Image and give the content":{"main":[[{"node":"Analyze Content And Generate Instagram Caption","type":"main","index":0}]]},"Check Status Of Media Before Uploaded":{"main":[[{"node":"If media status is finished","type":"main","index":0}]]},"get top trends on instagram #isometric":{"main":[[{"node":"filter the image content","type":"main","index":0}]]},"get  top trends on instagram #blender3d":{"main":[[{"node":"filter the image content-2","type":"main","index":0}]]},"Analyze Content And Generate Instagram Caption":{"main":[[{"node":"Generate image on flux","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateId":"2803"},"pinData":{},"versionId":"889cf835-3145-47ff-a0e7-12278f4abc2a","triggerCount":0,"tags":[],"shared":[{"createdAt":"2025-06-02T13:19:58.333Z","updatedAt":"2025-06-02T13:19:58.333Z","role":"workflow:owner","workflowId":"j3CbtLB2LcAqETYh","projectId":"UuIRn3TQYG7gFAJh","project":{"createdAt":"2025-06-02T06:58:10.171Z","updatedAt":"2025-06-02T11:56:13.936Z","id":"UuIRn3TQYG7gFAJh","name":"Kshitiz Gupta <kshitiz305@live.com>","type":"personal","icon":null,"description":null}}]},{"createdAt":"2025-06-01T13:22:11.579Z","updatedAt":"2025-06-01T13:22:11.579Z","id":"pYF7vmr0rxB7t4cj","name":"My workflow 3","active":false,"isArchived":false,"nodes":[{"parameters":{},"name":"On clicking 'execute'","type":"n8n-nodes-base.manualTrigger","position":[-160,160],"typeVersion":1,"id":"3e381d9f-4534-422e-8a01-080d7d57d3b2"},{"parameters":{"command":"npx n8n export:workflow --backup --output repo/workflows/"},"name":"Export Workflows","type":"n8n-nodes-base.executeCommand","position":[40,60],"typeVersion":1,"id":"8f2f6999-2f8b-4ec4-9fc8-8ede5be5175d"},{"parameters":{"command":"npx n8n export:credentials --backup --output repo/credentials/"},"name":"Export Credentials","type":"n8n-nodes-base.executeCommand","position":[200,60],"typeVersion":1,"id":"93c964c9-c782-477d-a3dd-23dea9eba49a"},{"parameters":{"command":"git -C repo add ."},"name":"git add","type":"n8n-nodes-base.executeCommand","position":[340,60],"typeVersion":1,"id":"a63bde29-6cec-48ed-910f-dbad743dd3e0"},{"parameters":{"command":"=git -C repo commit -m \"Auto backup ({{ new Date().toISOString() }})\""},"name":"git commit","type":"n8n-nodes-base.executeCommand","position":[500,60],"typeVersion":1,"id":"b745be6c-41b9-4229-a063-a4c5bd5dc5bd"},{"parameters":{"command":"git -C repo push"},"name":"git push","type":"n8n-nodes-base.executeCommand","position":[640,60],"typeVersion":1,"id":"c83a199a-2400-4358-869c-b73cb3428c9b"},{"parameters":{"triggerTimes":{"item":[{"hour":0},{"hour":12},{"hour":6},{"hour":18}]}},"name":"Cron","type":"n8n-nodes-base.cron","position":[-160,-40],"typeVersion":1,"id":"335749c7-3534-4001-b930-1f99f7c1c295"}],"connections":{"Cron":{"main":[[{"node":"Export Workflows","type":"main","index":0}]]},"git add":{"main":[[{"node":"git commit","type":"main","index":0}]]},"git commit":{"main":[[{"node":"git push","type":"main","index":0}]]},"Export Workflows":{"main":[[{"node":"Export Credentials","type":"main","index":0}]]},"Export Credentials":{"main":[[{"node":"git add","type":"main","index":0}]]},"On clicking 'execute'":{"main":[[{"node":"Export Workflows","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"a66f27af-54d4-461a-93ac-a149dbe45b67","triggerCount":0,"tags":[],"shared":[{"createdAt":"2025-06-02T13:19:58.333Z","updatedAt":"2025-06-02T13:19:58.333Z","role":"workflow:owner","workflowId":"pYF7vmr0rxB7t4cj","projectId":"UuIRn3TQYG7gFAJh","project":{"createdAt":"2025-06-02T06:58:10.171Z","updatedAt":"2025-06-02T11:56:13.936Z","id":"UuIRn3TQYG7gFAJh","name":"Kshitiz Gupta <kshitiz305@live.com>","type":"personal","icon":null,"description":null}}]},{"createdAt":"2025-05-09T14:57:34.455Z","updatedAt":"2025-05-13T12:59:26.034Z","id":"tBGhaIPuzIDSND4Z","name":"Resume Generator","active":false,"isArchived":false,"nodes":[{"parameters":{"options":{}},"name":"Respond to Webhook","type":"n8n-nodes-base.respondToWebhook","typeVersion":1,"position":[1220,320],"id":"aa7da25d-1b04-430c-be7b-c59c3bc0d94d"},{"parameters":{"httpMethod":"POST","path":"generate-resume","responseMode":"lastNode","responseData":"allEntries","options":{}},"name":"Receive Job Description1","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[40,240],"webhookId":"your-actual-webhook-id","id":"f5ffdc87-3043-44b8-9649-dd6759ade31c"},{"parameters":{"values":{"string":[{"name":"resume","value":"={{ $json.output }}"}]},"options":{}},"name":"Format Response1","type":"n8n-nodes-base.set","typeVersion":1,"position":[540,240],"id":"56393499-d362-4a68-98b0-709a67dff2f8"},{"parameters":{"promptType":"define","text":"=Create the resume using the job desctipnion as follows: {{ $json.body.text }}. Stright away give the resume without talking about anything else.","hasOutputParser":true,"options":{"systemMessage":"you are a resume generator. create a highly ATS-friendly resume, tailored to a specific job description, using my existing resume as the primary source of my experience and qualifications. The final output should be the text content for a new resume, which I will then save as a PDF.\nObjective: To generate resume content that effectively passes through Applicant Tracking Systems (ATS) by incorporating keywords and relevant information from the provided job description, while accurately reflecting my skills and experience from my current resume.\nPlease follow these guidelines strictly:\nAnalyze Inputs:\nJob Description (I will provide this): Extract key responsibilities, required skills (hard and soft), qualifications, experience level, industry-specific jargon, and action verbs. Pay close attention to recurring terms and phrases.\nMy Current Resume (I will provide this): This is the source for my work history, accomplishments, skills, and education. Identify transferable skills and experiences that match the job description.\nATS Optimization & Tailoring - The Core Task:\nKeyword Integration: Strategically weave exact keywords and key phrases from the Job Description into the new resume content, particularly in the Professional Summary/Objective, Skills section, and Experience descriptions. Ensure natural integration, not just \"keyword stuffing.\" Use both full phrases and individual keywords.\nRelevance First: Prioritize and expand on experiences, achievements, and skills from my current resume that directly align with the Job Description. De-emphasize or omit less relevant details from my current resume for this specific application.\nQuantifiable Achievements: Where possible, rephrase my existing accomplishments (or suggest areas where I can add them) using the STAR method (Situation, Task, Action, Result) and quantify them with metrics, ensuring they align with what the Job Description values (e.g., \"Increased X by Y%,\" \"Managed Z projects,\" \"Reduced costs by Q\").\nAction Verbs: Start bullet points in the Experience section with strong action verbs that are relevant to the role and ideally found in the job description (e.g., \"Managed,\" \"Developed,\" \"Implemented,\" \"Led,\" \"Analyzed\").\nProfessional Summary/Objective: Craft a concise (3-4 lines) Professional Summary at the top, specifically tailored to the target role. This summary should immediately highlight my key qualifications and experience as they relate directly to the top 2-3 requirements in the job description, using its language.\nSkills Section: Create a dedicated \"Skills\" section. Categorize skills if appropriate (e.g., \"Technical Skills,\" \"Software,\" \"Languages\"). List skills explicitly mentioned in the job description that I possess, as well as closely related ones from my current resume.\nATS-Friendly Formatting (for the text output you provide):\nStandard Sections: Use clear, standard section headings (e.g., \"Professional Summary,\" \"Skills,\" \"Professional Experience,\" \"Education,\" \"Certifications\" (if applicable)).\nSimple Structure: The text you provide should be easily convertible to a single-column layout. Avoid any formatting that relies on tables, columns, text boxes, images, or graphics.\nBullet Points: Use standard bullet points (e.g., a simple hyphen - or asterisk *) for achievements and responsibilities.\nDates: Use a consistent and clear format for dates (e.g., MM/YYYY – MM/YYYY or Month YYYY – Month YYYY). For current roles, use \"Month YYYY – Present.\"\nContact Information: Ensure my contact information (Full Name, Phone Number, Email Address, LinkedIn Profile URL (optional), City, State (optional)) is clearly presented at the very top.\nFont & Spacing: Assume standard fonts like Arial, Calibri, or Times New Roman will be used, with a font size of 10-12pt for body text and slightly larger for headings. Suggest appropriate spacing for readability.\nNo Headers or Footers: Do not include content that would typically go into a document header or footer, as ATS can struggle with these.\nOutput:\nProvide the complete text content for the new, tailored resume, clearly demarcated by sections. I will handle the conversion to a clean, text-based PDF.\nProcess:\nI will provide you with the Job Description.\nI will then provide you with My Current Resume.\nYou will then generate the ATS-optimized resume content based on the instructions above.\nPlease confirm you understand these instructions before I provide the documents. Let me know if you have any clarifying questions.Make the summary according to the job descriptions.Use only the skills that are relevant to the job description. Don't leave any placeholder in the resumem \n\nMy Current resume looks like :\n\nKshitiz Gupta Software Developer\nkshitiz305@live.com +918882961517 linkedin.com/in/kshitiz305/ https://github.com/kshitiz305\nSummary\nHighly motivated Backend Engineer with 5+ years of experience in designing, developing, and maintaining scalable web\napplications using Python and Django. Proven ability to collaborate with cross-functional teams, optimize backend code\nfor performance, and ensure robust security measures. Experienced in developing RESTful APIs and contributing to all\nphases of the software development lifecycle. Eager to leverage expertise in a challenging role at Xogene, contributing to\ninnovative technology solutions\nSkills\nPython SQL( Postgres, MySQL, SQL Server ) FLASK / DASH / FAST API MONGODB Restful API\nGIT (GitLab) / Jenkins REDSHIFT AWS - Amazon Web Services (EC2, RDS, S3,Lambda)\nSELENIUM/BEAUTIFULSOUP SCRAPPING PYSPARK / PANDAS / NUMPY / JSON , NLP\nCI/CD (Continuous Integration) ORM (SQLALCHEMY) DevOps , Concfluence , JIRA\nMachine learning , Data Science Dockers SimPy JIRA ECS Agile Airflow\nGCP (BigQuery, Cloud Storage) Django\nProfessional Experience\nConsultant (Developer)\nDeveloper\nVersatile freelance Python developer delivering tailored solutions for diverse clients. Proven\nexpertise in crafting efficient and scalable applications, ensuring client satisfaction through\ntimely and innovative project delivery.\n07/2022 – present\nDELOITTE USI\nANALYST\n• Developed and optimized Python-based APIs, ensuring high performance and reliability for\ncritical business applications.\n03/2021 – 07/2022\n• Contributed to the development of backend functions, including table migration, ensuring\ndata integrity and efficient data management.\nFLIXSTOCK\nBACKEND DEVELOPER\n• Automated report generation for editors, reducing the time spent on manual reporting by\n50%.\n07/2020 – 03/2021\n• Reduced TAT by 92%, resulting in a 50% increase in productivity by removing bugs and\ninstability in pipeline using best practices of industry.\n• Leading a team to build strategies and achieve planned goals.\nInternships\nZIGRAM DATA PVT L TD\n(SOFTWARE DEVELOPER) CONSUL TANT / INTERN\n08/2019 – 04/2020\nProjects\nOpen Source Contributor\nContributing to multiple Industry Tools (Camlot - dev, Pandas - dev, github, Mindsdbs, DVC,etc) - Project contibutions can\nbe found - https://github.com/kshitiz305\nCORESTACK DASHBOARD\nCoreStack, an AI-powered multi-cloud governance product, empowers enterprises to unleash the power of cloud on their\nterms by helping them rapidly achieve continuous and cloud governance at scale with microservices. CoreStack enables\nenterprises to realize outcomes across FinOps, SecOps and CloudOps such as 40% decrease in cloud costs and 50% -\nNumpy , Pandas , flask.\nAwards\nSpot Award\nDELOITTE\n05/05/2022\nPython for Data Science\nIBM\nSoftware Engineering for Data Scientists in Python\nDataCamp\n\n\n"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.9,"position":[200,260],"id":"0adf48e6-ea8e-4a15-90b2-8bc176eb50b8","name":"AI Agent","alwaysOutputData":true},{"parameters":{"modelName":"models/gemini-2.5-pro-preview-05-06","options":{"temperature":0.4}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[200,440],"id":"cfe979a7-442b-4fa6-bafb-fafeacc9c50b","name":"Google Gemini Chat Model","credentials":{"googlePalmApi":{"id":"lxY1yy9VjJFvamwS","name":"Google Gemini(PaLM) Api Paid"}}},{"parameters":{"functionCode":"// Input data will contain the JSON from the webhook\nconst resumeData = $input.all().json;\n\n// Load required libraries\nconst PDFDocument = require('pdfkit');\n\n// Function to create PDF from resume data\nfunction createResumePDF(resumeText) {\n  // Create a PDF document buffer\n  const pdfBuffer = [];\n  const doc = new PDFDocument({ margin: 50 });\n  \n  // Pipe the PDF into a buffer\n  doc.on('data', pdfBuffer.push.bind(pdfBuffer));\n  \n  // Split content by sections (double newlines)\n  const sections = resumeText.split('\\n\\n');\n  \n  // Parse header (name and contact info)\n  const headerLines = sections[0].split('\\n');\n  const name = headerLines[0];\n  const contactInfo = headerLines[1];\n  \n  // Add the name as a title\n  doc.fontSize(18).font('Helvetica-Bold').text(name, { align: 'center' });\n  doc.moveDown(0.5);\n  \n  // Add contact info\n  doc.fontSize(10).font('Helvetica').text(contactInfo, { align: 'center' });\n  doc.moveDown(1);\n  \n  // Process remaining sections\n  for (let i = 1; i < sections.length; i++) {\n    const section = sections[i];\n    \n    // Check if this is a section header (starts with **)\n    if (section.startsWith('**')) {\n      // Extract section name\n      const sectionTitle = section.split('\\n')[0].replace(/\\*\\*/g, '');\n      \n      doc.fontSize(14).font('Helvetica-Bold').text(sectionTitle);\n      doc.moveDown(0.5);\n      \n      // Extract and format section content (remove the title line)\n      const contentLines = section.split('\\n').slice(1);\n      \n      // Process bullet points and regular text\n      contentLines.forEach(line => {\n        if (line.trim().startsWith('*')) {\n          // This is a bullet point\n          const bulletText = line.trim().substring(1).trim();\n          doc.fontSize(10).font('Helvetica')\n             .text(bulletText, { indent: 20, bulletPoint: '•' });\n        } else if (line.trim()) {\n          // Regular text\n          doc.fontSize(10).font('Helvetica').text(line.trim());\n        }\n        \n        // Small spacing between lines if needed\n        if (line.trim()) doc.moveDown(0.2);\n      });\n    } else {\n      // Regular paragraph\n      doc.fontSize(10).font('Helvetica').text(section);\n    }\n    \n    doc.moveDown(1);\n  }\n  \n  // Finalize the PDF\n  doc.end();\n  \n  return Buffer.concat(pdfBuffer).toString('base64');\n}\n\n// Process the data and generate PDF\nconst pdfBase64 = createResumePDF(resumeData);\n\n// Return the PDF for the next node\nreturn {\n  json: {\n    pdfData: pdfBase64,\n    contentType: 'application/pdf',\n    filename: 'resume.pdf'\n  }\n};"},"name":"Generate PDF","type":"n8n-nodes-base.function","typeVersion":1,"position":[800,800],"id":"9fa0bd64-74fb-48bd-a41c-3bad89229276"},{"parameters":{"mode":"jsonToBinary","destinationKey":"pdf","options":{"encoding":"base64","fileName":"resume.pdf","mimeType":"application/pdf"}},"name":"Move Binary Data","type":"n8n-nodes-base.moveBinaryData","typeVersion":1,"position":[980,540],"id":"4711214d-9acd-4188-8c9e-22f9517e87e9"},{"parameters":{"options":{}},"name":"Respond to Webhook1","type":"n8n-nodes-base.respondToWebhook","typeVersion":1,"position":[1300,920],"id":"e3f40935-8139-426f-b4de-b62e3b996877"},{"parameters":{"mode":"jsonToBinary","destinationKey":"doc","options":{"encoding":"base64","fileName":"resume.doc","mimeType":"application/text"}},"name":"Move Binary Data1","type":"n8n-nodes-base.moveBinaryData","typeVersion":1,"position":[820,360],"id":"2296e6dd-e18d-40f0-8f19-6fd147c8bf50"},{"parameters":{},"name":"Generate PDF1","type":"n8n-nodes-base.function","typeVersion":1,"position":[2000,580],"id":"40cb91ef-f777-4d11-adfe-681551bc264f"},{"parameters":{"mode":"jsonToBinary","destinationKey":"pdf","options":{"encoding":"base64","fileName":"resume.pdf","mimeType":"application/pdf"}},"name":"Move Binary Data2","type":"n8n-nodes-base.moveBinaryData","typeVersion":1,"position":[2200,580],"id":"3bcfc4b6-3b85-41ea-b5bd-65b2359155fc"},{"parameters":{"options":{}},"name":"Respond to Webhook2","type":"n8n-nodes-base.respondToWebhook","typeVersion":1,"position":[2400,580],"id":"695bc343-c926-4cae-9a79-d42e481895dd"},{"parameters":{"content":"the original idea given by the llm"},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[2120,380],"id":"09a836be-eb13-47ec-93cb-1ac5c032e106","name":"Sticky Note"}],"connections":{"Format Response1":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]},"Receive Job Description1":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"AI Agent":{"main":[[{"node":"Format Response1","type":"main","index":0}]]},"Google Gemini Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"Generate PDF":{"main":[[{"node":"Move Binary Data","type":"main","index":0}]]},"Move Binary Data":{"main":[[{"node":"Respond to Webhook1","type":"main","index":0}]]},"Move Binary Data1":{"main":[[]]},"Generate PDF1":{"main":[[{"node":"Move Binary Data2","type":"main","index":0}]]},"Move Binary Data2":{"main":[[{"node":"Respond to Webhook2","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"Receive Job Description1":[{"json":{"headers":{"host":"voicemybusiness.me","x-real-ip":"49.36.186.189","x-forwarded-for":"49.36.186.189","x-forwarded-proto":"https","connection":"Upgrade","content-length":"1446","user-agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36","content-type":"application/json","accept":"*/*","origin":"chrome-extension://jggpfdfhbmllejnganbjdpdiiejmlngn","sec-fetch-site":"cross-site","sec-fetch-mode":"cors","sec-fetch-dest":"empty","accept-encoding":"gzip, deflate, br, zstd","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","priority":"u=1, i"},"params":{},"query":{},"body":{"text":" At least 5 years experience with our core stack: AWS, Linux, Python\n\n– Proven ability to design and maintain resilient, scalable systems\n\n– Willingness to handle technical emergencies when needed\n\n– A long-term mindset — ready to commit for at least 5 years\n\n– Ability to lead a small technical team, answering hard questions and making others better\n\n– Experience with project management and people leadership\n\n– At least 2 hours of daily overlap with GMT+3 and GMT-5\n\n– Fluent in English, both written and spoken\n\n– Experience with system design and architecture\n\n– Familiarity with AI trends and capabilities\n\n– Knowledge or interest in the domain name system\n\n– Passion about fighting phishing and online frauds\n\n– Strong hiring instincts and ability to grow a team\n\nWhat We Offer:\n– A strategic leadership role in a profitable and fast-evolving company\n\n– High autonomy and influence over technical direction\n\n– Flexible remote work with async-first communication\n\n– Stock options and variable compensation based on experience and cultural fit\n\n– A chance to work on meaningful problems for clients who rely on our insights every day\n\nIf you’re passionate about domains, cyber security, and building high-performing teams (and you’re excited by the idea of leading a core tech function in a small but impactful company) we want to hear from you.\n"},"webhookUrl":"https://voicemybusiness.me/webhook/generate-resume","executionMode":"production"}}]},"versionId":"f39f1e7c-55ee-43a8-97d6-4f2488e9f274","triggerCount":1,"tags":[],"shared":[{"createdAt":"2025-06-02T13:19:58.333Z","updatedAt":"2025-06-02T13:19:58.333Z","role":"workflow:owner","workflowId":"tBGhaIPuzIDSND4Z","projectId":"UuIRn3TQYG7gFAJh","project":{"createdAt":"2025-06-02T06:58:10.171Z","updatedAt":"2025-06-02T11:56:13.936Z","id":"UuIRn3TQYG7gFAJh","name":"Kshitiz Gupta <kshitiz305@live.com>","type":"personal","icon":null,"description":null}}]}]